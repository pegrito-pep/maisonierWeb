(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1120acd8"],{"12dc":function(e,t,a){"use strict";a("33c7")},"33c7":function(e,t,a){},7898:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=(e,t)=>{t.forEach(t=>{let a=e.document.createElement("link");a.setAttribute("rel","stylesheet"),a.setAttribute("type","text/css"),a.setAttribute("href",t),e.document.getElementsByTagName("head")[0].appendChild(a)})},i={install(e,t={}){e.prototype.$htmlToPaper=(e,a={},i=(()=>!0))=>{let n="_blank",o=["fullscreen=yes","titlebar=yes","scrollbars=yes"],r=[],c=1e3,l=!0,u=window.document.title,{name:p=n,specs:d=o,styles:m=r,timeout:b=c,autoClose:h=l,windowTitle:_=u}=t;a.name&&(p=a.name),a.specs&&(d=a.specs),a.styles&&(m=a.styles),a.timeout&&(b=a.timeout),a.autoClose&&(h=a.autoClose),a.windowTitle&&(_=a.windowTitle),d=d.length?d.join(","):"";let y=e;if(("string"===typeof e||e instanceof String)&&(y=window.document.getElementById(e)),!y)return void alert(`Element to print #${e} not found!`);const v="",f=window.open(v,p,d);f.document.write(`\n        <html>\n          <head>\n            <title>${_}</title>\n          </head>\n          <body>\n            ${y.innerHTML}\n          </body>\n        </html>\n      `),s(f,m);const g=new Promise(e=>{setTimeout(()=>{f.focus(),f.print(),h&&f.document.close(),h&&f.close(),i&&i(),e()},b)});return!!i||g}}};t.default=i},ad35:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container-fluid"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12"},[a("div",{staticClass:"mb-2 clearfix"},[a("div",{staticClass:"collapse d-md-block display-options",attrs:{id:"displayOptions"}},[a("div",{staticClass:"d-block d-md-inline-block"},[a("SearchForm",{model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),a("div",{staticClass:"float-md-right"},[a("div",{staticClass:"d-flex "},[a("b-form-select",{staticClass:"form-control",attrs:{size:"sm",options:e.mois},model:{value:e.periode.mois,callback:function(t){e.$set(e.periode,"mois",t)},expression:"periode.mois"}}),a("b-form-select",{staticClass:"form-control",attrs:{size:"sm",options:e.annees},model:{value:e.periode.annee,callback:function(t){e.$set(e.periode,"annee",t)},expression:"periode.annee"}})],1)])])]),a("div",{staticClass:"separator mb-20"}),a("b-overlay",{attrs:{show:e.showOverlay,rounded:"sm"}},[e.occupations.length?a("b-row",[a("div",{staticClass:"card-body"},[a("b-table-simple",{attrs:{hover:"",small:"",responsive:""}},[a("b-thead",{attrs:{"head-variant":"light"}},[a("b-tr",{staticClass:"text-center"},[a("b-th",[e._v("Logement")]),a("b-th",[e._v("Locataire")]),a("b-th",[e._v("Loyer de base")]),a("b-th",[e._v("Consommation en eau")]),a("b-th",[e._v("Consommation en électricité")]),a("b-th",[e._v("Charges")]),a("b-th",[e._v("Action")])],1)],1),a("b-tbody",e._l(e.items,(function(t){return a("b-tr",{key:t.idOccupation},[a("b-td",{staticClass:"px-2 py-1"},[a("span",{staticClass:"d-inline-block w-100 mb-1 font-weight-bold"},[e._v(e._s(t.logement.refLogement))]),a("span",{staticClass:"d-inline-block w-100 mt-1 text-muted"},[e._v(" "+e._s(t.logement.sousTypeLogement.libelleSousType)+" "),t.logement.batiment?a("span",[e._v(" / Batiment : "+e._s(t.logement.batiment.nomBatiment))]):e._e()])]),a("b-td",{staticClass:"p-1"},[a("span",{staticClass:"d-inline-block w-100 mb-1 font-weight-bold"},[e._v(e._s(t.locataire.nomLocataire+" "+t.locataire.prenomLocataire))]),a("span",{staticClass:"d-inline-block w-100 mt-1 text-muted"},[e._v(e._s(t.locataire.tel+" / "+t.locataire.email))])]),a("b-td",{staticClass:"p-1",domProps:{innerHTML:e._s(e._display_loyer(t))}}),a("b-td",{staticClass:"p-1",domProps:{innerHTML:e._s(e._display_consommation(t,"eau"))}}),a("b-td",{staticClass:"p-1",domProps:{innerHTML:e._s(e._display_consommation(t,"energie"))}}),a("b-td",{staticClass:"p-1",domProps:{innerHTML:e._s(e._display_charge(t))}}),a("b-td",[a("b-dropdown",{attrs:{right:""},scopedSlots:e._u([{key:"button-content",fn:function(){return[a("i",{staticClass:"fa fa-ellipsis-h"})]},proxy:!0}],null,!0)},[a("b-dropdown-item",{attrs:{to:{name:"occupation",params:{id:t.idOccupation}}}},[e._v("Détails de l'occupation")]),a("b-dropdown-item",{attrs:{href:"#"},on:{click:function(a){return a.preventDefault(),e.doPayment(t)}}},[e._v("Effectuer un paiement")]),a("b-dropdown-item",{attrs:{href:"#"},on:{click:function(a){return a.preventDefault(),e.correspondance(t)}}},[e._v("Correspondance")])],1)],1)],1)})),1)],1)],1)]):a("b-alert",{staticClass:"text-center",attrs:{variant:"info",show:""}},[a("i",{staticClass:"fa fa-exclamation-triangle fa-3x"}),e._v(" "),a("br"),a("span",{staticClass:"h4 d-inline-flex ml-2"},[e._v("Vous n'avez défini aucune occupation pour le moment")])]),a("hr"),a("div",{staticClass:"d-flex justify-content-between align-items-start"},[a("paginator",{attrs:{offset:e.offset,total:e.occupations.length,limit:e.perPage,page:e.currentPage},on:{pageChanged:function(t){e.currentPage=t},limitChanged:function(t){e.perPage=t}}}),a("b-button",{staticClass:"position-fixed validate btn-icon",attrs:{id:"popover-options",variant:"danger"}},[a("i",{staticClass:"fa fa-bars fa-lg"})]),a("b-popover",{attrs:{title:"Options",target:"popover-options",triggers:"click blur",placement:"topleft"}},[a("div",{staticClass:"py-2"},[a("b-button",{attrs:{block:"",variant:"outline-secondary",disabled:e.submitted},on:{click:function(t){return t.preventDefault(),e.autoPay.apply(null,arguments)}}},[e._v("Lancer le paiement automatique")]),a("b-button",{attrs:{block:"",variant:"outline-secondary",disabled:e.submitted},on:{click:function(t){return t.preventDefault(),e.generateCharges.apply(null,arguments)}}},[e._v("Générer les charges")]),a("hr"),a("b-button",{attrs:{block:"",variant:"outline-secondary"},on:{click:function(t){t.preventDefault(),e.printList=!0}}},[e._v("Générer le listing des factures")])],1)])],1)],1)],1)]),e.occupation?a("div",[a("b-modal",{attrs:{id:"paiement",title:"Ajout de paiement","no-close-on-backdrop":"","ok-only":""},on:{ok:e.runPaiement,hidden:e.resetForm},scopedSlots:e._u([{key:"modal-footer",fn:function(t){var s=t.ok;return[a("b-button",{attrs:{size:"sm",variant:"danger",disabled:e.submitted||e.totalPayerFacture<=0},on:{click:function(e){return s()}}},[e._v("Valider "),e.submitted?a("b-spinner",{attrs:{small:""}}):e._e()],1)]}}],null,!1,3392060351)},[a("div",{staticClass:"jumbotron pt-10 pb-10 px-2"},[a("h5",{staticClass:"text-center mb-2"},[e._v("Effectuer un versement pour:")]),a("b-row",[a("b-col",[a("dl",[a("dt",[e._v("Logement")]),a("dd",[e._v(e._s(e.occupation.logement.refLogement)+" "),a("br"),e._v(" "+e._s(e.occupation.logement.sousTypeLogement.libelleSousType)+" "),a("br"),e._v(" "),e.occupation.logement.batiment?a("span",[e._v("Batiment : "+e._s(e.occupation.logement.batiment.nomBatiment))]):e._e()])])]),a("b-col",[a("dl",[a("dt",[e._v("Locataire")]),a("dd",[e._v(e._s(e.occupation.locataire.titre+" "+e.occupation.locataire.nomLocataire+" "+e.occupation.locataire.prenomLocataire)+" "),a("br"),e._v(" "+e._s(e.occupation.locataire.tel)+" "),a("br"),e._v(" "+e._s(e.occupation.locataire.email))])])])],1)],1),a("b-row",[a("b-col",[a("b-form-group",{attrs:{label:"Loyer",description:"Avance: "+e.paiement.avance[0]}},[a("b-form-checkbox",{attrs:{disabled:e.paiement.disabled[0]},model:{value:e.paiement.buy[0],callback:function(t){e.$set(e.paiement.buy,0,t)},expression:"paiement.buy[0]"}},[e._v("Payer "),a("b",[e._v(e._s(e.paiement.loyer+" F"))])])],1)],1),a("b-col",[a("b-form-group",{attrs:{label:"Charges",description:"Avance: "+e.paiement.avance[3]}},[a("b-form-checkbox",{attrs:{disabled:e.paiement.disabled[3]},model:{value:e.paiement.buy[3],callback:function(t){e.$set(e.paiement.buy,3,t)},expression:"paiement.buy[3]"}},[e._v("Payer "),a("b",[e._v(e._s(e.paiement.charges+" F"))])])],1)],1)],1),a("b-row",[a("b-col",[a("b-form-group",{attrs:{label:"Eau",description:"Avance: "+e.paiement.avance[1]}},[a("b-form-checkbox",{attrs:{disabled:e.paiement.disabled[1]},model:{value:e.paiement.buy[1],callback:function(t){e.$set(e.paiement.buy,1,t)},expression:"paiement.buy[1]"}},[e._v("Payer "),a("b",[e._v(e._s(e.paiement.eau+" F"))])])],1)],1),a("b-col",[a("b-form-group",{attrs:{label:"Lumière",description:"Avance: "+e.paiement.avance[2]}},[a("b-form-checkbox",{attrs:{disabled:e.paiement.disabled[2]},model:{value:e.paiement.buy[2],callback:function(t){e.$set(e.paiement.buy,2,t)},expression:"paiement.buy[2]"}},[e._v("Payer "),a("b",[e._v(e._s(e.paiement.energie+" F"))])])],1)],1)],1),a("hr"),a("b-row",[a("b-col",[a("b-form-group",{attrs:{label:"Total à payer",description:"Ce prix soustrait les montants avancés par le locataire pour cette facture"}},[a("b-form-input",{attrs:{disabled:"",value:e.totalPayerFacture}})],1)],1),a("b-col",[a("b-form-group",{attrs:{label:"Montant à préléver",description:"Entrez le montant versé pour cette facture. Il sera débité du compte de l'occupation"}},[a("b-form-input",{attrs:{disabled:e.totalPayerFacture<=0},model:{value:e.paiement.payer,callback:function(t){e.$set(e.paiement,"payer",t)},expression:"paiement.payer"}})],1)],1)],1)],1)],1):e._e(),e.occupation?a("div",[a("b-modal",{attrs:{id:"correspondance",title:"Correspondance","no-close-on-backdrop":"","cancel-title":"Fermer","ok-title":"Imprimer","ok-variant":"danger"},on:{ok:function(t){t.preventDefault(),e.printSingle=!0}}},[e.occupation.dateFin?a("b-alert",{staticClass:"text-center",attrs:{show:"",variant:"info"}},[a("i",{staticClass:"fa fa-exclamation-triangle fa-5x"}),e._v(" "),a("br"),a("p",{staticClass:"fa-2x mt-5 pt-2"},[e._v("Bail terminé le "+e._s(e.$dayjs(e.occupation.dateFin).format("dddd, DD MMMM YYYY")))])]):a("printer",{attrs:{display:!0,id:"print-correspondance"},on:{input:function(t){e.printSingle=!1}},model:{value:e.printSingle,callback:function(t){e.printSingle=t},expression:"printSingle"}},[a("b-card",{staticClass:"border"},[a("span",{staticClass:"float-right d-inline-block mb-5"},[e._v("Yaoundé le "+e._s(e.$dayjs().format("DD MMMM YYYY"))+" ")]),a("br"),a("div",{staticClass:"clearfix my-3"},[a("span",{staticClass:"text-underline"},[e._v("Object: ")]),a("b",{staticClass:"fa-lg"},[e._v("Loyer du mois de : "+e._s(e._find_periode_loyer(e.occupation)))])]),a("p",[a("b",[e._v(e._s(e.occupation.locataire.titre+" "+e.occupation.locataire.nomLocataire+" "+e.occupation.locataire.prenomLocataire)+" ("+e._s(e.occupation.locataire.tel)+")")]),e._v(", vous occupez le logement "),a("b",[e._v(e._s(e.occupation.logement.refLogement)+" / "+e._s(e.occupation.logement.sousTypeLogement.libelleSousType))]),e._v(" situé à "),a("b",[e._v(e._s(e.occupation.logement.adresse.ville+" "+e.occupation.logement.adresse.pays+", "+e.occupation.logement.adresse.quartier))]),e._v(". "),a("br"),e._v(" Ci-dessous, votre loyer du mois de "+e._s(e._find_periode_loyer(e.occupation))+" ")]),a("b-table-simple",[a("b-thead",[a("b-tr",[a("b-td"),a("b-th",[e._v("Montant")]),a("b-th",[e._v("Avance")]),a("b-th",[e._v("Reste")])],1)],1),a("b-tbody",[a("b-tr",[a("b-th",[e._v("Loyer de base")]),a("b-td",[e._v(e._s(e.occupation.loyerBase)+" F")]),a("b-td",[e._v(e._s(e.hasBuyLoyer[1])+" F")]),a("b-td",[e._v(e._s(e.occupation.loyerBase-e.hasBuyLoyer[1])+" F")])],1),a("b-tr",[a("b-th",[e._v("Charges")]),a("b-td",[e._v(e._s(e.hasBuyCharges[2])+" F")]),a("b-td",[e._v(e._s(e.hasBuyCharges[1])+" F")]),a("b-td",[e._v(e._s(e.hasBuyCharges[2]-e.hasBuyCharges[1])+" F")])],1),a("b-tr",[a("b-th",[e._v("Consommation en eau")]),a("b-td",[e._v(e._s(e.hasBuyEau[1])+" F")]),a("b-td",[e._v(e._s(e.hasBuyEau[2])+" F")]),a("b-td",[e._v(e._s(e.hasBuyEau[1]-e.hasBuyEau[2])+" F")])],1),a("b-tr",[a("b-th",[e._v("Consommation en électricité")]),a("b-td",[e._v(e._s(e.hasBuyEnergie[1])+" F")]),a("b-td",[e._v(e._s(e.hasBuyEnergie[2])+" F")]),a("b-td",[e._v(e._s(e.hasBuyEnergie[1]-e.hasBuyEnergie[2])+" F")])],1),a("b-tr",[a("b-th",[e._v("Total")]),a("b-td",[e._v(e._s(e.occupation.loyerBase+e.hasBuyCharges[2]+e.hasBuyEau[1]+e.hasBuyEnergie[1])+" F")]),a("b-td",[e._v(e._s(e.hasBuyLoyer[1]+e.hasBuyCharges[1]+e.hasBuyEau[2]+e.hasBuyEnergie[2])+" F")]),a("b-td",[e._v(e._s(e.totalQuitance)+" F")])],1),a("b-tr",[a("b-th",[e._v("Net à payer")]),a("b-td",{attrs:{colspan:"3"}},[a("b",{staticClass:"fa-lg text-primary"},[e._v(e._s(e.totalQuitance)+" F")])])],1)],1)],1)],1)],1)],1)],1):e._e(),a("printer",{attrs:{id:"print-liste"},on:{input:function(t){e.printList=!1}},model:{value:e.printList,callback:function(t){e.printList=t},expression:"printList"}},[a("h3",{staticClass:"text-center mb-3"},[e._v("Loyers du mois de "),a("b",[e._v(e._s(e.$dayjs(this.periodeCourante).format("MMMM YYYY")))])]),a("b-table-simple",{staticClass:"mt-4",attrs:{hover:"",small:"",responsive:""}},[a("b-thead",{staticClass:"border mb-5"},[a("b-tr",{staticClass:"text-center"},[a("b-th",{attrs:{valign:"middle"}},[e._v("Logement")]),a("b-th",{attrs:{valign:"middle"}},[e._v("Locataire")]),a("b-th",{attrs:{valign:"middle"}},[e._v("Loyer de base")]),a("b-th",{attrs:{valign:"middle"}},[e._v("Consommation en eau")]),a("b-th",{attrs:{valign:"middle"}},[e._v("Consommation en lumière")])],1)],1),a("b-tbody",[a("b-tr",[a("td",{attrs:{colspan:"5"}},[e._v(" ")])]),e._l(e.trueOccupations,(function(t){return a("b-tr",{key:t.idOccupation,staticClass:"pt-2"},[a("b-td",{staticClass:"px-2 py-1"},[a("span",{staticClass:"d-inline-block w-100 mb-1 font-weight-bold"},[e._v(e._s(t.logement.refLogement))]),a("span",{staticClass:"d-inline-block w-100 mt-1 text-muted"},[e._v(" "+e._s(t.logement.sousTypeLogement.libelleSousType)+" "),t.logement.batiment?a("span",[e._v(" / Batiment : "+e._s(t.logement.batiment.nomBatiment))]):e._e()])]),a("b-td",{staticClass:"p-1"},[a("span",{staticClass:"d-inline-block w-100 mb-1 font-weight-bold"},[e._v(e._s(t.locataire.titre+" "+t.locataire.nomLocataire+" "+t.locataire.prenomLocataire))]),a("span",{staticClass:"d-inline-block w-100 mt-1 text-muted"},[e._v(e._s(t.locataire.tel+" / "+t.locataire.email))])]),a("b-td",{staticClass:"p-1",domProps:{innerHTML:e._s(e._display_loyer(t))}}),a("b-td",{staticClass:"p-1",domProps:{innerHTML:e._s(e._display_consommation(t,"eau"))}}),a("b-td",{staticClass:"p-1",domProps:{innerHTML:e._s(e._display_consommation(t,"energie"))}})],1)}))],2)],1)],1)],1)},i=[],n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:{displayed:1==e.display},attrs:{id:"print-area"}},[a("div",{attrs:{id:e.id}},[e._m(0),a("div",{staticClass:"my-3"},[e._t("default")],2),a("footer")])])},o=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("header",{staticClass:"d-flex border rounded px-3 py-1 align-items-center"},[a("img",{staticClass:"header-brand-img",staticStyle:{height:"5em",width:"5em"},attrs:{src:"/img/logo-m0.png",alt:"lavalite"}}),a("div",{staticClass:"ml-1 text-center",staticStyle:{flex:"1"}},[a("h2",{staticClass:"text-danger"},[e._v("Maisonier")]),a("p",{staticClass:"text-muted"},[e._v("Application de gestion immobilière")])])])}],r=a("2b0e"),c=a("7898"),l=a.n(c);const u={name:"_blank",specs:["fullscreen=yes","titlebar=no","scrollbars=no"],styles:["https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css","https://unpkg.com/kidlat-css/css/kidlat.css"],timeout:1e3,autoClose:!0,windowTitle:window.document.title};r["default"].use(l.a,u);var p={name:"Printer",props:{value:{type:Boolean,default:!1},display:{type:Boolean,default:!1},id:{type:String,required:!0}},watch:{value(e){1==e&&0==this.proceced&&this.runPrint()}},data:()=>({proceced:!1}),methods:{async runPrint(){this.proceced=!0,await this.$htmlToPaper(this.id),this.proceced=!1,this.$emit("input")}}},d=p,m=(a("ed22"),a("2877")),b=Object(m["a"])(d,n,o,!1,null,"00a30cea",null),h=b.exports,_=a("fb87");const y=a("5a6f");var v={name:"loyers",components:{SearchForm:_["a"],Printer:h},data:()=>({search:null,showOverlay:!0,currentPage:1,perPage:10,occupations:[],trueOccupations:[],periode:{annee:null,mois:null},paiement:{payer:0,loyer:0,eau:0,energie:0,charges:0,avance:[0,0,0,0],buy:[!0,!1,!1,!1],disabled:[!0,!1,!1,!1]},occupation:null,submitted:!1,printList:!1,printSingle:!1}),watch:{search(e){this.occupations=y.empty(e)?this.trueOccupations:this.trueOccupations.filter(t=>t.locataire.nomLocataire.toLowerCase().includes(e.toLowerCase())||t.locataire.prenomLocataire.toLowerCase().includes(e.toLowerCase())||t.logement.refLogement.toLowerCase().includes(e.toLowerCase()))}},computed:{items(){return y.array_slice(this.occupations.filter(e=>this.$dayjs(this.periodeCourante).diff(e.dateDeb,"month")>=0&&(y.empty(e.dateFin)||this.$dayjs(e.dateFin).diff(this.periodeCourante,"month")<=0)),this.offset,this.perPage)},offset(){return this.currentPage*this.perPage-this.perPage},annees(){const e=this.$dayjs().format("YYYY");let t=[e];for(let a=e;a>e-5;a--)a!=e&&t.push(a);return t.sort((e,t)=>e-t)},mois(){const e=new Date,t=[],a=this.$dayjs().format("YYYY"),s=a==this.periode.annee?e.getMonth():11;for(let i=0;i<=s;i++)e.setMonth(i),t.push({value:i,text:y.ucfirst(this.$dayjs(e).format("MMMM"))});return t},periodeCourante(){let e=this.periode.mois+1;return e<10&&(e="0"+e),this.periode.annee+"-"+e+"-01"},totalPayerFacture(){let e=0;return 1==this.paiement.buy[0]&&(e+=this.paiement.loyer-this.paiement.avance[0]),1==this.paiement.buy[1]&&(e+=this.paiement.eau-this.paiement.avance[1]),1==this.paiement.buy[2]&&(e+=this.paiement.energie-this.paiement.avance[2]),1==this.paiement.buy[3]&&(e+=this.paiement.charges-this.paiement.avance[3]),e},hasBuyLoyer(){return this._check_if_buy_loyer(this.occupation)},hasBuyEau(){return this._check_if_buy_consommation(this.occupation,"eau")},hasBuyEnergie(){return this._check_if_buy_consommation(this.occupation,"energie")},hasBuyCharges(){return this._check_if_buy_charges(this.occupation)},totalQuitance(){return this.occupation.loyerBase-this.hasBuyLoyer[1]+(this.hasBuyCharges[2]-this.hasBuyCharges[1])+(this.hasBuyEnergie[1]-this.hasBuyEnergie[2])+(this.hasBuyEau[1]-this.hasBuyEau[2])}},beforeMount(){this.periode={mois:parseInt(this.$dayjs().format("M"))-1,annee:parseInt(this.$dayjs().format("YYYY"))},this.getOccupations()},methods:{sendData(){},getOccupations(){this.showOverlay=!0,axios.get("occupations").then(e=>e.result||[]).then(e=>{this.occupations=this.trueOccupations=e,this.showOverlay=!1})},doPayment(e){this.occupation=e;let[t,a]=this._check_if_buy_loyer(e);this.paiement.loyer=e.loyerBase,this.paiement.avance[0]=a,a>=e.loyerBase&&(this.paiement.buy[0]=!1);let[s,i,n]=this._check_if_buy_consommation(e,"eau");this.paiement.eau=i,this.paiement.disabled[1]=1==s,this.paiement.avance[1]=y.empty(n)?0:n.avance;let[o,r,c]=this._check_if_buy_consommation(e,"energie");this.paiement.energie=r,this.paiement.disabled[2]=1==o,this.paiement.avance[2]=y.empty(c)?0:c.avance;let[l,u,p]=this._check_if_buy_charges(e);this.paiement.charges=p,this.paiement.disabled[3]=1==l,this.paiement.avance[3]=u,setTimeout(()=>{this.$bvModal.show("paiement")},50)},runPaiement(e){if(e.preventDefault(),y.empty(this.paiement.payer)||this.paiement.payer<1)return App.error("Veuillez entrer un montant valide");if(this.paiement.disabled[0]&&this.paiement.disabled[1]&&this.paiement.buy[2],0==this.paiement.buy[0]&&0==this.paiement.buy[1]&&0==this.paiement.buy[2]&&0==this.paiement.buy[3])return App.error("Veuillez selectionnez au moins élément à payer");if(this.paiement.payer>this.totalPayerFacture)return App.error("Vous ne pouvez pas débiter une somme supérieure au total de la facture");const t={montant:this.paiement.payer,periode:this.periodeCourante,loyer:this.paiement.buy[0],eau:this.paiement.buy[1],energie:this.paiement.buy[2],charges:this.paiement.buy[3]};this.submitted=!0,axios.post("occupations/"+this.occupation.idOccupation+"/pay-facture",t).then(e=>(this.submitted=!1,App.alertSuccess(e.message,{callback:()=>{this.getOccupations(),this.$bvModal.hide("paiement")}}))).catch(e=>(this.submitted=!1,App.alertError(e.message)))},correspondance(e){this.occupation=e,setTimeout(()=>{this.$bvModal.show("correspondance")},50)},autoPay(){this.submitted=!0,axios.post("loyers/auto-pay",{periode:this.periodeCourante}).then(e=>(this.submitted=!1,App.alertSuccess(e.message,{callback:()=>{this.getOccupations()}}))).catch(e=>(this.submitted=!1,App.alertError(e.message)))},generateCharges(){this.submitted=!0,axios.post("charges/auto-generate",{periode:this.periodeCourante}).then(e=>(this.submitted=!1,App.alertSuccess(e.message,{callback:()=>{this.getOccupations()}}))).catch(e=>(this.submitted=!1,App.alertError(e.message)))},_calcul_consommation(e,t){const a=e.indexes.filter(e=>e.typeIndexe==t),s={eau:e.modeEau,energie:e.modeEnergie},i={eau:e.puEau,energie:e.puEnergie};let n=this.getIndexesPeriode(this.periodeCourante,a)[0],o=1;return n?"index"==s[t]&&(o=n.nouveau-n.ancien):o=0,o*i[t]},_display_consommation(e,t){const[a,s,i]=this._check_if_buy_consommation(e,t);let n="danger",o="Impayé";return-1==a?(n="secondary",o="Non consommé"):2==a?(n="warning",o="Avancé "+i+" F"):1==a&&(n="success",o="Payé"),`<span class="badge w-100 badge-${n}">\n                <b>${s}</b> F <br>\n                <span class="small">${o}</span>\n            </span>`},_check_if_buy_consommation(e,t){const a=this._calcul_consommation(e,t);if(0==a)return[-1,a,0];const s=e.indexes.filter(e=>e.typeIndexe==t);if(!y.empty(s)){let e=this.getIndexesPeriode(this.periodeCourante,s)[0];if(!y.empty(e)){if(a>e.avance)return[2,a,e.avance||0];if(a<=e.avance)return[1,a,e.avance||0]}}return[0,a,0]},_display_loyer(e){const[t,a]=this._check_if_buy_loyer(e);let s="danger",i="Impayé";return 2==t?(s="warning",i="Avancé : "+a+" F"):1==t&&(s="success",i="Payé"),`<span class="badge w-100 badge-${s}">\n                <b>${e.loyerBase}</b> F <br>\n                <span class="small">${i}</span>\n            </span>`},_check_if_buy_loyer(e){const t=e.loyers.filter(e=>0==this.$dayjs(this.periodeCourante).diff(e.periode,"month"));if(t.length){const a=t.reduce((e,t)=>e+t.montantPayer,0);if(0!=a)return a<e.loyerBase?[2,a]:[1,a]}return[0,0]},_display_charge(e){const[t,a,s]=this._check_if_buy_charges(e);let i="danger",n="Impayé";return 2==t?(i="warning",n="Avancé : "+a+" F"):1==t&&(i="success",n="Payé"),`<span class="badge w-100 badge-${i}">\n                <b>${s}</b> F <br>\n                <span class="small">${n}</span>\n            </span>`},_check_if_buy_charges(e){const t=e.charges.filter(e=>0==this.$dayjs(this.periodeCourante).diff(this.$dayjs(e.periode).format("YYYY-MM")+"-01","month")),a=t.reduce((e,t)=>e+t.montant,0);if(t.length){const e=t.reduce((e,t)=>e+t.montantPayer,0);if(0!=e)return e<a?[2,e,a]:[1,e,a]}return[0,0,a]},_calcul_total_quitance_facture(e){const t=parseInt(e.loyerBase),[a,s]=this._check_if_buy_consommation(e,"eau"),[i,n]=this._check_if_buy_consommation(e,"energie"),[o,r]=this._check_if_buy_loyer(e),[c,l,u]=this._check_if_buy_loyer(e);let p=t+n+s+u;return 0!=o&&(p-=r),0!=i&&(p-=n),0!=a&&(p-=s),0!=c&&(p-=l),p},_find_periode_loyer(e){return"prepayer"==e.modePaiement?this.$dayjs(this.periodeCourante).add(1,"month").format("MMMM YYYY"):this.$dayjs(this.periodeCourante).format("MMMM YYYY")},getIndexesPeriode(e,t){return t.filter(t=>0==this.$dayjs(e).diff(t.periode,"month"))},resetForm(){this.paiement={a_payer:0,payer:0,loyer:0,eau:0,buy:[!0,!1,!1],disabled:[!1,!1,!1],avance:[0,0,0]}}}},f=v,g=(a("12dc"),Object(m["a"])(f,s,i,!1,null,"6a5b99e1",null));t["default"]=g.exports},cd97:function(e,t,a){},ed22:function(e,t,a){"use strict";a("cd97")},fb87:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"search-sm d-inline-block float-md-left mr-1 mb-1 align-top"},[a("form",{attrs:{action:"",onSubmit:"return false"}},[a("b-form-input",{staticStyle:{height:"40px",width:"350px","border-radius":"5px"},attrs:{type:"text",placeholder:e.placeholder},on:{input:function(t){e.$emit("input",t)}},model:{value:e.val,callback:function(t){e.val=t},expression:"val"}}),e._m(0)],1)])},i=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("button",{staticClass:"btn btn-icon",staticStyle:{height:"40px",width:"50px"},attrs:{type:"submit"}},[a("i",{staticClass:"ik ik-search"})])}],n={name:"SearchForm",props:{placeholder:{type:String,default:"Rechercher..."},value:{required:!0,default:""}},data:()=>({val:null}),mounted(){this.val=this.value}},o=n,r=a("2877"),c=Object(r["a"])(o,s,i,!1,null,"0cf1e66c",null);t["a"]=c.exports}}]);
//# sourceMappingURL=chunk-1120acd8.ac44f3e7.js.map