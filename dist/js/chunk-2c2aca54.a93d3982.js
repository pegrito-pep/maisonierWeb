(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2c2aca54"],{"02e8":function(e,t,i){},"287a":function(e,t,i){"use strict";i("02e8")},"2c43":function(e,t,i){"use strict";t["a"]={success:function(e,t){this.make(e,{type:"success",bgcolor:"#5bd747"},t)},error:function(e,t){this.make(e,{type:"error"},t)},make:function(e,t,i){notif(Object.assign({},{type:"info",msg:e,timeout:3e3,callback:i},t))}}},"3c60":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("b-overlay",{attrs:{show:e.showOverlay,rounded:"sm"}},[i("div",{staticClass:"d-flex flex-column justify-content-between h-100"},[i("form-wizard",{ref:"logementForm",attrs:{title:"",subtitle:"",nextButtonText:"suivant",backButtonText:"Précedent",finishButtonText:"Enregistrer","aria-labelledby":"demoModalLabel",shape:"circle",color:"#e74c3c"},on:{"on-complete":e.submitForm,"on-loading":e.setLoading,"on-validate":e.handleValidation}},[i("tab-content",{attrs:{title:"Informations de base",icon:"ik ik-info","before-change":e.validateFirst}},[i("div",{staticClass:"d-flex flex-column justify-content-between",staticStyle:{height:"95%","overflow-y":"auto","overflow-x":"hidden"}},[i("div",{attrs:{"data-repeater-list":"group"}},[i("b-row",{attrs:{"data-repeater-item":""}},[i("b-col",[i("b-form-group",{attrs:{label:"Nom du batiment"}},[i("b-form-input",{attrs:{name:"nom",placeholder:"Ex: Batiment A",trim:""},model:{value:e.nom,callback:function(t){e.nom=t},expression:"nom"}}),e.requiredNom?e._e():i("span",{staticStyle:{color:"red"}},[e._v("Le nom du batiment est obligatoire")])],1),i("b-form-group",{attrs:{label:"Reference"}},[i("b-form-input",{attrs:{name:"ref",placeholder:"Ex: B1",trim:""},model:{value:e.ref,callback:function(t){e.ref=t},expression:"ref"}}),e.requiredRef?e._e():i("span",{staticStyle:{color:"red"}},[e._v("La reférence du Batiment est obligatoire")])],1),null==e.cite?i("b-form-group",{attrs:{label:"Photo"}},[i("img-inputer",{attrs:{"img-src":e.$getBase64(e.photo.batiment,!1),placeholder:"Ajouter la photo du batiment",theme:"light",size:"xl","bottom-text":"déposez le fichier ici ou cliquez pour modifier",icon:"img"},model:{value:e.photo.batiment,callback:function(t){e.$set(e.photo,"batiment",t)},expression:"photo.batiment"}})],1):e._e()],1),i("b-col",[null!=e.cite?i("b-form-group",{attrs:{label:"Photo"}},[i("img-inputer",{attrs:{name:"test",placeholder:"Ajouter la photo du batiment",theme:"light",size:"xl","bottom-text":"déposez le fichier ici ou cliquez pour modifier",icon:"img"}})],1):i("div",[i("b-form-group",{attrs:{label:"Cité"}},[i("v-select",{staticClass:"py-1",attrs:{options:e.cites,reduce:function(e){return e.idCite},label:"nomCite"},scopedSlots:e._u([{key:"option",fn:function(t){var a=t.nomCite,s=t.refCite,o=t.idCite;return[e._v(" "+e._s(a)+" "),i("br"),i("span",{staticClass:"text-muted"},[e._v(" "+e._s(-1!=o?"Reference: ":"")+e._s(s))]),-1==o?i("hr",{staticClass:"m-0 bg-danger",staticStyle:{"border-width":"1.5px"}}):e._e()]}}]),model:{value:e.idCite,callback:function(t){e.idCite=t},expression:"idCite"}})],1),i("b-carousel",{directives:[{name:"show",rawName:"v-show",value:-1!=e.idCite,expression:"idCite != -1"}],ref:"citeCarousel",attrs:{interval:0,controls:""},model:{value:e.selected_index_cite,callback:function(t){e.selected_index_cite=t},expression:"selected_index_cite"}},e._l(e.slideCites,(function(e,t){return i("b-carousel-slide",{key:t,staticClass:"fluid w-100 responsive border",staticStyle:{height:"20em"},attrs:{"img-src":e.image||"/img/bgCity.jpg"}})})),1),-1==e.idCite?i("div",[i("b-row",[i("b-col",[i("b-form-group",{attrs:{label:"Nom de la cité"}},[i("b-form-input",{attrs:{placeholder:"Ex: Cité de la joie",trim:""},model:{value:e.nomCite,callback:function(t){e.nomCite=t},expression:"nomCite"}}),e.requiredNomCite?e._e():i("span",{staticStyle:{color:"red"}},[e._v("Le nom de la cité est obligatoire")])],1)],1),i("b-col",[i("b-form-group",{attrs:{label:"Reférence de la cité"}},[i("b-form-input",{attrs:{placeholder:"Ex: CDJ",trim:""},model:{value:e.refCite,callback:function(t){e.refCite=t},expression:"refCite"}}),e.requiredNomCite?e._e():i("span",{staticStyle:{color:"red"}},[e._v("La reférencem de la cité est obligatoire")])],1)],1)],1),i("b-form-group",{attrs:{label:"Photo"}},[i("img-inputer",{attrs:{"img-src":e.$getBase64(e.photo.cite,!1),placeholder:"Ajouter la photo de la cité",theme:"light",size:"xl","bottom-text":"déposez le fichier ici ou cliquez pour modifier",icon:"img"},model:{value:e.photo.cite,callback:function(t){e.$set(e.photo,"cite",t)},expression:"photo.cite"}})],1)],1):e._e()],1)],1),null!=e.cite?i("b-col",{staticClass:"m-0 p-0 mr-2",attrs:{cols:"1"}},[i("b-form-group",{attrs:{label:"Action"}},[i("b-button",{attrs:{"data-repeater-delete":"",variant:"outline-danger"}},[i("i",{staticClass:"fa fa-times"})])],1)],1):e._e()],1)],1)]),i("div",{staticClass:"w-100 d-flex justify-content-end align-items-center mt-4"},[null!=e.cite?i("b-button",{attrs:{variant:"outline-primary","data-repeater-create":""}},[e._v("Ajouter un élément")]):e._e()],1)]),i("tab-content",{attrs:{title:"Localisation",icon:"fa fa-map-marker"}},[i("b-row",[i("b-col",[i("b-row",[i("div",{staticClass:"form-group"},[i("label",[e._v("Pays ")]),i("b-form-select",{staticClass:"mb-3",attrs:{options:e.tousLesPays,"value-field":"name","text-field":"name"},model:{value:e.pays,callback:function(t){e.pays=t},expression:"pays"}}),e.requiredPays?e._e():i("span",{staticStyle:{color:"red"}},[e._v("Vous devez selectionner un pays")])],1)]),i("b-row",[i("b-col",[i("label",[e._v("Ville ")]),i("input",{directives:[{name:"model",rawName:"v-model",value:e.ville,expression:"ville"}],staticClass:"form-control",attrs:{type:"text",id:"ville",required:"",placeholder:"Ville Ex:Yaoundé"},domProps:{value:e.ville},on:{input:function(t){t.target.composing||(e.ville=t.target.value)}}}),e.requiredVille?e._e():i("span",{staticStyle:{color:"red"}},[e._v("Ville obligatoire")])]),i("b-col",[i("label",[e._v("Quartier ")]),i("input",{directives:[{name:"model",rawName:"v-model",value:e.quartier,expression:"quartier"}],staticClass:"form-control",attrs:{type:"text",id:"quartier",required:"",placeholder:"Quartier Ex:Nsam"},domProps:{value:e.quartier},on:{input:function(t){t.target.composing||(e.quartier=t.target.value)}}}),e.requiredQuartier?e._e():i("span",{staticStyle:{color:"red"}},[e._v("Quartier obligatoire")])])],1)],1),i("b-col",[i("b-row",{staticClass:"ml-4 mt-2"},[i("label",[e._v("Latitude ")]),i("input",{directives:[{name:"model",rawName:"v-model",value:e.mapCoordinates.lat,expression:"mapCoordinates.lat"}],staticClass:"form-control",attrs:{type:"text",id:"lat"},domProps:{value:e.mapCoordinates.lat},on:{input:function(t){t.target.composing||e.$set(e.mapCoordinates,"lat",t.target.value)}}})]),i("b-row",{staticClass:"ml-4  mt-4"},[i("label",[e._v("Longitude ")]),i("input",{directives:[{name:"model",rawName:"v-model",value:e.mapCoordinates.lng,expression:"mapCoordinates.lng"}],staticClass:"form-control",attrs:{type:"text",id:"longitude"},domProps:{value:e.mapCoordinates.lng},on:{input:function(t){t.target.composing||e.$set(e.mapCoordinates,"lng",t.target.value)}}})])],1)],1),i("div",[i("GmapMap",{ref:"mapRef",staticStyle:{width:"100%",height:"360px",margin:"32px auto"},attrs:{center:e.myCoordinates,zoom:e.zoom},on:{dragend:e.handleDrag}},e._l(e.markers,(function(t,a){return i("GmapMarker",{key:a,attrs:{position:t.position,clickable:!0,draggable:!0},on:{click:function(i){e.myCoordinates=t.position}}})})),1)],1)],1),e.loadingWizard?i("div",{staticClass:"leloader"}):e._e()],1)],1)])},s=[],o=i("2ee4");i("da93");const n=i("5a6f");var r={data:()=>({submitted:!1,showOverlay:!0,cites:[],idCite:-1,nom:null,ref:null,nomCite:null,refCite:null,pays:null,ville:null,quartier:null,photo:{batiment:null,cite:null},selected_index_cite:null,requiredPays:!0,requiredVille:!0,requiredQuartier:!0,tousLesPays:{AF:"Afghanistan",ZA:"Afrique du Sud",AL:"Albanie",DZ:"Algérie",DE:"Allemagne",AD:"Andorre",AO:"Angola",AI:"Anguilla",AQ:"Antarctique",AG:"Antigua-et-Barbuda",AN:"Antilles néerlandaises",SA:"Arabie saoudite",AR:"Argentine",AM:"Arménie",AW:"Aruba",AU:"Australie",AT:"Autriche",AZ:"Azerbaïdjan",BS:"Bahamas",BH:"Bahreïn",BD:"Bangladesh",BB:"Barbade",BY:"Bélarus",BE:"Belgique",BZ:"Belize",BJ:"Bénin",BM:"Bermudes",BT:"Bhoutan",BO:"Bolivie",BA:"Bosnie-Herzégovine",BW:"Botswana",BR:"Brésil",BN:"Brunéi Darussalam",BG:"Bulgarie",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodge",CM:"Cameroun",CA:"Canada",CV:"Cap-Vert",EA:"Ceuta et Melilla",CL:"Chili",CN:"Chine",CY:"Chypre",CO:"Colombie",KM:"Comores",CG:"Congo-Brazzaville",KP:"Corée du Nord",KR:"Corée du Sud",CR:"Costa Rica",CI:"Côte d’Ivoire",HR:"Croatie",CU:"Cuba",DK:"Danemark",DG:"Diego Garcia",DJ:"Djibouti",DM:"Dominique",EG:"Égypte",SV:"El Salvador",AE:"Émirats arabes unis",EC:"Équateur",ER:"Érythrée",ES:"Espagne",EE:"Estonie",VA:"État de la Cité du Vatican",FM:"États fédérés de Micronésie",US:"États-Unis",ET:"Éthiopie",FJ:"Fidji",FI:"Finlande",FR:"France",GA:"Gabon",GM:"Gambie",GE:"Géorgie",GS:"Géorgie du Sud et les îles Sandwich du Sud",GH:"Ghana",GI:"Gibraltar",GR:"Grèce",GD:"Grenade",GL:"Groenland",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernesey",GN:"Guinée",GQ:"Guinée équatoriale",GW:"Guinée-Bissau",GY:"Guyana",GF:"Guyane française",HT:"Haïti",HN:"Honduras",HU:"Hongrie",BV:"Île Bouvet",CX:"Île Christmas",CP:"Île Clipperton",AC:"Île de l'Ascension",IM:"Île de Man",NF:"Île Norfolk",AX:"Îles Åland",KY:"Îles Caïmans",IC:"Îles Canaries",CC:"Îles Cocos - Keeling",CK:"Îles Cook",FO:"Îles Féroé",HM:"Îles Heard et MacDonald",FK:"Îles Malouines",MP:"Îles Mariannes du Nord",MH:"Îles Marshall",UM:"Îles Mineures Éloignées des États-Unis",SB:"Îles Salomon",TC:"Îles Turks et Caïques",VG:"Îles Vierges britanniques",VI:"Îles Vierges des États-Unis",IN:"Inde",ID:"Indonésie",IQ:"Irak",IR:"Iran",IE:"Irlande",IS:"Islande",IL:"Israël",IT:"Italie",JM:"Jamaïque",JP:"Japon",JE:"Jersey",JO:"Jordanie",KZ:"Kazakhstan",KE:"Kenya",KG:"Kirghizistan",KI:"Kiribati",KW:"Koweït",LA:"Laos",LS:"Lesotho",LV:"Lettonie",LB:"Liban",LR:"Libéria",LY:"Libye",LI:"Liechtenstein",LT:"Lituanie",LU:"Luxembourg",MK:"Macédoine",MG:"Madagascar",MY:"Malaisie",MW:"Malawi",MV:"Maldives",ML:"Mali",MT:"Malte",MA:"Maroc",MQ:"Martinique",MU:"Maurice",MR:"Mauritanie",YT:"Mayotte",MX:"Mexique",MD:"Moldavie",MC:"Monaco",MN:"Mongolie",ME:"Monténégro",MS:"Montserrat",MZ:"Mozambique",MM:"Myanmar",NA:"Namibie",NR:"Nauru",NP:"Népal",NI:"Nicaragua",NE:"Niger",NG:"Nigéria",NU:"Niue",NO:"Norvège",NC:"Nouvelle-Calédonie",NZ:"Nouvelle-Zélande",OM:"Oman",UG:"Ouganda",UZ:"Ouzbékistan",PK:"Pakistan",PW:"Palaos",PA:"Panama",PG:"Papouasie-Nouvelle-Guinée",PY:"Paraguay",NL:"Pays-Bas",PE:"Pérou",PH:"Philippines",PN:"Pitcairn",PL:"Pologne",PF:"Polynésie française",PR:"Porto Rico",PT:"Portugal",QA:"Qatar",HK:"R.A.S. chinoise de Hong Kong",MO:"R.A.S. chinoise de Macao",QO:"régions éloignées de l’Océanie",CF:"République centrafricaine",CD:"République démocratique du Congo",DO:"République dominicaine",CZ:"République tchèque",RE:"Réunion",RO:"Roumanie",GB:"Royaume-Uni",RU:"Russie",RW:"Rwanda",EH:"Sahara occidental",BL:"Saint-Barthélémy",KN:"Saint-Kitts-et-Nevis",SM:"Saint-Marin",MF:"Saint-Martin",PM:"Saint-Pierre-et-Miquelon",VC:"Saint-Vincent-et-les Grenadines",SH:"Sainte-Hélène",LC:"Sainte-Lucie",WS:"Samoa",AS:"Samoa américaines",ST:"Sao Tomé-et-Principe",SN:"Sénégal",RS:"Serbie",CS:"Serbie-et-Monténégro",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapour",SK:"Slovaquie",SI:"Slovénie",SO:"Somalie",SD:"Soudan",LK:"Sri Lanka",SE:"Suède",CH:"Suisse",SR:"Suriname",SJ:"Svalbard et Île Jan Mayen",SZ:"Swaziland",SY:"Syrie",TJ:"Tadjikistan",TW:"Taïwan",TZ:"Tanzanie",TD:"Tchad",TF:"Terres australes françaises",IO:"Territoire britannique de l'océan Indien",PS:"Territoire palestinien",TH:"Thaïlande",TL:"Timor oriental",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinité-et-Tobago",TA:"Tristan da Cunha",TN:"Tunisie",TM:"Turkménistan",TR:"Turquie",TV:"Tuvalu",UA:"Ukraine",EU:"Union européenne",UY:"Uruguay",VU:"Vanuatu",VE:"Venezuela",VN:"Viêt Nam",WF:"Wallis-et-Futuna",YE:"Yémen",ZM:"Zambie",ZW:"Zimbabwe"},indexForm:5,loadingWizard:!1,check:!0,requiredNom:!0,requiredRef:!0,requiredNomCite:!0,requiredRefCite:!0,myCoordinates:{lat:0,lng:0},zoom:17,markers:[]}),component:{FormWizard:o["FormWizard"],TabContent:o["TabContent"]},watch:{selected_index_cite(e){this.idCite=this.slideCites[e].idCite},idCite(e){this.setSlide_cite(e)}},props:{action:{type:String,default:"add"},batiment:{type:Object,default:null},cite:{type:Object,default:null}},computed:{mapCoordinates(){return this.map?{lat:this.map.getCenter().lat().toFixed(14),lng:this.map.getCenter().lng().toFixed(14)}:{lat:0,lng:0}},repeaterId(){return"repeat-added-batiment-form-"+(n.empty(this.cite)?n.uniqid():this.cite.idCite)},slideCites(){return this.cites.filter(e=>-1!=e.idCite)}},created(){this.getCites(),localStorage.center?this.myCoordinates=JSON.parse(localStorage.center):this.$getLocation({}).then(e=>{this.myCoordinates=e}).catch(e=>alert(e)),localStorage.zoom&&(this.zoom=parseInt(localStorage.zoom))},mounted(){n.empty(this.cite)||(this.makeRepeater(),this.idCite=this.cite.idCite),this.drawMarker()},methods:{drawMarker(){this.markers=[{position:this.myCoordinates}]},validateFirst:function(){return new Promise((e,t)=>{!this.nom||!this.ref||!this.nomCite&&null==this.idCite||!this.refCite&&null==this.idCite?(this.check=!1,this.nom?this.requiredNom=!0:this.requiredNom=!1,this.ref?this.requiredRef=!0:this.requiredRef=!1,this.nomCite?this.requiredNomCite=!0:this.requiredNomCite=!1,this.refCite?this.refCite=!0:this.refCite=!1):this.check=!0,setTimeout(()=>{e(this.check)},1e3)})},setLoading:function(e){this.loadingWizard=e},handleValidation:function(e,t){console.log("Tab: "+t+" valid: "+e),this.indexForm=this.indexForm+1,console.log("indexFom: ",this.indexForm)},handleDrag(){let e={lat:this.map.getCenter().lat(),lng:this.map.getCenter().lng()},t=this.map.getZoom();localStorage.center=JSON.stringify(e),localStorage.zoom=t},async getCites(){let e=storage.get("cites");n.empty(e)&&(e=await axios.get("cites").then(e=>e.result||[]),storage.set("cites",e,10)),this.cites=e||[],n.empty(this.batiment)?this.cites.unshift({nomCite:"Créer une nouvelle cité",refCite:"Ajout d'une cité inexistante",idCite:-1}):(this.nom=this.batiment.nomBatiment,this.ref=this.batiment.refBatiment,this.photo.batiment=this.batiment.image,this.idCite=this.batiment.idCite,n.empty(this.batiment.adresse)||(this.pays=this.batiment.adresse.pays,this.ville=this.batiment.adresse.ville,this.quartier=this.batiment.adresse.quartier,this.mapCoordinates.lat=this.batiment.adresse.lat,this.mapCoordinates.lng=this.batiment.adresse.lon),this.idCite=this.batiment.idCite,this.idCite=this.batiment.idCite),this.showOverlay=!1},makeRepeater(){setTimeout(()=>{$("#"+this.repeaterId).repeater({isFirstItemUndeletable:!0})},500)},setSlide_cite(e){for(let t=0;t<this.slideCites.length;t++)if(this.slideCites[t].idCite==e&&!n.empty(this.$refs.citeCarousel)){this.$refs.citeCarousel.setSlide(t);break}},async submitForm(){if(n.empty(this.nom)||n.empty(this.ref)||n.empty(this.idCite))return App.error("Veuillez remplir le nom et la reference du batiment");if(-1==this.idCite&&(n.empty(this.nomCite)||n.empty(this.refCite)))return App.error("Veuillez entrer le nom et la reference de la cité");this.submitted=!0;let e={nom:this.nom,idCite:this.idCite,ref:this.ref,photo:await this.$getBase64(this.photo.batiment),batiments:[],adresse:{pays:this.pays,ville:this.ville,quartier:this.quartier,lat:this.mapCoordinates.lat,lon:this.mapCoordinates.lng}};if("add"==this.action){if(-1==e.idCite)try{let t=await axios.post("cites",{nom:this.nomCite,ref:this.refCite,photo:await this.$getBase64(this.photo.cite)});e.idCite=t.result.idCite}catch(t){return App.alertError(t.message)}if(!n.empty(this.cite)){let t=$("#"+this.repeaterId).repeaterVal().group;if(console.log(t),n.empty(t[0].nom)||n.empty(t[0].ref))return App.error("Vous devez remplir au moins les informations du premier batiment");e.batiments=t}axios.post("batiments",e).then(e=>(this.$emit("batimentAdded",e.result),this.submitted=!1,App.notifySuccess(e.message))).catch(e=>(this.submitted=!1,App.notifyError(e.message)))}"edit"!=this.action||n.empty(this.batiment)||axios.put("batiments/"+this.batiment.idBatiment,e).then(t=>(this.$emit("batimentUpdated",{...e,idBatiment:this.batiment.idBatiment}),this.submitted=!1,App.notifySuccess(t.message))).catch(e=>(this.submitted=!1,App.notifyError(e.message)))}}},l=r,d=(i("5151"),i("2877")),c=Object(d["a"])(l,a,s,!1,null,null,null);t["a"]=c.exports},5151:function(e,t,i){"use strict";i("7b29")},"5ad6":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"card d-flex flex-row justify-justify-content-start align-items-start"},[i("a",{staticClass:"d-flex card-img",attrs:{href:"#editLayoutItem","data-toggle":"modal","data-target":"#editLayoutItem"}},[i("img",{staticClass:"list-thumbnail responsive border-0",staticStyle:{height:"10em"},attrs:{src:e.depense.photo||"/img/depenseImage.jpg",alt:""}})]),i("div",{staticClass:"d-flex flex-grow-1 min-width-zero card-content"},[i("div",{staticClass:"card-body align-self-center d-flex flex-column justify-content-between min-width-zero align-items-md-center"},[i("div",{staticClass:"list-item-heading mb-1 truncate w-100 w-xs-100",attrs:{href:"#editLayoutItem","data-toggle":"modal","data-target":"#editLayoutItem"}},[i("h5",{staticClass:"text-red"},[e._v(e._s(e.php.ucfirst(e.depense.motif.toLowerCase())))]),i("div",{staticClass:"d-flex"},[i("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.bottom",value:"Montant de la dépense",expression:"'Montant de la dépense'",modifiers:{bottom:!0}}],staticClass:"text-muted small date mr-3"},[i("i",{staticClass:"fa fa-dollar-sign"}),e._v(" "+e._s(e.depense.montant)+" F")]),i("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.bottom",value:"Date de l'opération",expression:"'Date de l\\'opération'",modifiers:{bottom:!0}}],staticClass:"text-muted small date ml-3"},[i("i",{staticClass:"far fa-calendar-alt"}),e._v(" "+e._s(e.$dayjs(e.depense.dateDepense).format("DD MMMM YYYY"))+" ")])]),i("div",{staticClass:"w-100"},[e.depense.etatDepense?i("span",{staticClass:"badge badge-pill badge-success"}):i("span",{staticClass:"badge badge-danger small"},[e._v("Non traitée")])])]),i("div",{staticClass:"card-content w-100"},[i("hr"),0==e.source?i("div",[null!==e.depense.cite?i("div",{staticClass:"text-muted w-100 my-1"},[e._m(0),i("span",[e._v("Cité :"+e._s(e.depense.cite.nomCite)+" ")])]):e._e(),null!==e.depense.batiment?i("div",{staticClass:"text-muted w-100 my-1"},[e._m(1),i("span",[e._v("Batiment :"+e._s(e.depense.batiment.nomBatiment)+" ")])]):e._e(),null!==e.depense.logement?i("div",{staticClass:"text-muted w-100 my-1"},[e._m(2),i("span",[e._v("Logement :"+e._s(e.depense.logement.refLogement)+" ")])]):e._e()]):e._e(),e.depense.observation?i("div",{staticClass:"jumbotron pt-5 pb-5 px-3 my-0"},[i("p",{staticClass:"text-muted text-small"},[e._v(e._s(e.depense.observation))])]):e._e()])]),i("div",{staticClass:"list-actions"},[e.isSub?e._e():i("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.showDetails.apply(null,arguments)}}},[i("i",{staticClass:"ik ik-eye"})]),e.isSub?i("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.accessTo.apply(null,arguments)}}},[i("i",{staticClass:"ik ik-link"})]):e._e(),e.isSub?e._e():i("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.$emit("makeUpdate",e.depense)}}},[i("i",{staticClass:"ik ik-edit-2"})]),i("a",{staticClass:"list-delete",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.remove.apply(null,arguments)}}},[i("i",{staticClass:"ik ik-trash-2"})])])])])},s=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",{staticClass:"d-inline-block w-10 text-center"},[i("i",{staticClass:"fas fa-city"})])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",{staticClass:"d-inline-block w-10 text-center"},[i("i",{staticClass:"fa fa-building"})])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",{staticClass:"d-inline-block w-10 text-center"},[i("i",{staticClass:"fas fa-home"})])}];const o=i("5a6f");var n={props:{depense:{type:Object,required:!0},isSub:{type:Boolean,default:!1},source:{type:Number,default:0}},computed:{dateCreation(){const e=this.$date(this.depense.createdAt);return`Crée le ${e.format("dddd, DD MMMM YYYY")} à ${e.format("HH:mm")}`},php(){return o}},methods:{showDetails(){if(this.isSub)return!1;this.$emit("showDetails",this.depense)},accessTo(){$("#editLayoutItem").modal("hide"),this.$router.push({name:"depenses",query:{target:this.depense.idDepense}})},remove(){App.confirm(`Voullez vous vraiment supprimer la dépense " <b>${this.depense.motif}</b> " ?`,{confirm:()=>{axios.delete("depenses/"+this.depense.idDepense).then(e=>e.success?(this.$emit("deleted",this.depense.idDepense),App.notifySuccess(e.message)):App.notifyError(e.message))}})}}},r=n,l=i("2877"),d=Object(l["a"])(r,a,s,!1,null,null,null);t["a"]=d.exports},"5c21":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"shadow list-item list-item-grid"},[i("div",{staticClass:"card d-flex flex-row mb-3"},[i("a",{staticClass:"d-flex card-img",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.showDetails.apply(null,arguments)}}},[i("img",{staticClass:"list-thumbnail responsive border-0",staticStyle:{height:"10em"},attrs:{src:e.batiment.image||"/img/batiment-default.jpeg",alt:""}}),e.isNew?i("span",{staticClass:"badge badge-pill badge-primary position-absolute badge-top-left"},[e._v("New")]):e._e()]),i("div",{staticClass:"d-flex flex-grow-1 min-width-zero card-content"},[i("div",{staticClass:"card-body align-self-center d-flex flex-column flex-md-row justify-content-between min-width-zero align-items-md-center"},[i("div",{staticClass:"text-center"},[i("h4",{staticClass:"text-red mt-0 truncate"},[e._v(e._s(e.batiment.nomBatiment))]),i("span",{staticClass:"d-inline-block text-muted"},[e._v("Reference: "),i("b",[e._v(e._s(e.batiment.refBatiment))])])]),e.isSub?i("p",{staticClass:"text-muted mt-3 mb-1 date w-15 w-xs-100 text-small"},[e._v(e._s(e.$date(e.batiment.createdAt).format("DD.MM.YYYY")))]):i("p",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.bottom",value:e.dateCreation,expression:"dateCreation",modifiers:{bottom:!0}}],staticClass:"mt-3 mb-1 text-muted text-small date w-15 w-xs-100"},[e._v(e._s(e.$date(e.batiment.createdAt).format("DD.MM.YYYY")))])]),i("div",{staticClass:"list-actions"},[e.isSub?e._e():i("a",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.bottom",value:"Détails",expression:"'Détails'",modifiers:{bottom:!0}}],attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.showDetails.apply(null,arguments)}}},[i("i",{staticClass:"ik ik-eye"})]),e.isSub?i("a",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.bottom",value:"Accéder aux détails",expression:"'Accéder aux détails'",modifiers:{bottom:!0}}],attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.accessTo.apply(null,arguments)}}},[i("i",{staticClass:"ik ik-link"})]):e._e(),e.isSub?e._e():i("a",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.bottom",value:"Editer",expression:"'Editer'",modifiers:{bottom:!0}}],attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.$emit("makeUpdate",e.batiment)}}},[i("i",{staticClass:"ik ik-edit-2"})]),i("a",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.bottom",value:"Supprimer",expression:"'Supprimer'",modifiers:{bottom:!0}}],staticClass:"list-delete",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.remove.apply(null,arguments)}}},[i("i",{staticClass:"ik ik-trash-2"})])])])])])},s=[],o={props:{batiment:{type:Object,required:!0},isSub:{type:Boolean,default:!1}},computed:{dateCreation(){const e=this.$date(this.batiment.createdAt);return`Créée le ${e.format("dddd, DD MMMM YYYY")} à ${e.format("HH:mm")}`},isNew(){return dayjs().diff(this.batiment.createdAt,"week")<=1}},methods:{showDetails(){if(this.isSub)return!1;this.$emit("showDetails",this.batiment)},accessTo(){$("#editLayoutItem").modal("hide"),this.$router.push({name:"batiments",query:{target:this.batiment.idBatiment}})},remove(){App.confirm(`Voullez vous vraiment supprimer le batiment " <b>${this.batiment.nomBatiment}</b> " ?`,{confirm:()=>{axios.delete("batiments/"+this.batiment.idBatiment).then(e=>e.success?(this.$emit("deleted",this.batiment.idBatiment),App.notifySuccess(e.message)):App.notifyError(e.message)).catch(e=>{App.notifyError(e.message)})}})}}},n=o,r=i("2877"),l=Object(r["a"])(n,a,s,!1,null,null,null);t["a"]=l.exports},"7b29":function(e,t,i){},a474:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("b-overlay",{attrs:{show:e.showOverlayP,rounded:"sm"}},[i("b-row",[i("b-col",[i("b-form-group",{attrs:{label:"Montant",description:"à combien s'élève la dépense éffectuée?"}},[i("b-form-input",{attrs:{placeholder:"Ex: 45000",type:"number",trim:""},model:{value:e.depense.montant,callback:function(t){e.$set(e.depense,"montant",t)},expression:"depense.montant"}})],1)],1),i("b-col",[i("b-form-group",{attrs:{label:"Date à laquelle la dépense a été éffectuée"}},[i("date-picker",{staticClass:"w-100",attrs:{placeholder:"Selectionnez une date",format:"dddd, DD MMMM YYYY",valueType:"YYYY-MM-DD",clearable:!1},model:{value:e.depense.date,callback:function(t){e.$set(e.depense,"date",t)},expression:"depense.date"}})],1)],1)],1),i("b-row",[i("b-col",[i("b-form-group",{attrs:{label:"Motif",description:"Pourquoi avez-vous éffectué cette dépense ?"}},[i("b-form-input",{attrs:{placeholder:"Ex: Replacement ampoules cassées",trim:""},model:{value:e.depense.motif,callback:function(t){e.$set(e.depense,"motif",t)},expression:"depense.motif"}})],1)],1),i("b-col",[i("b-form-group",{attrs:{label:"responsable",description:"Qui est celui qui a déclaré la dépense?"}},[i("b-form-input",{attrs:{placeholder:"Ex: Pedro",trim:""},model:{value:e.depense.responsable,callback:function(t){e.$set(e.depense,"responsable",t)},expression:"depense.responsable"}})],1)],1)],1),i("b-row",[i("b-col",{attrs:{cols:"7"}},[i("b-form-group",{attrs:{label:"observations"}},[i("b-form-textarea",{staticClass:"mb-2",attrs:{placeholder:"C'est ici que vou pouvez décrire ce qui a engendré la dépense",rows:"7"},model:{value:e.depense.observation,callback:function(t){e.$set(e.depense,"observation",t)},expression:"depense.observation"}})],1)],1),i("b-col",{attrs:{cols:"5"}},[i("b-form-group",{attrs:{label:"joindre une photo"}},[i("img-inputer",{attrs:{theme:"light",size:"xl","bottom-text":"déposez le fichier ici ou cliquez pour modifier",icon:"img",placeholder:"joindre recu dépense"},on:{onChange:e.onrecuLoad},model:{value:e.depense.photo,callback:function(t){e.$set(e.depense,"photo",t)},expression:"depense.photo"}})],1)],1)],1),i("b-overlay",{attrs:{show:e.showOverlay,rounded:"sm"}},[i("b-row",[i("b-col",[i("b-form-group",{attrs:{label:"Votre dépense concerne"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.ariaDescribedby;return[i("b-form-radio-group",{attrs:{id:"radio-slots",options:e.options,"aria-describedby":a,name:"radio-options-slots",disabled:e.disableState},on:{change:e.setAction},model:{value:e.commandeAction,callback:function(t){e.commandeAction=t},expression:"commandeAction"}})]}}])})],1),i("b-col",[i("transition",{attrs:{"enter-active-class":"animated zoomIn"}},[e.showSelectCite?i("div",{staticClass:"form-group"},[i("label",[e._v("Cité concernée")]),i("v-select",{class:{disabled:1==e.disabled},attrs:{label:"nomCite",options:e.cites},model:{value:e.id,callback:function(t){e.id=t},expression:"id"}})],1):e._e(),e.showSelectBatiment?i("div",{staticClass:"form-group"},[i("label",[e._v("Batiment concerné")]),i("v-select",{class:{disabled:1==e.disabled},attrs:{label:"nomBatiment",options:e.batiments},model:{value:e.id,callback:function(t){e.id=t},expression:"id"}})],1):e._e(),e.showSelectLogement?i("div",{staticClass:"form-group"},[i("label",[e._v("Logement concerné")]),i("v-select",{class:{disabled:1==e.disabled},attrs:{label:"refLogement",options:e.logements},model:{value:e.id,callback:function(t){e.id=t},expression:"id"}})],1):e._e()])],1)],1),i("hr"),i("div",{staticClass:"float-right"},["2"==e.provenance?i("b-button",{staticClass:"mr-1",on:{click:function(t){return t.preventDefault(),e.$emit("cancel")}}},[e._v("Annuler")]):e._e(),i("b-button",{attrs:{variant:"danger"},on:{click:function(t){return t.preventDefault(),e.submitModal.apply(null,arguments)}}},[e._v("Valider")])],1)],1)],1)},s=[],o=i("ec45"),n=(i("411c"),i("0edd"),i("2c43")),r=i("2b0e"),l=i("657c");i("2bd9");const d=i("5a6f");r["default"].component("ImgInputer",l["a"]);var c={name:"depense-form",data:()=>({disabled:!1,disableState:!1,options:[{text:"une cité",value:"cite"},{text:"un batiment",value:"batiment"},{text:"un logement",value:"logement"}],depense:{montant:"",date:"",motif:"",responsable:"",obs:"",photo:""},id:"",commandeAction:"",showOverlay:!1,showOverlayP:!1,showSelectCite:!1,showSelectBatiment:!1,showSelectLogement:!1,sendForm:!1,cites:[],batiments:[],logements:[]}),components:{DatePicker:o["default"]},props:{cite:{type:Object},batiment:{type:Object},logement:{type:Object},action:{type:String,required:!0,default:"add"},provenance:{type:String,required:!0,default:"1"}},methods:{async onrecuLoad(e){const t=e;this.depense.photo=await this.getBase64(t)},async setAction(){if(this.showOverlay=!0,"cite"==this.commandeAction){this.showSelectCite=!0,this.showSelectBatiment=!1,this.showSelectLogement=!1;try{this.cites=await(await axios.get("cites").then(e=>e.result))}catch(e){console.log(e)}}if("batiment"==this.commandeAction){this.showSelectBatiment=!0,this.showSelectCite=!1,this.showSelectLogement=!1;try{this.batiments=await(await axios.get("batiments").then(e=>e.result))}catch(e){console.log(e)}}if("logement"==this.commandeAction){this.showSelectLogement=!0,this.showSelectCite=!1,this.showSelectBatiment=!1;try{this.logements=await(await axios.get("logements").then(e=>e.result))}catch(e){console.log(e)}}this.showOverlay=!1},resetModal(){this.depense={montant:"",date:"",motif:"",responsable:"",observation:""},"2"!=this.provenance&&(this.showSelectCite=!1,this.showSelectBatiment=!1,this.showSelectLogement=!1,this.id=null,this.commandeAction=""),setTimeout(()=>{this.$emit("closeDepenseModal")},500)},submitModal(e){return e.preventDefault(),d.empty(this.depense.montant)||d.empty(this.depense.motif)||d.empty(this.id)?App.error("Un montant, un motif et l'entité concernée par la dépense sont obligatoires"):""==this.depense.montant?App.error("Vous devez spécifier un montant"):""==this.depense.motif?App.error("Vous devez spécifier un motif"):""==this.id?App.error("Vous devez spécifier l'entité concernée par la dépense"):void("add"==this.action&&(this.showOverlayP=!0,this.showSelectLogement&&(console.log("dépense",this.depense,"id",this.id.idLogement),axios.post("/logements/"+this.id.idLogement+"/depenses",this.depense).then(e=>(this.resetModal(),this.showOverlayP=!1,this.$emit("depenseAdded",e.result),App.notifySuccess(e.message))).catch(e=>{this.showOverlayP=!1,n["a"].error(e.message)})),this.showSelectCite&&axios.post("/cites/"+this.id.idCite+"/depenses",this.depense).then(e=>(this.resetModal(),this.showOverlayP=!1,this.$emit("depenseAdded",e.result),App.notifySuccess(e.message))).catch(e=>{this.showOverlayP=!1,n["a"].error(e.message)}),this.showSelectBatiment&&axios.post("/batiments/"+this.id.idBatiment+"/depenses",this.depense).then(e=>(this.resetModal(),this.showOverlayP=!1,this.$emit("depenseAdded",e.result),App.notifySuccess(e.message))).catch(e=>{this.showOverlayP=!1,n["a"].error(e.message)})))},getBase64(e){return new Promise((t,i)=>{const a=new FileReader;a.readAsDataURL(e),a.onload=()=>t(a.result),a.onerror=e=>i(e)})}},mounted(){null!=this.cite&&(this.commandeAction="cite",this.showSelectCite=!0,this.id=this.cite,this.disabled=!0,this.disableState=!0),null!=this.batiment&&(this.commandeAction="batiment",this.showSelectBatiment=!0,this.id=this.batiment,this.disabled=!0,this.disableState=!0),null!=this.logement&&(this.commandeAction="logement",this.showSelectLogement=!0,this.id=this.logement,this.disabled=!0,this.disableState=!0)}},m=c,u=(i("287a"),i("2877")),p=Object(u["a"])(m,a,s,!1,null,"47a744a2",null);t["a"]=p.exports},fb87:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"search-sm d-inline-block float-md-left mr-1 mb-1 align-top"},[i("form",{attrs:{action:"",onSubmit:"return false"}},[i("b-form-input",{staticStyle:{height:"40px",width:"350px","border-radius":"5px"},attrs:{type:"text",placeholder:e.placeholder},on:{input:function(t){e.$emit("input",t)}},model:{value:e.val,callback:function(t){e.val=t},expression:"val"}}),e._m(0)],1)])},s=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("button",{staticClass:"btn btn-icon",staticStyle:{height:"40px",width:"50px"},attrs:{type:"submit"}},[i("i",{staticClass:"ik ik-search"})])}],o={name:"SearchForm",props:{placeholder:{type:String,default:"Rechercher..."},value:{required:!0,default:""}},data:()=>({val:null}),mounted(){this.val=this.value}},n=o,r=i("2877"),l=Object(r["a"])(n,a,s,!1,null,"0cf1e66c",null);t["a"]=l.exports}}]);
//# sourceMappingURL=chunk-2c2aca54.a93d3982.js.map