{"version":3,"sources":["webpack:///./src/views/finances/Indexes.vue?5fef","webpack:///src/views/finances/Indexes.vue","webpack:///./src/views/finances/Indexes.vue?3c93","webpack:///./src/views/finances/Indexes.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","directives","name","rawName","value","expression","domProps","on","$event","target","composing","search","_m","mois","setIndexesMois","periode","annee","model","callback","$$v","$set","annees","showOverlay","logements","length","_l","logement","key","idLogement","refLogement","sousTypeLogement","libelleSousType","indexeMois","staticStyle","indexe","i","_v","_s","$dayjs","format","nouveau","ancien","indexePassee","offset","perPage","currentPage","page","limit","submitted","preventDefault","submitForm","apply","arguments","_e","staticRenderFns","php","data","trueLogements","popoverShow","watch","empty","filter","elt","toLowerCase","includes","computed","array_slice","current","push","sort","a","b","date","Date","setMonth","text","ucfirst","parseInt","getLogements","methods","axios","get","then","response","result","indexes","forEach","eau","energie","post","App","notifySuccess","message","catch","error","alertError","periodeCourante","setIndexesPeriode","periodePassee","subtract","map","indexesCourants","e","diff","iEau","find","typeIndexe","iEnergie","component"],"mappings":"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","file":"js/chunk-2d20935e.c17788ba.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container-fluid\"},[_c('page-description',{attrs:{\"title\":\"Rélévés d'indexes\",\"description\":\"Rélévés des indexes d'eau et d'énergie\",\"icon\":\"clipboard-list\",\"path\":['Finance', 'Rélévés d\\'indexes']}}),_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"col-md-12\"},[_c('div',{staticClass:\"mb-2 clearfix\"},[_c('div',{staticClass:\"collapse d-md-block display-options\",attrs:{\"id\":\"displayOptions\"}},[_c('div',{staticClass:\"d-block d-md-inline-block\"},[_c('div',{staticClass:\"search-sm d-inline-block float-md-left mr-1 mb-1 align-top\"},[_c('form',{attrs:{\"action\":\"\",\"onSubmit\":\"return false\"}},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.search),expression:\"search\"}],staticClass:\"form-control\",attrs:{\"type\":\"text\",\"placeholder\":\"Recherche...\"},domProps:{\"value\":(_vm.search)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.search=$event.target.value}}}),_vm._m(0)])])]),_c('div',{staticClass:\"float-md-right\"},[_c('div',{staticClass:\"d-flex \"},[_c('b-form-select',{staticClass:\"form-control\",attrs:{\"size\":\"sm\",\"options\":_vm.mois},on:{\"input\":function (value) { return _vm.setIndexesMois(value, _vm.periode.annee); }},model:{value:(_vm.periode.mois),callback:function ($$v) {_vm.$set(_vm.periode, \"mois\", $$v)},expression:\"periode.mois\"}}),_c('b-form-select',{staticClass:\"form-control\",attrs:{\"size\":\"sm\",\"options\":_vm.annees},on:{\"input\":function (value) { return _vm.setIndexesMois(_vm.periode.mois, value); }},model:{value:(_vm.periode.annee),callback:function ($$v) {_vm.$set(_vm.periode, \"annee\", $$v)},expression:\"periode.annee\"}})],1)])])]),_c('div',{staticClass:\"separator mb-20\"}),_c('b-overlay',{attrs:{\"show\":_vm.showOverlay,\"rounded\":\"sm\"}},[(!_vm.logements.length)?_c('b-alert',{staticClass:\"text-center\",attrs:{\"variant\":\"info\",\"show\":\"\"}},[_c('i',{staticClass:\"fa fa-exclamation-triangle fa-3x\"}),_vm._v(\" \"),_c('br'),_c('span',{staticClass:\"h4 d-inline-flex ml-2\"},[_vm._v(\"Vous n'avez défini aucun logement pour le moment\")])]):_c('b-row',_vm._l((_vm.items),function(logement){return _c('b-col',{key:logement.idLogement,attrs:{\"cols\":\"3\"}},[_c('b-card',{attrs:{\"title\":logement.refLogement,\"sub-title\":logement.sousTypeLogement.libelleSousType}},[_c('hr'),_c('b-form-group',{attrs:{\"label\":\"Indexe eau\"}},[_c('b-input-group',[_c('b-form-input',{attrs:{\"size\":\"sm\",\"type\":\"number\",\"min\":\"0\"},model:{value:(logement.indexeMois.eau),callback:function ($$v) {_vm.$set(logement.indexeMois, \"eau\", $$v)},expression:\"logement.indexeMois.eau\"}}),_c('b-input-group-append',[_c('b-button',{attrs:{\"size\":\"sm\",\"variant\":\"outline-danger\",\"id\":'popover-eau-'+logement.idLogement}},[_c('i',{staticClass:\"fa fa-list\"})])],1)],1)],1),_c('b-form-group',{attrs:{\"label\":\"Indexe lumière\"}},[_c('b-input-group',[_c('b-form-input',{attrs:{\"type\":\"number\",\"min\":\"0\"},model:{value:(logement.indexeMois.energie),callback:function ($$v) {_vm.$set(logement.indexeMois, \"energie\", $$v)},expression:\"logement.indexeMois.energie\"}}),_c('b-input-group-append',[_c('b-button',{attrs:{\"variant\":\"outline-danger\",\"id\":'popover-energie-'+logement.idLogement}},[_c('i',{staticClass:\"fa fa-list\"})])],1)],1)],1),_c('b-popover',{attrs:{\"title\":\"Indexes précedents\",\"target\":'popover-eau-'+logement.idLogement,\"triggers\":\"click blur\",\"placement\":\"auto\"}},[_c('div',{staticStyle:{\"overflow-y\":\"auto\",\"overflow-x\":\"hidden\",\"max-height\":\"15em\"}},_vm._l((logement.iEau),function(indexe,i){return _c('div',{key:i,staticClass:\"text-muted mb-1\"},[_c('h6',{staticClass:\"border-bottom small\"},[_vm._v(_vm._s(_vm.$dayjs(indexe.periode).format('MMMM YYYY')))]),_c('b-row',[_c('b-col',{staticClass:\"truncate\"},[_vm._v(\"N: \"),_c('b',[_vm._v(_vm._s(indexe.nouveau))]),_vm._v(\" m\"),_c('sup',[_vm._v(\"3\")])]),_c('b-col',{staticClass:\"truncate\"},[_vm._v(\"A: \"),_c('b',[_vm._v(_vm._s(indexe.ancien))]),_vm._v(\" m\"),_c('sup',[_vm._v(\"3\")])])],1)],1)}),0),_c('div',{staticClass:\"jumbotron pt-10 pb-1 px-2 mb-0 mt-2\"},[_c('b-form-group',{attrs:{\"label\":\"Mois passé\"}},[_c('b-form-input',{attrs:{\"size\":\"sm\",\"min\":\"0\",\"type\":\"number\"},model:{value:(logement.indexePassee.eau),callback:function ($$v) {_vm.$set(logement.indexePassee, \"eau\", $$v)},expression:\"logement.indexePassee.eau\"}})],1)],1)]),_c('b-popover',{attrs:{\"title\":\"Indexes précedents\",\"target\":'popover-energie-'+logement.idLogement,\"triggers\":\"click blur\",\"placement\":\"auto\"}},[_c('div',{staticStyle:{\"overflow-y\":\"auto\",\"overflow-x\":\"hidden\",\"max-height\":\"15em\"}},_vm._l((logement.iEnergie),function(indexe,i){return _c('div',{key:i,staticClass:\"text-muted mb-1\"},[_c('h6',{staticClass:\"border-bottom small\"},[_vm._v(_vm._s(_vm.$dayjs(indexe.periode).format('MMMM YYYY')))]),_c('b-row',[_c('b-col',{staticClass:\"truncate\"},[_vm._v(\"N: \"),_c('b',[_vm._v(_vm._s(indexe.nouveau))]),_vm._v(\" kw\")]),_c('b-col',{staticClass:\"truncate\"},[_vm._v(\"A: \"),_c('b',[_vm._v(_vm._s(indexe.ancien))]),_vm._v(\" kw\")])],1)],1)}),0),_c('div',{staticClass:\"jumbotron pt-10 pb-1 px-2 mb-0 mt-2\"},[_c('b-form-group',{attrs:{\"label\":\"Mois passé\"}},[_c('b-form-input',{attrs:{\"size\":\"sm\",\"min\":\"0\",\"type\":\"number\"},model:{value:(logement.indexePassee.energie),callback:function ($$v) {_vm.$set(logement.indexePassee, \"energie\", $$v)},expression:\"logement.indexePassee.energie\"}})],1)],1)])],1)],1)}),1),_c('hr'),_c('div',{staticClass:\"d-flex justify-content-between align-items-start\"},[_c('paginator',{attrs:{\"offset\":_vm.offset,\"total\":_vm.logements.length,\"limit\":_vm.perPage,\"page\":_vm.currentPage},on:{\"pageChanged\":function (page) {_vm.currentPage = page},\"limitChanged\":function (limit) {_vm.perPage = limit}}}),_c('b-button',{attrs:{\"variant\":\"danger\",\"disabled\":_vm.submitted},on:{\"click\":function($event){$event.preventDefault();return _vm.submitForm.apply(null, arguments)}}},[_vm._v(\"Valider \"),(_vm.submitted)?_c('b-spinner',{attrs:{\"small\":\"\"}}):_vm._e()],1)],1)],1)],1)])],1)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('button',{staticClass:\"btn btn-icon\",attrs:{\"type\":\"submit\"}},[_c('i',{staticClass:\"ik ik-search\"})])}]\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"container-fluid\">\r\n    <!--page header start -->\r\n    <page-description title=\"Rélévés d'indexes\" description=\"Rélévés des indexes d'eau et d'énergie\" icon=\"clipboard-list\" :path=\"['Finance', 'Rélévés d\\'indexes']\" />\r\n        <div class=\"row\">\r\n            <div class=\"col-md-12\">\r\n                <div class=\"mb-2 clearfix\">\r\n                    <div class=\"collapse d-md-block display-options\" id=\"displayOptions\">               \r\n                        <div class=\"d-block d-md-inline-block\">\r\n                            <div class=\"search-sm d-inline-block float-md-left mr-1 mb-1 align-top\">\r\n                                <form action=\"\" onSubmit=\"return false\">\r\n                                    <input type=\"text\" class=\"form-control\" placeholder=\"Recherche...\" v-model=\"search\">\r\n                                    <button type=\"submit\" class=\"btn btn-icon\"><i class=\"ik ik-search\"></i></button>\r\n                                </form>\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"float-md-right\">\r\n                            <div class=\"d-flex \">\r\n                                <b-form-select class=\"form-control\" size=\"sm\" @input=\"(value) => setIndexesMois(value, periode.annee)\" v-model=\"periode.mois\" :options=\"mois\"></b-form-select>\r\n                                <b-form-select class=\"form-control\" size=\"sm\" @input=\"(value) => setIndexesMois(periode.mois, value)\" v-model=\"periode.annee\" :options=\"annees\"></b-form-select>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"separator mb-20\"></div>\r\n                <b-overlay :show=\"showOverlay\" rounded=\"sm\">\r\n                    <b-alert variant=\"info\" class=\"text-center\" show v-if=\"!logements.length\">\r\n                        <i class=\"fa fa-exclamation-triangle fa-3x\"></i> <br>\r\n                        <span class=\"h4 d-inline-flex ml-2\">Vous n'avez défini aucun logement pour le moment</span>\r\n                    </b-alert> \r\n                    <b-row v-else>\r\n                        <b-col cols=\"3\" v-for=\"logement in items\" :key=\"logement.idLogement\"> \r\n                            <b-card :title=\"logement.refLogement\" :sub-title=\"logement.sousTypeLogement.libelleSousType\">\r\n                                <hr>\r\n                                <b-form-group label=\"Indexe eau\">\r\n                                    <b-input-group>\r\n                                        <b-form-input size=\"sm\" type=\"number\" min=\"0\" v-model=\"logement.indexeMois.eau\" />\r\n                                        <b-input-group-append>\r\n                                            <b-button size=\"sm\" variant=\"outline-danger\" :id=\"'popover-eau-'+logement.idLogement\"><i class=\"fa fa-list\"></i></b-button>\r\n                                        </b-input-group-append>\r\n                                    </b-input-group>\r\n                                </b-form-group>\r\n                                <b-form-group label=\"Indexe lumière\">\r\n                                    <b-input-group>\r\n                                        <b-form-input type=\"number\" min=\"0\" v-model=\"logement.indexeMois.energie\" />\r\n                                        <b-input-group-append>\r\n                                            <b-button variant=\"outline-danger\" :id=\"'popover-energie-'+logement.idLogement\"><i class=\"fa fa-list\"></i></b-button>\r\n                                        </b-input-group-append>\r\n                                    </b-input-group>\r\n                                </b-form-group>\r\n\r\n                                <b-popover title=\"Indexes précedents\" :target=\"'popover-eau-'+logement.idLogement\" triggers=\"click blur\" placement=\"auto\">\r\n                                    <div style=\"overflow-y:auto; overflow-x: hidden; max-height: 15em\">\r\n                                        <div v-for=\"(indexe, i) in logement.iEau\" :key=\"i\" class=\"text-muted mb-1\">\r\n                                            <h6 class=\"border-bottom small\">{{ $dayjs(indexe.periode).format('MMMM YYYY') }}</h6>\r\n                                            <b-row>\r\n                                                <b-col class=\"truncate\">N: <b>{{ indexe.nouveau }}</b> m<sup>3</sup></b-col>\r\n                                                <b-col class=\"truncate\">A: <b>{{ indexe.ancien }}</b> m<sup>3</sup></b-col>\r\n                                            </b-row>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div class=\"jumbotron pt-10 pb-1 px-2 mb-0 mt-2\">\r\n                                        <b-form-group label=\"Mois passé\"><b-form-input size=\"sm\" min=\"0\" type=\"number\" v-model=\"logement.indexePassee.eau\" /></b-form-group>\r\n                                    </div>\r\n                                </b-popover>\r\n                                <b-popover title=\"Indexes précedents\" :target=\"'popover-energie-'+logement.idLogement\" triggers=\"click blur\" placement=\"auto\">\r\n                                    <div style=\"overflow-y:auto; overflow-x: hidden; max-height: 15em\">\r\n                                        <div v-for=\"(indexe, i) in logement.iEnergie\" :key=\"i\" class=\"text-muted mb-1\">\r\n                                            <h6 class=\"border-bottom small\">{{ $dayjs(indexe.periode).format('MMMM YYYY') }}</h6>\r\n                                            <b-row>\r\n                                                <b-col class=\"truncate\">N: <b>{{ indexe.nouveau }}</b> kw</b-col>\r\n                                                <b-col class=\"truncate\">A: <b>{{ indexe.ancien }}</b> kw</b-col>\r\n                                            </b-row>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div class=\"jumbotron pt-10 pb-1 px-2 mb-0 mt-2\">\r\n                                        <b-form-group label=\"Mois passé\"><b-form-input size=\"sm\" min=\"0\" type=\"number\" v-model=\"logement.indexePassee.energie\" /></b-form-group>\r\n                                    </div>\r\n                                </b-popover>\r\n                            </b-card>\r\n                        </b-col>\r\n                    </b-row>\r\n                    <hr>\r\n                    <div class=\"d-flex justify-content-between align-items-start\">\r\n                        <paginator :offset=\"offset\" :total=\"logements.length\" :limit=\"perPage\" :page=\"currentPage\" @pageChanged=\"(page) => {currentPage = page}\" @limitChanged=\"(limit) => {perPage = limit}\" /> \r\n                        <b-button variant=\"danger\" :disabled=\"submitted\" @click.prevent=\"submitForm\">Valider <b-spinner small v-if=\"submitted\" /></b-button>\r\n\r\n                    </div>\r\n                </b-overlay>\r\n            </div>\r\n        </div>\r\n        \r\n  </div>\r\n</template>\r\n<script>\r\n  const php  = require ( 'phpjs' ) ; \r\n\r\nexport default {\r\n  name: \"releves-indexes\",\r\n  data: () => ({\r\n    search: null,\r\n    showOverlay: true,\r\n    submitted: false,\r\n    currentPage: 1,\r\n    perPage: 10,\r\n    logements:[],\r\n    trueLogements:[],\r\n\r\n\r\n    popoverShow: false,\r\n    periode: {annee: null, mois: null}\r\n\r\n  }),\r\n    watch: {\r\n        search(value) {\r\n            this.logements = !php.empty(value) ? this.trueLogements.filter(elt => elt.refLogement.toLowerCase().includes(value.toLowerCase())) : this.trueLogements\r\n        }\r\n    },\r\n  computed: {\r\n        /**\r\n         * Elements affichés avec prise en charge de la pagination\r\n         */\r\n        items() { \r\n            return php.array_slice(this.logements, this.offset, this.perPage) \r\n        },\r\n        offset() {\r\n            return (this.currentPage * this.perPage) - this.perPage\r\n        },\r\n\r\n\r\n        annees() {\r\n            const current = this.$dayjs().format('YYYY')\r\n            let annees = [current]\r\n\r\n            for (let i = current; i > (current - 15); i--) {\r\n                if (i != current) {\r\n                    annees.push(i)\r\n                    annees.push(i + 15)\r\n                }\r\n            }\r\n            \r\n            return annees.sort((a, b) => a - b)\r\n        },\r\n        mois() {\r\n            let date = new Date, \r\n                mois = []\r\n            for (let i = 0; i < 12; i++) {\r\n                date.setMonth(i)\r\n                mois.push({ value: i, text: php.ucfirst(this.$dayjs(date).format('MMMM')) })\r\n            }\r\n\r\n            return mois\r\n        }\r\n    },\r\n\r\n    beforeMount() {\r\n        this.periode = {\r\n            mois: parseInt(this.$dayjs().format('M')) - 1,\r\n            annee: parseInt(this.$dayjs().format('YYYY'))\r\n        }\r\n        this.getLogements()\r\n    },\r\n    methods: {\r\n        onClose() {\r\n            this.popoverShow = false\r\n        },\r\n\r\n        //recupération de la liste des logements\r\n        getLogements() {\r\n            axios.get('logements').then(response => response.result || []).then(logements => {\r\n                \r\n                this.logements = this.trueLogements = logements\r\n                \r\n                this.setIndexesMois(this.periode.mois, this.periode.annee)\r\n                this.showOverlay = false\r\n            })\r\n        },\r\n\r\n        submitForm() {\r\n            this.submitted = true \r\n\r\n            let periode = this.periode.mois + 1\r\n            if (periode < 10) {\r\n                periode = '0' + periode\r\n            }\r\n            periode = this.periode.annee + '-' + periode + '-01'\r\n            let data = { periode, indexes: [] }\r\n\r\n            this.trueLogements.forEach(elt => {\r\n                if (null != elt.indexeMois.eau || null != elt.indexeMois.energie) {\r\n                    data.indexes.push({\r\n                        idLogement: elt.idLogement,\r\n                        eau: [elt.indexeMois.eau, elt.indexePassee.eau],\r\n                        energie: [elt.indexeMois.energie, elt.indexePassee.energie]\r\n                    })\r\n                }\r\n            })\r\n\r\n            axios.post('indexes/add-multiple', data).then(response => {\r\n                App.notifySuccess(response.message)\r\n                this.showOverlay = true \r\n                this.submitted = false\r\n                this.getLogements()\r\n            }).catch(error => {\r\n                this.submitted = false\r\n                return App.alertError(error.message || 'Impossible de joindre le serveur')\r\n            })\r\n        },\r\n        \r\n        \r\n        setIndexesMois(mois, annee) {\r\n            let periodeCourante = mois + 1\r\n            if (periodeCourante < 10) {\r\n                periodeCourante = '0'+periodeCourante\r\n            }\r\n            periodeCourante = annee + '-' +  periodeCourante + '-01'\r\n\r\n            this.trueLogements = this.setIndexesPeriode(periodeCourante, this.trueLogements)\r\n            this.logements = this.setIndexesPeriode(periodeCourante, this.logements)\r\n        },\r\n        setIndexesPeriode(periode, logements) {\r\n            let periodePassee = this.$dayjs(periode).subtract(1, 'month').format('YYYY-MM')+'-01'\r\n\r\n            return logements.map(elt => {\r\n                let indexesCourants = elt.indexes.filter(e => this.$dayjs(periode).diff(e.periode, 'month') == 0),\r\n                    iEau = indexesCourants.find(e => e.typeIndexe == 'eau'),\r\n                    iEnergie = indexesCourants.find(e => e.typeIndexe == 'energie')\r\n                  \r\n                elt.indexeMois = {\r\n                    eau: php.empty(iEau) ? null : iEau.nouveau,\r\n                    energie: php.empty(iEnergie) ? null: iEnergie.nouveau\r\n                }\r\n\r\n                indexesCourants = elt.indexes.filter(e => this.$dayjs(periodePassee).diff(e.periode, 'month') == 0)\r\n                iEau = indexesCourants.find(e => e.typeIndexe == 'eau')\r\n                iEnergie = indexesCourants.find(e => e.typeIndexe == 'energie')\r\n                    \r\n                elt.indexePassee = {\r\n                    eau: php.empty(iEau) ? null : iEau.nouveau,\r\n                    energie: php.empty(iEnergie) ? null: iEnergie.nouveau\r\n                }\r\n\r\n                indexesCourants = elt.indexes.filter(e => (this.$dayjs(periodePassee).diff(e.periode, 'month') > 0 && e.nouveau > 0))\r\n                elt.iEau = indexesCourants.filter(e => e.typeIndexe == 'eau')\r\n                elt.iEnergie = indexesCourants.filter(e => e.typeIndexe == 'energie')\r\n\r\n                return elt\r\n            })\r\n        }\r\n    }\r\n\r\n};\r\n</script>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Indexes.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Indexes.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Indexes.vue?vue&type=template&id=7ff60ff7&\"\nimport script from \"./Indexes.vue?vue&type=script&lang=js&\"\nexport * from \"./Indexes.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}