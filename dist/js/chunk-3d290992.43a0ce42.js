(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3d290992"],{"01a3":function(e,t,i){"use strict";i("52e3")},"278e":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("b-overlay",{attrs:{show:e.showOverlay,rounded:"sm"}},[i("form-wizard",{attrs:{title:"",subtitle:"",nextButtonText:"suivant",backButtonText:"Précedent",finishButtonText:"Enregistrer","aria-labelledby":"demoModalLabel",shape:"circle",color:"#e74c3c"},on:{"on-complete":e.onComplete,"on-loading":e.setLoading}},[i("tab-content",{attrs:{title:"Habitation",icon:"fas fa-info-circle","before-change":e.validateFirst}},[i("b-row",{staticClass:"mb-4"},[i("b-col",[i("b-form-group",{attrs:{label:"Quel est le logement concerné par l'occupation"}},[i("div",{staticStyle:{height:"10.5em"}},[i("v-select",{attrs:{options:e.logements,reduce:function(e){return e.idLogement},label:"refLogement"},on:{input:e.setSlide_logement},model:{value:e.occupation.idLogement,callback:function(t){e.$set(e.occupation,"idLogement",t)},expression:"occupation.idLogement"}}),i("b-carousel",{ref:"logementCarousel",attrs:{interval:0,controls:""},model:{value:e.selected_index_logement,callback:function(t){e.selected_index_logement=t},expression:"selected_index_logement"}},e._l(e.logements,(function(t,a){return i("b-carousel-slide",{key:a,staticClass:"fluid w-100 responsive border-0",staticStyle:{height:"10.5em"},attrs:{"img-src":e.empty(t.photos)?"/img/bgHousing.jpg":t.photos[0].image}})})),1)],1)])],1),i("b-col",[i("b-form-group",{attrs:{label:"Qui est le résident pour lequel l'occupation est défini"}},[i("div",{staticStyle:{height:"10.5em"}},[i("v-select",{attrs:{options:e.locataires,reduce:function(e){return e.idLocataire},label:"nomLocataire",disabled:e.disabled},on:{input:e.setSlide_locataire},model:{value:e.occupation.idLocataire,callback:function(t){e.$set(e.occupation,"idLocataire",t)},expression:"occupation.idLocataire"}}),"1"==e.provenance?i("b-carousel",{ref:"locataireCarousel",attrs:{interval:0,controls:""},model:{value:e.selected_index_locataire,callback:function(t){e.selected_index_locataire=t},expression:"selected_index_locataire"}},e._l(e.locataires,(function(e,t){return i("b-carousel-slide",{key:t,staticClass:"fluid w-100 responsive border-0",staticStyle:{height:"10.5em"},attrs:{"img-src":e.avatar}})})),1):e._e(),"2"==e.provenance?i("b-carousel",{ref:"locataireCarousel",attrs:{interval:0,controls:""},model:{value:e.selected_index_locataire,callback:function(t){e.selected_index_locataire=t},expression:"selected_index_locataire"}},[i("b-carousel-slide",{staticClass:"fluid w-100 responsive border-0",staticStyle:{height:"10.5em"},attrs:{"img-src":e.locataire.avatar}})],1):e._e()],1)])],1)],1),i("b-row",{staticClass:"mt-4"},[i("b-col",[i("b-form-group",{attrs:{label:"Date de debut du bail"}},[i("date-picker",{staticClass:"w-100",attrs:{placeholder:"Selectionnez une date",format:"dddd, DD MMMM YYYY",valueType:"YYYY-MM-DD",clearable:!1},model:{value:e.occupation.debut,callback:function(t){e.$set(e.occupation,"debut",t)},expression:"occupation.debut"}})],1)],1),i("b-col",{staticClass:"mt-4"},[i("b-form-checkbox",{attrs:{switch:""},model:{value:e.occupation.endLastBail,callback:function(t){e.$set(e.occupation,"endLastBail",t)},expression:"occupation.endLastBail"}},[i("span",{staticClass:"fa-lg"},[e._v("Mettre fin au bail précédent")])])],1)],1)],1),i("tab-content",{attrs:{title:"Loyer",icon:"fas fa-balance-scale-right","before-change":e.validateAsync}},[i("b-row",[i("b-col",[i("b-form-group",{attrs:{label:"Loyer",description:"Combien devra payer le résident"}},[i("b-form-input",{class:e.requiredLoyer?"":"is-red",attrs:{type:"number",placeholder:"Ex: 45000",trim:""},model:{value:e.occupation.loyer,callback:function(t){e.$set(e.occupation,"loyer",t)},expression:"occupation.loyer"}}),e.requiredLoyer?e._e():i("span",{staticStyle:{color:"red"}},[e._v("Ce champ est obligatoire")])],1)],1),i("b-col",[i("div",{staticClass:"form-group"},[i("label",[e._v("Mode de paiement")]),i("v-select",{class:e.requiredMode?"":"is-red",attrs:{label:"text",options:e.payoptions,reduce:function(e){return e.value}},model:{value:e.occupation.mode,callback:function(t){e.$set(e.occupation,"mode",t)},expression:"occupation.mode"}}),e.requiredMode?e._e():i("span",{staticStyle:{color:"red"}},[e._v("Ce champ est obligatoire")])],1)])],1),i("b-row",[i("b-col",[i("b-form-group",{attrs:{label:"Nombre de mois d'avance",description:"Combien de mois le locataire a t-il avancé"}},[i("b-form-input",{class:e.requiredAvance?"":"is-red",attrs:{type:"number",placeholder:"Ex: 6",trim:""},model:{value:e.occupation.avance,callback:function(t){e.$set(e.occupation,"avance",t)},expression:"occupation.avance"}}),e.requiredAvance?e._e():i("span",{staticStyle:{color:"red"}},[e._v("Ce champ est obligatoire")])],1)],1),i("b-col",[i("b-form-group",{attrs:{label:"Caution",description:"somme versée faisant office de caution"}},[i("b-form-input",{class:e.requiredCaution?"":"is-red",attrs:{type:"number",placeholder:"Ex: 25000",trim:""},model:{value:e.occupation.caution,callback:function(t){e.$set(e.occupation,"caution",t)},expression:"occupation.caution"}}),e.requiredCaution?e._e():i("span",{staticStyle:{color:"red"}},[e._v("Ce champ est obligatoire")])],1)],1)],1)],1),i("tab-content",{attrs:{title:"charges",icon:"ik ik-settings","before-change":e.validateSecond}},[i("b-row",[i("b-col",[i("div",{staticClass:"form-group"},[i("label",[e._v("Facturation d'eau")]),i("v-select",{class:e.requiredEau?"":"is-red",attrs:{label:"text",options:e.eauoptions,reduce:function(e){return e.value}},model:{value:e.occupation.eau,callback:function(t){e.$set(e.occupation,"eau",t)},expression:"occupation.eau"}}),e.requiredEau?e._e():i("span",{staticStyle:{color:"red"}},[e._v("Ce champ est obligatoire")])],1)]),i("b-col",[i("b-form-group",{attrs:{label:"forfait"==e.occupation.eau?"Taux forfataire":"Prix unitaire de l'eau",description:""}},[i("b-form-input",{class:e.requiredPuEau?"":"is-red",attrs:{min:"0",type:"number",placeholder:"Ex: 1500",trim:""},model:{value:e.occupation.puEau,callback:function(t){e.$set(e.occupation,"puEau",t)},expression:"occupation.puEau"}}),e.requiredPuEau?e._e():i("span",{staticStyle:{color:"red"}},[e._v("Ce champ est obligatoire")])],1)],1),"index"==e.occupation.eau?i("b-col",[i("b-form-group",{attrs:{label:"Index initial",description:"Index du compteur d'eau à l'entrée du locataire"}},[i("b-form-input",{class:e.requiredIndex?"":"is-red",attrs:{min:"0",type:"number",placeholder:"Ex: 095",trim:""},model:{value:e.occupation.indexEau,callback:function(t){e.$set(e.occupation,"indexEau",t)},expression:"occupation.indexEau"}}),e.requiredIndex?e._e():i("span",{staticStyle:{color:"red"}},[e._v("Ce champ est obligatoire")])],1)],1):e._e()],1),i("b-row",[i("b-col",[i("div",{staticClass:"form-group"},[i("label",[e._v("Facturation d'électricité")]),i("v-select",{class:e.requiredELectricite?"":"is-red",attrs:{label:"text",options:e.eauoptions,reduce:function(e){return e.value}},model:{value:e.occupation.energie,callback:function(t){e.$set(e.occupation,"energie",t)},expression:"occupation.energie"}}),e.requiredELectricite?e._e():i("span",{staticStyle:{color:"red"}},[e._v("Ce champ est obligatoire")])],1)]),i("b-col",[i("b-form-group",{attrs:{label:"forfait"==e.occupation.energie?"Taux forfataire":"Prix unitaire de l'électricité",description:"L'exemple suggéré suppose une consommation par index"}},[i("b-form-input",{class:e.requiredPuEnergie?"":"is-red",attrs:{type:"number",min:"0",placeholder:"Ex: 150",trim:""},model:{value:e.occupation.puEnergie,callback:function(t){e.$set(e.occupation,"puEnergie",t)},expression:"occupation.puEnergie"}}),e.requiredPuEnergie?e._e():i("span",{staticStyle:{color:"red"}},[e._v("Ce champ est obligatoire")])],1)],1),"index"==e.occupation.energie?i("b-col",[i("b-form-group",{attrs:{label:"Index initial",description:"Index du compteur d'électricité à l'entrée du locataire"}},[i("b-form-input",{class:e.requiredPuEnergie?"":"is-red",attrs:{type:"number",min:"0",placeholder:"Ex: 095",trim:""},model:{value:e.occupation.indexEnergie,callback:function(t){e.$set(e.occupation,"indexEnergie",t)},expression:"occupation.indexEnergie"}}),e.requiredPuEnergie?e._e():i("span",{staticStyle:{color:"red"}},[e._v("Ce champ est obligatoire")])],1)],1):e._e()],1)],1),i("tab-content",{attrs:{title:"Contrat",icon:"fas fa-file-contract"}}),e.loadingWizard?i("div",{staticClass:"leloader"}):e._e()],1)],1)},o=[],r=i("2ee4"),n=(i("da93"),i("ec45")),c=(i("411c"),i("0edd"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("b-form-group",{attrs:{label:e.label,description:e.description}},[i("b-form-input",{attrs:{type:e.type,min:e.min,placeholder:e.placeholder,trim:""},on:{input:function(t){e.$emit("input",t)}},model:{value:e.val,callback:function(t){e.val=t},expression:"val"}})],1)}),s=[],l={name:"CustomInputGroup",props:{label:{type:String,required:!0},description:{type:String,required:!0},placeholder:{type:String},value:{type:[String,Number],required:!0},min:{type:[String,Number]},type:{type:String,default:"text"}},data:()=>({val:null}),mounted:()=>{(void 0).val=JSON.parse(JSON.stringify((void 0).value))}},u=l,d=i("2877"),p=Object(d["a"])(u,c,s,!1,null,"43d70647",null),m=p.exports,h=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("b-form-group",{attrs:{label:e.label,description:e.description}},[i("b-form-select",{attrs:{options:e.options},on:{input:function(t){e.$emit("input",t)}},model:{value:e.val,callback:function(t){e.val=t},expression:"val"}})],1)},b=[],g={name:"CustomSelectGroup",props:{label:{type:String,required:!0},description:{type:String,required:!0},placeholder:{type:String},value:{type:[String,Number],required:!0},options:{type:Array,default:[]}},data:()=>({val:null}),mounted:()=>{(void 0).val=JSON.parse(JSON.stringify((void 0).value))}},f=g,v=Object(d["a"])(f,h,b,!1,null,"9982fb74",null),x=v.exports,y=i("2c43");const E=i("5a6f");var _={name:"occupation-form",components:{DatePicker:n["default"],CustomInputGroup:m,CustomSelectGroup:x,FormWizard:r["FormWizard"],TabContent:r["TabContent"]},props:{locataire:{type:Object},provenance:{type:Number,required:!0,default:"1"},action:{type:String,required:!0,default:"add"}},data:()=>({duree:[null,null],selected_index_logement:-1,selected_index_locataire:-1,selected_value:"",occupation:{loyer:"",mode:"",energie:"index",eau:"index",puEnergie:"",puEau:"",idLogement:"",idLocataire:"",debut:"",indexEnergie:0,indexEau:0,endLastBail:!1,avance:1,caution:1},showOverlay:!1,sendForm:!1,logements:[],locataires:[],loadingWizard:!1,check0:!1,check:!0,check2:!0,requiredLoyer:!0,requiredAvance:!0,requiredCaution:!0,requiredLoyer:!0,requiredMode:!0,requiredLogement:!0,requiredLocataire:!0,requiredELectricite:!0,requiredEau:!0,requiredPuEau:!0,requiredPuEnergie:!0,requiredIndex:!0,disabled:!1,stateLocataire:null,payoptions:[{text:"Prépayé",value:"prepayer"},{text:"Postpayé",value:"postpayer"}],eauoptions:[{value:"index",text:"Index"},{value:"forfait",text:"Forfait"}]}),watch:{selected_index_logement(e){const t=this.logements[e];this.occupation.idLogement=t.idLogement,this.indexEnergie=t.lastIndexEnergie?t.lastIndexEnergie.nouveau:0,this.indexEau=t.lastIndexEau?t.lastIndexEau.nouveau:0},selected_index_locataire(e){this.occupation.idLocataire=this.locataires[e].idLocataire},loyer(e){this.occupation.loyer=e}},computed:{logementSelected(){return this.logements.find(e=>e.idLogement==this.occupation.idLogement)},loyer:{get(){const e=this.logementSelected;return e?(e.prixMin+e.prixMax)/2:0},set(e){this.occupation.loyer=e}},indexEnergie:{get(){const e=this.logementSelected;return e&&e.lastIndexEnergie?e.lastIndexEnergie.nouveau:0},set(e){this.occupation.indexEnergie=e}},indexEau:{get(){const e=this.logementSelected;return e&&e.lastIndexEau?e.lastIndexEau.nouveau:0},set(e){this.occupation.indexEau=e}}},methods:{createLogement(){this.$emit("createLogementSecond")},createLocataire(){this.$emit("createLocataire")},empty(e){return E.empty(e)},setSlide_logement(e){for(let t=0;t<this.logements.length;t++){const i=this.logements[t];if(i.idLogement==e){this.$refs.logementCarousel.setSlide(t),this.indexEnergie=i.lastIndexEnergie?i.lastIndexEnergie.nouveau:0,this.indexEau=i.lastIndexEau?i.lastIndexEau.nouveau:0;break}}},setSlide_locataire(e){for(let t=0;t<this.locataires.length;t++)if(this.locataires[t].idLocataire==e){this.$refs.locataireCarousel.setSlide(t);break}},resetModal(){this.occupation={loyer:"",mode:"",energie:"index",eau:"index",puEnergie:"",puEau:"",idLogement:"",debut:"",indexEnergie:0,indexEau:0,endLastBail:!1},2!=this.provenance&&(this.occupation.idLocataire="",this.occupation.idLogement="")},setLoading:function(e){this.loadingWizard=e},validateFirst:function(){return new Promise((e,t)=>{this.occupation.idLogement&&this.occupation.idLocataire?this.check0=!0:(this.occupation.idLogement?this.requiredLogement=!0:this.requiredLogement=!1,this.occupation.idLocataire?this.requiredLocataire=!0:this.requiredLocataire=!1,this.check0=!1),setTimeout(()=>{e(this.check0)},1e3)})},validateAsync:function(){return new Promise((e,t)=>{this.occupation.loyer&&this.occupation.avance&&this.occupation.mode&&this.occupation.caution?(this.check=!0,this.alreadyset=!0):(this.occupation.loyer?this.requiredLoyer=!0:this.requiredLoyer=!1,this.occupation.avance?this.requiredAvance=!0:this.requiredAvance=!1,this.occupation.mode?this.requiredMode=!0:this.requiredMode=!1,this.occupation.caution?this.requireCaution=!0:this.requireCaution=!1,this.check=!1),setTimeout(()=>{e(this.check)},1e3)})},validateSecond:function(){return new Promise((e,t)=>{setTimeout(()=>{e(this.check2)},1e3)})},onComplete(){console.log(this.occupation),"add"==this.action&&(this.showOverlay=!0,axios.post("occupations",this.occupation).then(e=>(this.$emit("occupationAdded"),this.resetModal(),console.log(e),this.showOverlay=!1,App.notifySuccess(e.message))).catch(e=>(this.showOverlay=!1,App.alertError(e.message))))},async getInitialiseData(){try{if(this.logements=await axios.get("logements").then(e=>e.result||[]),this.logements[0]){const e=this.logements[0];this.occupation.idLogement=e.idLogement,e.lastIndexEnergie&&(this.indexEnergie=e.lastIndexEnergie.nouveau),e.lastIndexEau&&(this.indexEau=e.lastIndexEau.nouveau),this.loyer=(e.prixMin+e.prixMax)/2}}catch(e){y["a"].error(e.message)}if(2!=this.provenance)try{this.locataires=await axios.get("locataires").then(e=>e.result||[]),this.locataires[0]&&(this.occupation.idLocataire=this.locataires[0].idLocataire)}catch(e){y["a"].error(e.message)}}},async mounted(){await this.getInitialiseData(),null!=this.locataire&&(this.provenance=2,this.disabled=!0,this.stateLocataire=this.locataire,this.occupation.idLocataire=this.locataire.idLocataire)}},L=_,S=(i("01a3"),Object(d["a"])(L,a,o,!1,null,"4b89e204",null));t["a"]=S.exports},"52e3":function(e,t,i){},fb87:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"search-sm d-inline-block float-md-left mr-1 mb-1 align-top"},[i("form",{attrs:{action:"",onSubmit:"return false"}},[i("b-form-input",{staticStyle:{height:"40px",width:"350px","border-radius":"5px"},attrs:{type:"text",placeholder:e.placeholder},on:{input:function(t){e.$emit("input",t)}},model:{value:e.val,callback:function(t){e.val=t},expression:"val"}}),e._m(0)],1)])},o=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("button",{staticClass:"btn btn-icon",staticStyle:{height:"40px",width:"50px"},attrs:{type:"submit"}},[i("i",{staticClass:"ik ik-search"})])}],r={name:"SearchForm",props:{placeholder:{type:String,default:"Rechercher..."},value:{default:null}},data:()=>({val:null}),mounted:()=>{console.log("ldldldld:  this.value"),console.log(JSON.parse(JSON.stringify((void 0).value)))}},n=r,c=i("2877"),s=Object(c["a"])(n,a,o,!1,null,"394c7419",null);t["a"]=s.exports}}]);
//# sourceMappingURL=chunk-3d290992.43a0ce42.js.map