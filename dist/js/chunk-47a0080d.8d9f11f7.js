(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-47a0080d"],{"0882":function(t,e,i){"use strict";i("d0e0")},"1fbf":function(t,e,i){},"7ade":function(t,e,i){t.exports=i.p+"img/contratDebail.9eed3615.jpg"},b15e:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"container-fluid"},[i("page-description",{attrs:{title:"Modèle de contrats",description:"Gestion de  vos modèles contrat de baux ",icon:"file-signature",path:["Configuration et aide ","Mes Modèles de Contrats"]}}),i("div",{staticClass:"row"},[i("div",{staticClass:"col-md-12"},[i("div",{staticClass:"mb-2 clearfix"},[i("div",{staticClass:"collapse d-md-block display-options",attrs:{id:"displayOptions"}},[i("div",{staticClass:"d-block d-md-inline-block"},[i("div",{staticClass:"search-sm d-inline-block float-md-left mr-1 mb-1 align-top"},[i("form",{attrs:{action:"",onSubmit:"return false"}},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.search,expression:"search"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Recherche..."},domProps:{value:t.search},on:{input:function(e){e.target.composing||(t.search=e.target.value)}}}),t._m(0)])])]),i("div",{staticClass:"float-md-right"},[i("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-contrat-form",modifiers:{"modal-contrat-form":!0}}],attrs:{variant:"danger"},on:{click:function(e){return e.preventDefault(),t.callContratForm.apply(null,arguments)}}},[i("i",{staticClass:"fa fa-plus-circle"}),t._v(" Ajouter un modèle de contrat ")])],1)])]),i("div",{staticClass:"separator mb-20"}),i("b-overlay",{attrs:{show:t.showOverlay,rounded:"sm"}},[t.contrats.length?i("b-row",{staticClass:"layout-wrap"},t._l(t.items,(function(e,s){return i("b-col",{key:e.idContrat||s,staticClass:"animated flipInX mb-4",attrs:{xl:"3",lg:"4",cols:"12",sm:"6"}},[i("contrat",{attrs:{contrat:e},on:{makeUpdate:t.updateArticle,showDetails:t.showDetails}})],1)})),1):i("b-alert",{staticClass:"text-center",attrs:{variant:"info",show:""}},[i("i",{staticClass:"fa fa-exclamation-triangle fa-3x"}),t._v(" "),i("br"),i("span",{staticClass:"h4 d-inline-flex ml-2"},[t._v("Aucun modèle de contrat défini pour le moment")]),i("p",[t._v("Le contrat est définit usuellement comme un accord entre deux ou plusieurs volontés en vue de faire naître des effets de droit")])]),i("paginator",{attrs:{hr:"top",offset:t.offset,total:t.contrats.length,limit:t.perPage,page:t.currentPage},on:{pageChanged:function(e){t.currentPage=e},limitChanged:function(e){t.perPage=e}}})],1)],1)]),i("b-modal",{ref:"contrat-modal",attrs:{id:"modal-contrat-form",size:"xl","header-bg-variant":t.headerBgVariant,"header-text-variant":t.headerTextVariant,title:"Ajouter un Modèle de contrat","ok-title":"Fermer","ok-only":"","ok-variant":"secondary","no-close-on-backdrop":"","hide-header-close":""}},[i("div",[i("contrat-form",{on:{newModeleContratAdded:t.addedContrat}})],1)])],1)},a=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("button",{staticClass:"btn btn-icon",attrs:{type:"submit"}},[i("i",{staticClass:"ik ik-search"})])}],l=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:" list-item list-item-grid"},[i("div",{staticClass:"owl-container"},[i("div",{staticClass:"owl-carousel basic"},[i("div",{staticClass:"card flex-row",staticStyle:{display:"flex !important"}},[t._m(0),i("div",{staticClass:"w-50"},[i("div",{staticClass:"card-body"},[i("h6",{staticClass:"mb-0 card-title font-weight-bold titre"},[t._v(t._s(t.contrat.libelleModele))]),i("a",{staticClass:"mb-4 card-subtitle sous-titre",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.showDetails.apply(null,arguments)}}},[t._v("Contrat de bail")]),i("div",{staticClass:"list-actions my-1"},[i("a",{attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.showDetails.apply(null,arguments)}}},[i("i",{staticClass:"ik ik-eye"})]),i("a",{attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.showDetails.apply(null,arguments)}}},[i("i",{staticClass:"fas fa-link"})]),i("a",{attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.$emit("makeUpdate",t.article)}}},[i("i",{staticClass:"ik ik-edit-2"})]),i("a",{staticClass:"list-delete",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.remove.apply(null,arguments)}}},[i("i",{staticClass:"ik ik-trash-2"})])]),i("footer",[i("p",{staticClass:"text-muted text-small mb-0 font-weight-light"},[t._v("Crée le: "+t._s(t.contrat.createdAt.split("").slice(0,10).join("")))])])])])])])])])},o=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"w-50 position-relative p-0"},[s("img",{staticClass:"card-img-left d-block w-100",attrs:{src:i("7ade"),alt:"Card image cap"}}),s("span",{staticClass:"badge badge-pill badge-primary position-absolute badge-top-left"},[t._v("New")])])}],r={props:{contrat:{type:Object,required:!0},isSub:{type:Boolean,default:!1}},computed:{dateCreation(){const t=this.$date(this.contrat.createdAt);return`Créée le ${t.format("dddd, DD MMMM YYYY")} à ${t.format("HH:mm")}`},isNew(){return dayjs().diff(this.contrat.createdAt,"hour")<=1}},methods:{showDetails(){if(this.isSub)return!1;this.$emit("showDetails",this.contrat),console.log(this.contrat)},remove(){App.confirm(`Voullez vous vraiment supprimer le modèle " <b>${this.contrat.libelleModele}</b> " ?`,{confirm:()=>{axios.delete("articles/"+this.contrat.idModele).then(t=>t.success?(this.$emit("deleted",this.contrat.idModele),App.notifySuccess(t.message)):App.notifyError(t.message))}})}}},n=r,c=(i("0882"),i("2877")),d=Object(c["a"])(n,l,o,!1,null,null,null),u=d.exports,m=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("b-overlay",{attrs:{show:t.showOverlay,rounded:"sm"}},[i("form-wizard",{attrs:{title:"",subtitle:"",nextButtonText:"suivant",backButtonText:"Précedent",finishButtonText:"Enregistrer","aria-labelledby":"demoModalLabel",shape:"circle",color:"#e74c3c"},on:{"on-complete":t.onComplete,"on-loading":t.setLoading}},[i("tab-content",{attrs:{title:"Details du Contrat",icon:"fas fa-info-circle","before-change":t.validateAsync}},[i("b-row",[i("div",{staticClass:"col-sm-6"},[i("div",{staticClass:"input-group input-group-success"},[i("span",{staticClass:"input-group-prepend"},[i("label",{staticClass:"input-group-text"},[i("i",{staticClass:"ik ik-shield"})])]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.modelContrat.libele,expression:"modelContrat.libele"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Libelle du contrat"},domProps:{value:t.modelContrat.libele},on:{input:function(e){e.target.composing||t.$set(t.modelContrat,"libele",e.target.value)}}}),t.requiredModelContrat?t._e():i("span",{staticStyle:{color:"red"}},[t._v("Le libellé est obligatoire")])])]),i("div",{staticClass:"col-sm-6"},[i("div",{staticClass:"input-group input-group-warning"},[i("span",{staticClass:"input-group-prepend"},[i("label",{staticClass:"input-group-text"},[i("i",{staticClass:"ik ik-file"})])]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.modelContrat.title,expression:"modelContrat.title"}],staticClass:"form-control",attrs:{type:"text",placeholder:"titre du contrat"},domProps:{value:t.modelContrat.title},on:{input:function(e){e.target.composing||t.$set(t.modelContrat,"title",e.target.value)}}})])])]),i("b-row",[i("b-col",[i("b-row",[i("b-col",[i("div",{staticClass:"mt-4"},[i("span",{staticClass:"fa-lg"},[t._v("Spécifier un batiment ?")]),i("b-form-checkbox",{attrs:{switch:""},model:{value:t.showSelectBatiment,callback:function(e){t.showSelectBatiment=e},expression:"showSelectBatiment"}})],1)]),i("b-col",[i("transition",{attrs:{"enter-active-class":"animated zoomIn"}},[t.showSelectBatiment?i("div",{staticClass:"form-group mt-2"},[i("label",[t._v("Batiment associé")]),i("v-select",{attrs:{label:"nomBatiment",options:t.batiments},model:{value:t.batiment,callback:function(e){t.batiment=e},expression:"batiment"}})],1):t._e()])],1)],1)],1),i("b-col",[i("b-row",[i("b-col",[i("div",{staticClass:"mt-4"},[i("span",{staticClass:"fa-lg"},[t._v("Spécifier un logement ?")]),i("b-form-checkbox",{attrs:{switch:""},model:{value:t.showSelectLogement,callback:function(e){t.showSelectLogement=e},expression:"showSelectLogement"}})],1)]),i("b-col",[i("transition",{attrs:{"enter-active-class":"animated zoomIn"}},[t.showSelectLogement?i("div",{staticClass:"form-group mt-2"},[i("label",[t._v("logement concerné")]),i("v-select",{attrs:{label:"refLogement",options:t.logements},model:{value:t.logement,callback:function(e){t.logement=e},expression:"logement"}})],1):t._e()])],1)],1)],1)],1)],1),i("tab-content",{attrs:{title:"Choisir les rubriques",icon:"fas fa-file-contract","before-change":t.validateSecond}},[i("div",{staticClass:"accordion",attrs:{role:"tablist"}},t._l(t.articles,(function(e){return i("b-card",{key:e.idArticle,staticClass:"mb-1",attrs:{"no-body":""}},[i("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[i("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle.accordion-1",modifiers:{"accordion-1":!0}}],attrs:{block:"",variant:"info"}},[t._v(t._s(e.titreArticle))])],1),i("b-collapse",{attrs:{id:"accordion-1",visible:"",accordion:"my-accordion",role:"tabpanel"}},[i("b-card-body",[i("b-card-text",[i("div",{staticClass:"row layout-wrap",attrs:{id:"layout-wrap"}},t._l(e.rubriques,(function(e){return i("div",{key:e.idRubrique,staticClass:"col-12 list-item"},[i("div",{staticClass:"card d-flex flex-row mb-3"},[i("div",{staticClass:"d-flex flex-grow-1 min-width-zero card-content"},[i("div",{staticClass:"card-body align-self-center d-flex flex-column flex-md-row justify-content-between min-width-zero align-items-md-center"},[i("a",{staticClass:"list-item-heading mb-1 truncate w-180 w-xs-100",attrs:{href:"#editLayoutItem","data-toggle":"modal","data-target":"#editLayoutItem"}},[t._v(" "+t._s(e.descRubrique)+" ")]),i("div",{staticClass:"w-15 w-xs-100"},[1==e.value?i("span",{staticClass:"badge badge-pill badge-secondary"},[t._v("On Hold")]):t._e()])]),i("div",{staticClass:"list-actions"},[1==e.value?i("a",{attrs:{href:"layout-edit-item.html"}},[i("i",{staticClass:"ik ik-edit-2"})]):t._e()]),i("div",{staticClass:"custom-control custom-checkbox pl-1 align-self-center"},[i("label",{staticClass:"custom-control custom-checkbox mb-0"},[i("input",{staticClass:"custom-control-input",attrs:{type:"checkbox"},on:{change:function(i){return t.Rubrique(e)}}}),i("span",{staticClass:"custom-control-label"})])])])])])})),0)])],1)],1)],1)})),1)]),i("tab-content",{attrs:{title:"Last step",icon:"fa fa-list-alt"}},[i("div",{staticClass:"card"},[i("div",{staticClass:"card-header text-center"},[i("h3",[t._v("Pré-visualisation des données entrées :")])]),i("div",{staticClass:"card-body"},[i("div",{staticClass:"row invoice-info"},[i("div",{staticClass:"col-sm-12 invoice-col"},[i("strong",[t._v("Titre :")]),i("span",[t._v(t._s(t.modelContrat.title))])]),i("div",{staticClass:"col-sm-12 invoice-col"},[i("strong",[t._v("Libellé :")]),i("span",[t._v(t._s(t.modelContrat.libele)+" ")])]),i("div",{staticClass:"col-sm-12 invoice-col"},[i("h3",[t._v("Rubriques :")]),i("br")])]),i("div",{staticClass:"row"},t._l(t.selectArcticle,(function(e,s){return i("div",{key:e.title,staticClass:"col-12"},[i("h5",[t._v(" "+t._s(t.romanize(s+1))+". "+t._s(e.title)+" ")]),i("div",{staticClass:"px-2"},t._l(e.rubriques,(function(e,a){return i("p",{key:e.idRubrique},[t._v(" "+t._s(s+1)+"."+t._s(a+1)+". "+t._s(e.descRubrique)+" ")])})),0)])})),0)])])]),t.loadingWizard?i("div",{staticClass:"leloader"}):t._e()],1)],1)},h=[],b=i("2c43");const p=i("5a6f");var f={name:"contratForm",components:{},computed:{},data:()=>({loadingWizard:!1,showOverlay:!0,action:"add",modelContrat:{title:"",libele:"",rubriques:[]},articles:[],selectArcticle:[],logements:[],batiments:[],showSelectBatiment:!1,showSelectLogement:!1,batiment:null,logement:null,requiredModelContrat:!0,check:!0,check2:!0,requiredRubriques:!0}),watch:{},beforeMount(){},async mounted(){await this.getArticles(),this.batiments=storage.get("batiments"),this.logements=storage.get("logements")},methods:{validateAsync:function(){return new Promise((t,e)=>{this.modelContrat.libele?(this.check=!0,this.requiredModelContrat=!0):(this.check=!1,this.requiredModelContrat=!1),setTimeout(()=>{t(this.check)},1e3)})},validateSecond:function(){return new Promise((t,e)=>{setTimeout(()=>{t(this.check)},1e3)})},async getArticles(){console.log("entrée recuperation de la liste des articles");try{this.articles=await axios.get("articles").then(t=>t.result)}catch(t){console.log(t)}this.showOverlay=!1},resetModal(){this.modelContrat={title:"",libele:"",rubriques:null},this.logement=null,this.batiment=null,setTimeout(()=>{this.$emit("closeContratModal")},500)},getContrats(){axios.get("modeles-contrats").then(t=>t.result||[]).then(t=>{this.contrats=this.trueContrats=t,this.showOverlay=!1})},onComplete(){this.showOverlay=!0;let t={libelle:this.modelContrat.libele,titre:this.modelContrat.title,rubriques:[],idBatiment:"",idLogement:""};this.selectArcticle.forEach(e=>{t.rubriques=p.array_merge(t.rubriques,e.rubriques.map(t=>t.idRubrique))}),null!=this.batiment&&(t.idBatiment=this.batiment.idBatiment),null!=this.logement&&(t.idLogement=this.logement.idLogement),axios.post("modeles-contrats",t).then(t=>(this.resetModal(),this.showOverlay=!1,this.$emit("newModeleContratAdded"),App.notifySuccess(t.message))).catch(t=>{this.showOverlay=!1,b["a"].error(t.message)})},Rubrique(t){console.log(t);let e=this.articles.filter(e=>e.idArticle===t.idArticle)[0];this.articleIsSelected(e.idArticle)?this.selectArcticle=this.selectArcticle.map(i=>(i.idArticle==e.idArticle&&i.rubriques.push(t),i)):this.selectArcticle.push({idArticle:e.idArticle,title:e.titreArticle,rubriques:[t]}),console.log(this.selectArcticle)},articleIsSelected(t){return this.selectArcticle.filter(e=>e.idArticle==t).length>0},showDetails(t){this.contrat=t,setTimeout(()=>{$("#editLayoutItem").modal("show"),$("#editLayoutItem").on("hide.bs.modal",t=>{this.contrat=null}),$("#editLayoutItem").on("hidden.bs.modal",t=>{this.contrat=null})},100)},setLoading:function(t){this.loadingWizard=t},setItems(t){this.ListItem=document.querySelectorAll(".items"),console.log(this.ListItem);for(let e=0;e<this.ListItem.length;e++)this.ListItem[e].classList.remove("active");this.ListItem[t].classList.add("active")},defaultBtnActive(){const t=document.querySelector("#default-btn");t.click()},updateArticle(t){this.modal={action:"edit",titreArticle:t.titreArticle,numArticle:t.numArticle,idCite:t.idArticle},this.$bvModal.show("modal-cite")},romanize(t){if(!+t)return!1;var e=String(+t).split(""),i=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],s="",a=3;while(a--)s=(i[+e.pop()+10*a]||"")+s;return Array(+e.join("")+1).join("M")+s}}},C=f,g=(i("b2b2"),Object(c["a"])(C,m,h,!1,null,"21e3a419",null)),v=g.exports;const w=i("5a6f");var y={name:"Contrats",components:{Contrat:u,ContratForm:v},computed:{items(){return w.array_slice(this.contrats,this.offset,this.perPage)},offset(){return this.currentPage*this.perPage-this.perPage}},data:()=>({contrats:[],trueContrats:[],articles:[],selectArcticle:[],showOverlay:!0,contrat:null,currentPage:1,itemTextShow:"",text:"lqdmfdqf",headerBgVariant:"dark",headerTextVariant:"light",ListItem:[],perPage:10,search:null,modal:{action:"",nom:"",ref:"",idCite:""}}),watch:{search(t){w.empty(t)?this.contrats=this.trueContrats:this.contrats=this.trueContrats.filter(e=>e.nomCite.toLowerCase().includes(t.toLowerCase()))}},async beforeMount(){await this.getContrats(),await this.getData()},mounted(){},methods:{addedContrat(){this.getContrats(),this.$bvModal.hide("modal-contrat-form")},async getData(){let t=[],e=[];try{t=await axios.get("batiments").then(t=>t.result),storage.set("batiments",t)}catch(i){console.log(i)}try{e=await axios.get("logements").then(t=>t.result),storage.set("logements",e)}catch(i){console.log(i)}},callContratForm(){this.commandeContrat=!0},onCloseSet(){this.commandeContrat=!1},async getContrats(){try{this.contrats=await axios.get("modeles-contrats").then(t=>t.result)}catch(t){console.log(t)}this.showOverlay=!1},onComplete(){let t={libelle:this.modelContrat.libele,titre:this.modelContrat.title,rubriques:[]};this.selectArcticle.forEach(e=>{t.rubriques=w.array_merge(t.rubriques,e.rubriques.map(t=>t.idRubrique))}),console.log(t),axios.post("modeles-contrats",t).then(t=>{t.success&&this.getContrats()}).catch(t=>{console.log(t.response)})},Rubrique(t){console.log(t);let e=this.articles.filter(e=>e.idArticle===t.idArticle)[0];this.articleIsSelected(e.idArticle)?this.selectArcticle=this.selectArcticle.map(i=>(i.idArticle==e.idArticle&&i.rubriques.push(t),i)):this.selectArcticle.push({idArticle:e.idArticle,title:e.titreArticle,rubriques:[t]}),console.log(this.selectArcticle)},articleIsSelected(t){return this.selectArcticle.filter(e=>e.idArticle==t).length>0},showDetails(t){this.contrat=t,setTimeout(()=>{$("#editLayoutItem").modal("show"),$("#editLayoutItem").on("hide.bs.modal",t=>{this.contrat=null}),$("#editLayoutItem").on("hidden.bs.modal",t=>{this.contrat=null})},100)},setItems(t){this.ListItem=document.querySelectorAll(".items"),console.log(this.ListItem);for(let e=0;e<this.ListItem.length;e++)this.ListItem[e].classList.remove("active");this.ListItem[t].classList.add("active")},defaultBtnActive(){const t=document.querySelector("#default-btn");t.click()},updateArticle(t){this.modal={action:"edit",titreArticle:t.titreArticle,numArticle:t.numArticle,idCite:t.idArticle},this.$bvModal.show("modal-cite")},romanize(t){if(!+t)return!1;var e=String(+t).split(""),i=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],s="",a=3;while(a--)s=(i[+e.pop()+10*a]||"")+s;return Array(+e.join("")+1).join("M")+s}}},A=y,x=(i("da3b"),Object(c["a"])(A,s,a,!1,null,null,null));e["default"]=x.exports},b2b2:function(t,e,i){"use strict";i("1fbf")},cd0f:function(t,e,i){},d0e0:function(t,e,i){},da3b:function(t,e,i){"use strict";i("cd0f")}}]);
//# sourceMappingURL=chunk-47a0080d.8d9f11f7.js.map