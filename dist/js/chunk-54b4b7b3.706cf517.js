(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-54b4b7b3"],{"0e80":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container-fluid"},[a("page-description",{attrs:{title:"Occupations",description:"Gestion de vos occupations",icon:"fas fa-users",path:["Gestion Immobilière","Mes Occupations"]}}),a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12"},[a("div",{staticClass:"mb-2 clearfix"},[a("div",{staticClass:"collapse d-md-block display-options",attrs:{id:"displayOptions"}},[a("div",{staticClass:"d-block d-md-inline-block"},[a("div",{staticClass:"search-sm d-inline-block float-md-left mr-1 mb-1 align-top"},[a("form",{attrs:{action:"",onSubmit:"return false"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.search,expression:"search"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Recherche..."},domProps:{value:t.search},on:{input:function(e){e.target.composing||(t.search=e.target.value)}}}),t._m(0)])])]),a("div",{staticClass:"float-md-right"},[a("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-lg",modifiers:{"modal-lg":!0}}],attrs:{variant:"danger"},on:{click:function(e){return e.preventDefault(),t.addOccupation.apply(null,arguments)}}},[a("i",{staticClass:"fa fa-plus-circle"}),t._v(" Définir une occupation")])],1)])]),a("div",{staticClass:"separator mb-20"}),a("b-overlay",{attrs:{show:t.showOverlay,rounded:"sm"}},[t.occupations.length?a("b-row",{staticClass:"layout-wrap"},[a("div",{staticClass:"card-body"},[a("div",{staticClass:"table-responsive"},[a("table",{staticClass:"table table-hover table-bordered table-striped",attrs:{id:"sampleTable"}},[a("thead",[a("tr",[a("th",[t._v("id")]),a("th",[t._v("Avatar")]),a("th",[t._v("Nom")]),a("th",[t._v("E-Mail")]),a("th",[t._v("N° Téléphone")]),a("th",[t._v("Proféssion")]),a("th",[t._v("Actions")])])]),a("tbody",t._l(t.occupations,(function(e){return a("tr",{key:e.idOccupation},[a("td",[t._v(t._s(t.locataire.idLocataire))]),a("td",[a("img",{staticClass:"rounded-circle",attrs:{src:"/img/profile-picture.jpg",alt:"avatar",width:"30"}})]),a("td",[t._v(t._s(t.locataire.nomLocataire))]),a("td",[t._v(t._s(t.locataire.email))]),a("td",[t._v(t._s(t.locataire.tel))]),a("td",[t._v(t._s(t.locataire.profession))]),a("td",[a("a",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.top",value:"Modifier",expression:"'Modifier'",modifiers:{top:!0}}],attrs:{href:"#!"}},[a("i",{staticClass:"ik ik-edit f-16 mr-15 text-green"})]),a("a",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.top",value:"Supprimer",expression:"'Supprimer'",modifiers:{top:!0}}],attrs:{href:"#!"}},[a("i",{staticClass:"ik ik-trash-2 f-16 mr-15 text-red"})]),a("a",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.top",value:"Détails",expression:"'Détails'",modifiers:{top:!0}}],attrs:{href:"#!"},on:{click:function(e){return e.preventDefault(),t.showDetails.apply(null,arguments)}}},[a("i",{staticClass:"ik ik-eye f-16 text-blue"})])])])})),0)])])])]):a("b-alert",{staticClass:"text-center",attrs:{variant:"info",show:""}},[a("i",{staticClass:"fa fa-exclamation-triangle fa-3x"}),t._v(" "),a("br"),a("span",{staticClass:"h4 d-inline-flex ml-2"},[t._v("Vous n'avez défini aucune occupation pour le moment")])]),a("paginator",{attrs:{hr:"top",offset:t.offset,total:t.occupations.length,limit:t.perPage,page:t.currentPage},on:{pageChanged:function(e){t.currentPage=e},limitChanged:function(e){t.perPage=e}}})],1)],1)]),t.occupation?a("div",{staticClass:"modal fade edit-layout-modal",attrs:{id:"editLayoutItem",tabindex:"-1",role:"dialog","aria-labelledby":"editLayoutItemLabel","aria-hidden":"true"}},[a("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title",attrs:{id:"editLayoutItemLabel"}},[t._v("Détails de "),a("b",[t._v(t._s(t.habitant.titre))]),t._v(" "),a("b",[t._v(t._s(t.habitant.nomLocataire))])]),t._m(1)]),a("div",{staticClass:"modal-body pt-2"})])])]):t._e(),t.commandeOccupation?a("occupation-form",{attrs:{action:"add"},on:{occupationAdded:t.addedOccupation}}):t._e()],1)},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("button",{staticClass:"btn btn-icon",attrs:{type:"submit"}},[a("i",{staticClass:"ik ik-search"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])}],s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("b-modal",{ref:"occupation-modal",attrs:{id:"modal-lg",size:"lg","ok-only":"","ok-title":"Valider",title:"add"==t.action?"Affecter une occupation":"Edition"},on:{hidden:t.resetModal,ok:t.submitModal}},[a("b-overlay",{attrs:{show:t.showOverlay,rounded:"sm"}},[a("b-row",[a("b-col",[a("b-form-group",{attrs:{label:"Loyer",description:"Combien devra payer le résident"}},[a("b-form-input",{attrs:{placeholder:"Ex: 45000",trim:""},model:{value:t.loyer,callback:function(e){t.loyer=e},expression:"loyer"}})],1)],1),a("b-col",[a("b-form-group",{attrs:{label:"Mode de paiement",description:"Le résident devra t-il payer son loyer courant avant ou après l'avoir consommé"}},[a("b-form-radio-group",{attrs:{id:"radio-slots",options:t.options,name:"radio-options-slots"},model:{value:t.occupation.mode,callback:function(e){t.$set(t.occupation,"mode",e)},expression:"occupation.mode"}})],1)],1)],1),a("b-row",[a("b-col",[a("b-form-group",{attrs:{label:"Comment s'effectuera la facturation en eau de ce résident"}},[a("b-form-select",{staticClass:"mb-1",attrs:{options:t.optionscharges},model:{value:t.occupation.eau,callback:function(e){t.$set(t.occupation,"eau",e)},expression:"occupation.eau"}})],1)],1),a("b-col",[a("b-form-group",{attrs:{label:"Comment s'effectuera la facturation en électricité de ce résident"}},[a("b-form-select",{staticClass:"mb-1",attrs:{options:t.optionscharges},model:{value:t.occupation.energie,callback:function(e){t.$set(t.occupation,"energie",e)},expression:"occupation.energie"}})],1)],1)],1),a("b-row",[a("b-col",[a("b-form-group",{attrs:{label:"Prix unitaire de l'energie",description:"L'exemple suggéré suppose une consommation par forfait"}},[a("b-form-input",{attrs:{placeholder:"Ex: 2500",trim:""},model:{value:t.occupation.puEnergie,callback:function(e){t.$set(t.occupation,"puEnergie",e)},expression:"occupation.puEnergie"}})],1)],1),a("b-col",[a("b-form-group",{attrs:{label:"Prix unitaire de l'eau",description:"l'exemple suggéré suppose une facturation par index du compteur"}},[a("b-form-input",{attrs:{placeholder:"Ex: 150",trim:""},model:{value:t.occupation.puEau,callback:function(e){t.$set(t.occupation,"puEau",e)},expression:"occupation.puEau"}})],1)],1)],1),a("b-row",[a("b-col",{attrs:{cols:"5"}},[a("b-form-group",{attrs:{label:"Quel est le logement concerné par l'occupation"}},[a("div",{staticStyle:{height:"10.5em"}},[a("b-form-select",{staticClass:"mb-1",attrs:{options:t.logements,"value-field":"idLogement","text-field":"refLogement","disabled-field":"notEnabled"},on:{input:t.setSlide_logement},model:{value:t.occupation.idLogement,callback:function(e){t.$set(t.occupation,"idLogement",e)},expression:"occupation.idLogement"}}),a("b-carousel",{ref:"logementCarousel",attrs:{interval:0,controls:""},model:{value:t.selected_index_logement,callback:function(e){t.selected_index_logement=e},expression:"selected_index_logement"}},t._l(t.logements,(function(e,o){return a("b-carousel-slide",{key:o,staticClass:"fluid w-100 responsive border-0",staticStyle:{height:"10.5em"},attrs:{"img-src":t.empty(e.photos)?"/img/bgHousing.jpg":e.photos[0].image}})})),1)],1)])],1),a("b-col",{attrs:{cols:"7"}},[a("b-form-group",{attrs:{label:"Qui est le résident pour lequel l'occupation est défini"}},[a("div",{staticStyle:{height:"10.5em"}},[a("b-form-select",{staticClass:"mb-1",attrs:{options:t.locataires,"value-field":"idLocataire","text-field":"nomLocataire","disabled-field":"notEnabled"},on:{input:t.setSlide_locataire},model:{value:t.occupation.idLocataire,callback:function(e){t.$set(t.occupation,"idLocataire",e)},expression:"occupation.idLocataire"}}),a("b-carousel",{ref:"locataireCarousel",attrs:{interval:0,controls:""},model:{value:t.selected_index_locataire,callback:function(e){t.selected_index_locataire=e},expression:"selected_index_locataire"}},t._l(t.locataires,(function(t,e){return a("b-carousel-slide",{key:e,staticClass:"fluid w-100 responsive border-0",staticStyle:{height:"10.5em"},attrs:{"img-src":t.avatar}})})),1)],1)])],1)],1)],1)],1)},n=[],r=a("2c43");const c=a("5a6f");var l={name:"occupation-form",data:()=>({duree:[null,null],selected_index_logement:-1,selected_index_locataire:-1,selected_value:"",options:[{text:"Prépayé",value:"prepayer"},{text:"Postpayé",value:"postpayer"}],optionscharges:[{value:"index",text:"Index"},{value:"forfait",text:"Forfait"}],occupation:{loyer:"",mode:"",energie:"",eau:"",puEnergie:"",puEau:"",idLogement:"",debut:""},showOverlay:!1,sendForm:!1,logements:[],locataires:[]}),watch:{selected_index_logement(t){this.occupation.idLogement=this.logements[t].idLogement},selected_index_locataire(t){this.occupation.idLocataire=this.locataires[t].idLocataire}},computed:{loyer:{get(){const t=this.logements.filter(t=>t.idLogement==this.occupation.idLogement)[0];return t?(t.prixMin+t.prixMax)/2:0},set(t){this.occupation.loyer=t}}},props:["action"],methods:{empty(t){return c.empty(t)},setSlide_logement(t){for(let e=0;e<this.logements.length;e++)if(this.logements[e].idLogement==t){this.$refs.logementCarousel.setSlide(e);break}},setSlide_locataire(t){for(let e=0;e<this.locataires.length;e++)if(this.locataires[e].idLocataire==t){this.$refs.locataireCarousel.setSlide(e);break}},resetModal(){this.occupation={loyer:"",mode:"",energie:"",eau:"",puEnergie:"",puEau:"",idLogement:"",idLocataire:"",debut:""}},submitModal(t){return this.annonce.duree=this.duree.join(","),t.preventDefault(),c.empty(this.annonce.titre)||c.empty(this.annonce.description)||c.empty(this.annonce.duree)?App.error("Un titre, une description et une durée sont obligatoires"):this.annonce.titre.length<20?App.error("Le titre doit contenir au moins 20 caractères"):this.annonce.description.length<200?App.error("La description doit contenir au moins 200 caractères"):void("add"==this.action&&(this.showOverlay=!0,axios.post("annonces",this.annonce).then(t=>(r["a"].success(t.message),this.$refs["annonce-modal"].hide(),this.$emit("annonceAdded"),App.notifySuccess(t.message))).catch(t=>App.alertError(t.message)),setTimeout(()=>{this.showOverlay=!1},500)))},async getInitialiseData(){try{this.logements=await axios.get("logements").then(t=>t.result||[])}catch(t){r["a"].error(t.message)}try{this.locataires=await axios.get("locataires").then(t=>t.result||[])}catch(t){r["a"].error(t.message)}this.logements[0]&&(this.occupation.idLogement=this.logements[0].idLogement),this.locataires[0]&&(this.occupation.idLogement=this.logements[0].idLogement)}},async mounted(){await this.getInitialiseData()}},d=l,u=(a("5a5f"),a("2877")),p=Object(u["a"])(d,s,n,!1,null,"a4226b64",null),m=p.exports;const h=a("5a6f");var f={name:"list-occupations",components:{OccupationForm:m},data:()=>({action:"add",commandeOccupation:!1,search:null,showOverlay:!0,currentPage:1,perPage:4,occupation:null,occupations:[],trueOccupations:[]}),computed:{items(){return h.array_slice(this.occupations,this.offset,this.perPage)},offset(){return this.currentPage*this.perPage-this.perPage}},beforeMount(){this.getOccupations()},mounted(){this.$root.$on("new-occupation-added",()=>{this.getOccupations(),this.commandeOccupation=!1})},methods:{sendData(){},addOccupation(){this.action="add",this.commandeOccupation=!0},addedOccupation(){console.log("occupation ajoutée")},getOccupations(){axios.get("occupations").then(t=>t.result||[]).then(t=>{this.occupations=this.occupations=t,this.showOverlay=!1})},addHabitant(){this.commandeOccupation=!0},updateOccupation(t){console.log("occupation",t)},removeOccupation(t){console.log("occupation",t)},showDetails(t){this.occupation=t,setTimeout(()=>{$("#editLayoutItem").modal("show"),$("#editLayoutItem").on("hide.bs.modal",t=>{this.occupation=null}),$("#editLayoutItem").on("hidden.bs.modal",t=>{this.occupation=null})},100)}}},b=f,g=Object(u["a"])(b,o,i,!1,null,null,null);e["default"]=g.exports},"5a5f":function(t,e,a){"use strict";a("8af1")},"8af1":function(t,e,a){}}]);
//# sourceMappingURL=chunk-54b4b7b3.706cf517.js.map