(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5580d1d6"],{"0189":function(e,t,n){},"02e8":function(e,t,n){},"287a":function(e,t,n){"use strict";n("02e8")},"5ad6":function(e,t,n){"use strict";var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"card d-flex flex-row justify-justify-content-start align-items-start"},[n("a",{staticClass:"d-flex card-img",attrs:{href:"#editLayoutItem","data-toggle":"modal","data-target":"#editLayoutItem"}},[n("img",{staticClass:"list-thumbnail responsive border-0",staticStyle:{height:"10em"},attrs:{src:e.depense.photo||"/img/depenseImage.jpg",alt:""}})]),n("div",{staticClass:"d-flex flex-grow-1 min-width-zero card-content"},[n("div",{staticClass:"card-body align-self-center d-flex flex-column justify-content-between min-width-zero align-items-md-center"},[n("div",{staticClass:"list-item-heading mb-1 truncate w-100 w-xs-100",attrs:{href:"#editLayoutItem","data-toggle":"modal","data-target":"#editLayoutItem"}},[n("h5",{staticClass:"text-red"},[e._v(e._s(e.php.ucfirst(e.depense.motif.toLowerCase())))]),n("div",{staticClass:"d-flex"},[n("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.bottom",value:"Montant de la dépense",expression:"'Montant de la dépense'",modifiers:{bottom:!0}}],staticClass:"text-muted small date mr-3"},[n("i",{staticClass:"fa fa-dollar-sign"}),e._v(" "+e._s(e.depense.montant)+" F")]),n("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.bottom",value:"Date de l'opération",expression:"'Date de l\\'opération'",modifiers:{bottom:!0}}],staticClass:"text-muted small date ml-3"},[n("i",{staticClass:"far fa-calendar-alt"}),e._v(" "+e._s(e.$dayjs(e.depense.dateDepense).format("DD MMMM YYYY"))+" ")])]),n("div",{staticClass:"w-100"},[e.depense.etatDepense?n("span",{staticClass:"badge badge-pill badge-success"}):n("span",{staticClass:"badge badge-danger small"},[e._v("Non traitée")])])]),n("div",{staticClass:"card-content w-100"},[n("hr"),0==e.source?n("div",[null!==e.depense.cite?n("div",{staticClass:"text-muted w-100 my-1"},[e._m(0),n("span",[e._v("Cité :"+e._s(e.depense.cite.nomCite)+" ")])]):e._e(),null!==e.depense.batiment?n("div",{staticClass:"text-muted w-100 my-1"},[e._m(1),n("span",[e._v("Batiment :"+e._s(e.depense.batiment.nomBatiment)+" ")])]):e._e(),null!==e.depense.logement?n("div",{staticClass:"text-muted w-100 my-1"},[e._m(2),n("span",[e._v("Logement :"+e._s(e.depense.logement.refLogement)+" ")])]):e._e()]):e._e(),e.depense.observation?n("div",{staticClass:"jumbotron pt-5 pb-5 px-3 my-0"},[n("p",{staticClass:"text-muted text-small"},[e._v(e._s(e.depense.observation))])]):e._e()])]),n("div",{staticClass:"list-actions"},[e.isSub?e._e():n("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.showDetails.apply(null,arguments)}}},[n("i",{staticClass:"ik ik-eye"})]),e.isSub?n("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.accessTo.apply(null,arguments)}}},[n("i",{staticClass:"ik ik-link"})]):e._e(),e.isSub?e._e():n("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.$emit("makeUpdate",e.depense)}}},[n("i",{staticClass:"ik ik-edit-2"})]),n("a",{staticClass:"list-delete",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.remove.apply(null,arguments)}}},[n("i",{staticClass:"ik ik-trash-2"})])])])])},r=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{staticClass:"d-inline-block w-10 text-center"},[n("i",{staticClass:"fas fa-city"})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{staticClass:"d-inline-block w-10 text-center"},[n("i",{staticClass:"fa fa-building"})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{staticClass:"d-inline-block w-10 text-center"},[n("i",{staticClass:"fas fa-home"})])}];const i=n("5a6f");var a={props:{depense:{type:Object,required:!0},isSub:{type:Boolean,default:!1},source:{type:Number,default:0}},computed:{dateCreation(){const e=this.$date(this.depense.createdAt);return`Crée le ${e.format("dddd, DD MMMM YYYY")} à ${e.format("HH:mm")}`},php(){return i}},methods:{showDetails(){if(this.isSub)return!1;this.$emit("showDetails",this.depense)},accessTo(){$("#editLayoutItem").modal("hide"),this.$router.push({name:"depenses",query:{target:this.depense.idDepense}})},remove(){App.confirm(`Voullez vous vraiment supprimer la dépense " <b>${this.depense.motif}</b> " ?`,{confirm:()=>{axios.delete("depenses/"+this.depense.idDepense).then(e=>e.success?(this.$emit("deleted",this.depense.idDepense),App.notifySuccess(e.message)):App.notifyError(e.message))}})}}},s=a,l=n("2877"),c=Object(l["a"])(s,o,r,!1,null,null,null);t["a"]=c.exports},"6e1b":function(e,t,n){"use strict";n("7295")},7295:function(e,t,n){},a018:function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container-fluid"},[n("div",{staticClass:"row"},[n("div",{staticClass:"col-md-12"},[n("div",{staticClass:"mb-2 clearfix"},[n("div",{staticClass:"collapse d-md-block display-options",attrs:{id:"displayOptions"}},[n("div",{staticClass:"d-block d-md-inline-block"},[n("div",{staticClass:"btn-group d-inline-block float-md-left mr-1 mb-1 "},[n("b-form-select",{staticStyle:{height:"40px",width:"260px","border-radius":"5px","box-shadow":"none"},model:{value:e.filtre_categories,callback:function(t){e.filtre_categories=t},expression:"filtre_categories"}},[n("b-form-select-option",{attrs:{value:null}},[e._v("Filtre de catégories")]),e._l(e.typesLogements,(function(t,o){return n("b-form-select-option-group",{key:o,attrs:{label:t.libelleType}},e._l(t.sousTypesLogement,(function(t,o){return n("b-form-select-option",{key:o,attrs:{value:t.idSousType}},[e._v(e._s(t.libelleSousType))])})),1)}))],2)],1),n("SearchForm",{model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),n("div",{staticClass:"float-md-right"},[n("btnAdd",{directives:[{name:"b-modal",rawName:"v-b-modal.logementForm",modifiers:{logementForm:!0}}],attrs:{message:"Ajouter un logement"}}),n("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.top",value:"Télécharger un fichier modèle pour l'import de logements en masse",expression:"'Télécharger un fichier modèle pour l\\'import de logements en masse'",modifiers:{top:!0}},{name:"b-modal",rawName:"v-b-modal.modal-prevent-closing",modifiers:{"modal-prevent-closing":!0}}],staticClass:"btn btn-info ml-4 dispose",staticStyle:{height:"45px"},on:{click:function(t){return t.preventDefault(),e.loadCsv.apply(null,arguments)}}},[n("i",{staticClass:"fa fa-download"})]),n("flatfile-button",{staticClass:"mt-2",attrs:{licenseKey:e.licenseKey,customer:e.customer,settings:e.settings,onData:e.onData,type:"logement"}},[e._v("Ajout de logements en masse")])],1)])]),n("div",{staticClass:"separator mb-20"}),n("b-overlay",{attrs:{show:e.showOverlay,rounded:"sm"}},[e.logements.length?n("b-row",{staticClass:"layout-wrap"},e._l(e.items,(function(t,o){return n("b-col",{key:t.idLogement||o,staticClass:"animated flipInX mb-4",attrs:{lg:"4",cols:"12",sm:"6"}},[n("logement",{attrs:{logement:t},on:{makeClone:e.cloneLogement,makeUpdate:e.updateLogement,deleted:e.removeLogement,showDetails:e.showDetails}})],1)})),1):n("b-alert",{staticClass:"text-center",attrs:{variant:"info",show:""}},[n("i",{staticClass:"fa fa-exclamation-triangle fa-3x"}),n("br"),n("span",{staticClass:"h4 d-inline-flex ml-2"},[e._v("Aucun logement enregistré pour le moment")])]),n("paginator",{attrs:{hr:"top",offset:e.offset,total:e.logements.length||0,limit:e.perPage,page:e.currentPage},on:{pageChanged:function(t){e.currentPage=t},limitChanged:function(t){e.perPage=t}}})],1)],1)]),e.logement?n("div",{staticClass:"modal fade edit-layout-modal",attrs:{id:"editLayoutItem",tabindex:"-1",role:"dialog","aria-labelledby":"editLayoutItemLabel","aria-hidden":"true"}},[n("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[n("div",{staticClass:"modal-content"},[n("div",{staticClass:"modal-header"},[n("h5",{staticClass:"modal-title",attrs:{id:"editLayoutItemLabel"}},[e._v(" Détails du logement : "),n("b",[e._v(e._s(e.logement.refLogement))]),e._v(". ")]),e._m(0)]),n("div",{staticClass:"modal-body pt-2"},[n("details-logement",{attrs:{logement:e.logement}})],1)])])]):e._e(),e.logement?n("div",[n("b-modal",{attrs:{title:"Clonner le logement "+e.logement.refLogement},on:{ok:e.validateClone,hidden:e.resetCloneForm},scopedSlots:e._u([{key:"modal-footer",fn:function(t){var o=t.ok;return[n("b-button",{attrs:{size:"sm",variant:"danger",disabled:e.clone.submitted},on:{click:function(e){return o()}}},[e._v(" Valider "),e.clone.submitted?n("b-spinner",{attrs:{small:""}}):e._e()],1)]}}],null,!1,2706565153),model:{value:e.clone.enabled,callback:function(t){e.$set(e.clone,"enabled",t)},expression:"clone.enabled"}},[n("div",{staticClass:"jumbotron pt-10 pb-10"},[n("p",[e._v("Le clonnage de logement vous permet d'ajouter une multitude de logement en se servant d'un logement pré-existant pour générer de nouveaux.")])]),n("b-form-group",{attrs:{description:"Entrez le nombre de logement à générer",label:"Nombre de clone"}},[n("b-form-input",{class:{"is-invalid":e.clone.error},attrs:{type:"number",min:1},model:{value:e.clone.nbr,callback:function(t){e.$set(e.clone,"nbr",t)},expression:"clone.nbr"}})],1),n("b-form-group",{attrs:{description:"Selectionnez le batiment auquel sera rataché les logements générés",label:"Batiment"}},[n("b-form-select",{model:{value:e.clone.idBatiment,callback:function(t){e.$set(e.clone,"idBatiment",t)},expression:"clone.idBatiment"}},[n("b-form-select-option",{attrs:{value:null}},[e._v("Pas de batiment")]),e._l(e.cites,(function(t,o){return n("b-form-select-option-group",{key:o,attrs:{label:t.nomCite}},e._l(t.batiments,(function(t,o){return n("b-form-select-option",{key:o,attrs:{value:t.idBatiment}},[e._v(e._s(t.nomBatiment))])})),1)}))],2)],1)],1)],1):e._e(),n("b-modal",{ref:"logement-form",attrs:{id:"logementForm",size:"lg",title:e.title,"hide-footer":"","no-close-on-backdrop":"","hide-header-close":""},scopedSlots:e._u([{key:"modal-title",fn:function(){return[n("span",{staticClass:"ml-4 text-form-logement"},[e._v(e._s(e.title))])]},proxy:!0}])},[n("div",[n("add-logement",{attrs:{editLogement:e.logement,action:e.action},on:{logementAdded:e.addedLogement,editSuccessfull:e.editSuccessfull,closeLogementModal:e.resetLogementFormProps}})],1)]),e.commandeLoadCsv?n("load-csv"):e._e()],1)},r=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[n("span",{attrs:{"aria-hidden":"true"}},[e._v("×")])])}],i=n("c0a6"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-modal",{ref:"load-csv-modal",attrs:{id:"modal-prevent-closing",title:"Configurer votre fichier Modèle"},on:{show:e.resetModal,hidden:e.resetModal},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[n("download-excel",{staticClass:"btn btn-default",attrs:{data:e.dataForExcel,type:"csv",name:"fichiermodel.xls","before-finish":e.finishDownload}},[n("b-button",{staticClass:"btn btn-info ml-4"},[n("i",{staticClass:"fa fa-download"}),e._v("Télécharger")])],1)]},proxy:!0}])},[n("b-overlay",{attrs:{show:e.showOverlay,rounded:"sm"}},[n("form",{ref:"form",on:{submit:function(t){return t.stopPropagation(),t.preventDefault(),e.handleSubmit.apply(null,arguments)}}},[n("div",{staticClass:"form-group"},[n("label",[e._v("Batiment associé")]),n("b-form-select",{staticClass:"mb-3",attrs:{options:e.tousLesBatiments,"value-field":"idBatiment","text-field":"nomBatiment","disabled-field":"notEnabled"},model:{value:e.idBatiment,callback:function(t){e.idBatiment=t},expression:"idBatiment"}})],1),n("div",{staticClass:"form-group"},[n("label",[e._v("Catégorie associée ")]),n("b-form-select",{staticClass:"mb-3",class:e.requiredSousType?"":"is-red",attrs:{options:e.sousTypesLogements||[],"value-field":"idSousType","text-field":"libelleSousType"},model:{value:e.idSousType,callback:function(t){e.idSousType=t},expression:"idSousType"}}),e.requiredSousType?e._e():n("span",{staticStyle:{color:"red"}},[e._v("Vous devez choisir au moins un sous-type")])],1)])])],1)},s=[],l=n("2b0e"),c=n("f2d9");l["default"].component("downloadExcel",c["a"]);var u={name:"load-csv_model",data:()=>({tousLesBatiments:[],idBatiment:"",sousTypesLogements:[],idSousType:"",requiredSousType:!0,showOverlay:!0}),computed:{dataForExcel(){return[{ref:"",description:"",prixMin:"",prixMax:"",SousTypeLogement:this.idSousType,batiment:this.idBatiment,pays:"",ville:"",quartier:"",lat:"",lon:"",nombreChambres:"",nombreCuisines:"",nombreDouches:"",nombreSalons:"",nombreParkings:""}]}},async beforeMount(){await this.getLogementsData()},methods:{async getLogementsData(){try{this.tousLesBatiments=await axios.get("batiments").then(e=>e.result)}catch(e){console.log(e)}try{this.sousTypesLogements=await axios.get("soustypes-logements").then(e=>e.result)}catch(e){console.log(e)}this.showOverlay=!1},resetModal(){this.idBatiment=""},finishDownload(){this.$refs["load-csv-modal"].hide()}}},d=u,f=n("2877"),p=Object(f["a"])(d,a,s,!1,null,null,null),m=p.exports,h=n("265a"),b=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("ul",{staticClass:"nav nav-tabs"},[n("li",{staticClass:"nav-item"},[n("a",{staticClass:"nav-link",class:{active:"caracteristiques"==e.section},attrs:{"data-toggle":"tab",href:"#"},on:{click:function(t){t.preventDefault(),e.section="caracteristiques"}}},[e._v("Caractéristiques")])]),n("li",{staticClass:"nav-item"},[n("a",{staticClass:"nav-link",class:{active:"annonces"==e.section},attrs:{"data-toggle":"tab",href:"#"},on:{click:function(t){t.preventDefault(),e.section="annonces"}}},[e._v("Annonces")])]),n("li",{staticClass:"nav-item"},[n("a",{staticClass:"nav-link",class:{active:"depenses"==e.section||"add-depense"==e.section},attrs:{"data-toggle":"tab",href:"#"},on:{click:function(t){t.preventDefault(),e.section="depenses"}}},[e._v("Dépenses")])]),n("li",{staticClass:"nav-item"},[n("a",{staticClass:"nav-link",class:{active:"locataire"==e.section},attrs:{"data-toggle":"tab",href:"#"},on:{click:function(t){t.preventDefault(),e.section="locataire"}}},[e._v("Locataires")])])]),n("div",{staticClass:"tab-content mt-3"},[n("div",{staticClass:"tab-pane fade show active"},["caracteristiques"==e.section?n("b-container",{attrs:{fluid:""}},[n("h2",{staticClass:"text-capitalize font-weight-bold fs-4"},[e._v("Localisation")]),n("b-row",{staticClass:"rounded text-white py-2",staticStyle:{margin:"0",background:"#f5365c"}},[n("b-col",{attrs:{lg:"4",md:"6",sm:"12"}},[n("span",{staticClass:"d-inline-block w-100 my-1"},[e._v(" Pays: "),n("b",{staticClass:"font-weight-bold"},[e._v(e._s(null!=e.logement.adresse?e.logement.adresse.pays:null!=e.logement.batiment?e.logement.batiment.adresse.pays:""))])])]),n("b-col",{attrs:{lg:"4",md:"6",sm:"12"}},[n("span",{staticClass:"d-inline-block w-100 my-1"},[e._v(" Ville: "),n("b",{staticClass:"font-weight-bold"},[e._v(e._s(null!=e.logement.adresse?e.logement.adresse.ville:null!=e.logement.batiment?e.logement.batiment.adresse.ville:""))])])]),n("b-col",{attrs:{lg:"4",md:"6",sm:"12"}},[n("span",{staticClass:"d-inline-block w-100 my-1"},[e._v(" Quartier: "),n("b",{staticClass:"font-weight-bold"},[e._v(e._s(null!=e.logement.adresse?e.logement.adresse.quartier:null!=e.logement.batiment?e.logement.batiment.adresse.quartier:""))])])])],1),n("b-container",{staticClass:"mt-4 p-0"},[n("GmapMap",{staticClass:"w-100",staticStyle:{height:"340px"},attrs:{center:{lat:parseFloat(null!=e.logement.adresse?e.logement.adresse.lat:null!=e.logement.batiment&&e.logement.batiment.adresse.lat||0),lng:parseFloat(null!=e.logement.adresse?e.logement.adresse.lon:null!=e.logement.batiment&&e.logement.batiment.adresse.lon||0)},zoom:16}},[n("gmap-custom-marker",{attrs:{marker:e.marker}},[n("img",{attrs:{src:"/img/mapMarker.png"}})])],1)],1),n("hr"),n("h2",{staticClass:"text-capitalize font-weight-bold fs-4"},[e._v(" Caractéristiques approfondies ")]),n("b-row",[n("b-col",{attrs:{cols:"12"}},[n("span",{staticClass:"d-inline-block w-100 my-1"},[e._v(" Type de logement: "),n("b",[e._v(e._s(e.logement.sousTypeLogement.libelleSousType))])]),n("span",{staticClass:"d-inline-block w-100 text-muted"},[e._v(" Posté le : "),n("small",[e._v(e._s(e.logement.createdAt.slice(0,10)))])])]),n("b-col",{attrs:{cols:"12"}},e._l(e.caracteristiques,(function(t,o){return n("b-badge",{key:t.idCaracteristique||o,staticClass:"m-1 background"},[n("b",{staticClass:"fa-lg"},[e._v(e._s(t.valeur))]),e._v(" "+e._s(t.libelleCaracteristique)+" ")])})),1)],1),n("div",{staticClass:"jumbotron pt-10 pb-10 mt-2 mb-0"},[n("p",{staticClass:"description"},[e._v(e._s(e.logement.descLogement))])]),n("h2",{staticClass:"text-capitalize font-weight-bold fs-4 my-4"},[e._v("Photos")]),n("div",{staticClass:"row my-4"},[e.photos.length?e._e():n("div",{staticClass:"col-md-12"},[n("div",{attrs:{id:"logement-main-img"}},[n("div",{staticClass:"logement-preview"},[n("img",{attrs:{src:"/img/imagelogementdefault-.jpg",alt:""}})])])]),e.photos.length>1?n("div",{staticClass:"col-md-3"},[n("div",{attrs:{id:"logement-imgs"}},[e._l(e.newPhotos,(function(e,t){return n("div",{key:t,staticClass:"logement-preview logement-image"},[n("img",{attrs:{src:e,alt:""}})])})),n("div",{staticClass:"icon-up",on:{click:e.goUp}},[n("i",{staticClass:"fa fa-chevron-up"})]),n("div",{staticClass:"icon-down",on:{click:e.goDown}},[n("i",{staticClass:"fa fa-chevron-down"})])],2)]):e._e(),e.photos.length>1?n("div",{staticClass:"col-md-9"},[n("div",{attrs:{id:"logement-main-img"}},[n("div",{staticClass:"logement-preview"},[n("img",{attrs:{src:e.currentPicture,alt:""}})])])]):e._e()]),n("p",{staticClass:"mt-5"}),n("table",{staticClass:"table table-hover table-dark"},[n("thead",[n("tr",[n("th",{attrs:{scope:"col"}},[e._v("Libellé")]),n("th",{attrs:{scope:"col"}},[e._v("Valeur")])])]),n("tbody",[n("tr",[n("td",[e._v("Etat du logement")]),n("td",[e.logement.etatLogement?n("b-badge",{staticClass:"mt--1 mr-2 btn bg-badge background rounded-pill"},[n("small",{staticClass:"fa-sm"},[e._v("Logement occupé")])]):n("b-badge",{staticClass:"mt--1 mr-2 btn bg-badge bg-danger rounded-pill"},[n("small",{staticClass:"fa-sm"},[e._v("Logement libre")])])],1)]),n("tr",[n("td",[e._v("Prix du minimal")]),n("td",[e._v(" "+e._s(e.logement.prixMin)+" FCFA ")])]),n("tr",[n("td",[e._v("Prix du maximal")]),n("td",[e._v(" "+e._s(e.logement.prixMax)+" FCFA ")])])])]),n("hr")],1):e._e(),"annonces"==e.section?n("div",{staticStyle:{height:"75vh","overflow-y":"auto","overflow-x":"hidden"}},[e.logement.annonces.length?e._e():n("b-alert",{staticClass:"text-center",attrs:{variant:"info",show:""}},[n("i",{staticClass:"fa fa-exclamation-triangle fa-3x float-left"}),n("span",{staticClass:"h4 d-inline-flex ml-2"},[e._v("Aucune annonce enregistrée pour le moment")])]),n("b-row",e._l(e.logement.annonces,(function(t,o){return n("b-col",{key:t.idAnnonce||o,attrs:{cols:"12"}},[n("div",{staticClass:"card p-0 shadow"},[n("div",{staticClass:"card-body p-0 d-flex"},[n("b-img",{staticStyle:{height:"8em",width:"8em"},attrs:{src:e.photos[o]||e.photos[0]}}),n("div",{staticClass:"ml-2 p-2"},[n("div",[n("b-badge",{attrs:{variant:t.publish?"success":"danger"}},[e._v(e._s(t.publish?"Déja publiée":"Pas encore publiée"))]),e._v("  "),n("b-badge",{attrs:{variant:"light"}},[n("i",{staticClass:"fa fa-clock"}),e._v(" Créée le "+e._s(e.$date(t.createdAt).format("DD.MM.YYYY"))+" ")])],1),n("h5",{staticClass:"my-2"},[n("a",{staticClass:"text-red",attrs:{href:"#"}},[e._v(e._s(t.titreAnnonce))])]),e._l(t.tags.split(","),(function(t,o){return n("b-badge",{key:o,attrs:{variant:"secondary"}},[e._v(e._s(t))])}))],2)],1)])])})),1)],1):e._e(),"depenses"==e.section||"add-depense"==e.section?n("b-container",["depenses"==e.section?n("div",[n("div",{staticClass:"d-flex justify-content-between border-bottom pb-1 mb-2"},[n("div",[e.logement.depenses.length?n("paginator",{attrs:{"no-control":"",total:e.logement.depenses.length,limit:e.perPage,page:e.currentPage},on:{pageChanged:function(t){e.currentPage=t},limitChanged:function(t){e.perPage=t}}}):e._e()],1),n("b-button",{attrs:{size:"sm",variant:"outline-secondary"},on:{click:function(t){t.preventDefault(),e.section="add-depense"}}},[e._v("Ajouter une dépense")])],1),e.logement.depenses.length?n("div",{staticStyle:{height:"75vh"}},[n("div",{staticStyle:{height:"90%","overflow-y":"auto","overflow-x":"hidden"}},[n("b-row",{staticClass:"layout-wrap"},e._l(e.itemsDepenses,(function(t,o){return n("div",{key:t.idDepense||o,staticClass:"col-12 list-item list-item-thumb"},[n("depense",{attrs:{depense:t,source:e.source,"is-sub":""},on:{deleted:e.removeDepense}})],1)})),0)],1)]):n("b-alert",{attrs:{variant:"info",show:""}},[n("i",{staticClass:"fa fa-exclamation-triangle fa-3x float-left"}),n("span",{staticClass:"h4 d-inline-flex ml-2"},[e._v("Aucune dépense enregistrée pour le moment")])])],1):e._e(),n("div",{directives:[{name:"show",rawName:"v-show",value:"add-depense"==e.section,expression:"section == 'add-depense'"}]},[n("depense-form",{attrs:{logement:e.logement,provenance:e.provenance,action:e.action},on:{cancel:function(t){e.section="depenses"},depenseAdded:e.addedDepense}})],1)]):e._e(),"locataire"==e.section?n("div",{staticStyle:{height:"38em","overflow-y":"auto"}},[e.logement.occupations.length?e._e():n("b-alert",{staticClass:"text-center",attrs:{variant:"info",show:""}},[n("i",{staticClass:"fa fa-exclamation-triangle fa-3x"}),e._v(" "),n("br"),n("span",{staticClass:"h4 d-inline-flex ml-2"},[e._v("Aucun locataire n'a occupé ce logement pour le moment")])]),e._l(e.logement.occupations,(function(t,o){return n("b-card",{key:t.idOccupation||o,staticClass:"mb-3",attrs:{"img-fluid":"","img-src":t.locataire.avatar||"/img/profile-picture.jpg","img-height":"250em","img-width":"200em","img-left":""}},[n("div",{staticClass:"d-flex justify-content-between align-items-center"},[null==t.dateFin?n("b-badge",{staticClass:"w-90",attrs:{variant:"success"}},[e._v("Bail en cours")]):n("b-badge",{staticClass:"w-90",attrs:{variant:"danger"}},[e._v("Bail terminé le "+e._s(e.$date(t.dateFin).format("DD MMMM YYYY")))]),n("b-dropdown",{attrs:{size:"sm",right:"",variant:"link","toggle-class":"text-decoration-none","no-caret":""},scopedSlots:e._u([{key:"button-content",fn:function(){return[n("i",{staticClass:"fa fa-ellipsis-h"})]},proxy:!0}],null,!0)},[n("b-dropdown-item",{on:{click:function(n){return n.preventDefault(),e.goToDetailLocataire(t)}}},[e._v("Détails du locataire")]),n("b-dropdown-item",{on:{click:function(n){return n.preventDefault(),e.goToDetaiOccupation(t)}}},[e._v("Détails de l'occupation")])],1)],1),n("hr",{staticClass:"mt-1"}),n("dl",{staticClass:"row text-muted"},[n("dd",{staticClass:"my-1 col-1"},[n("i",{staticClass:"fa fa-user"})]),n("dt",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.left",value:"nom et prénom",expression:"'nom et prénom'",modifiers:{left:!0}}],staticClass:"my-1 col-11 truncate"},[e._v(" "+e._s(t.locataire.titre+" "+t.locataire.nomLocataire+" "+t.locataire.prenomLocataire)+" ")]),n("dd",{staticClass:"my-1 col-1"},[n("i",{staticClass:"fa fa-phone"})]),n("dt",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.left",value:"Numéro de téléphone",expression:"'Numéro de téléphone'",modifiers:{left:!0}}],staticClass:"my-1 col-11 truncate"},[e._v(" "+e._s(t.locataire.tel)+" ")]),n("dd",{staticClass:"my-1 col-1"},[n("i",{staticClass:"fa fa-envelope"})]),n("dt",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.left",value:"Email",expression:"'Email'",modifiers:{left:!0}}],staticClass:"my-1 col-11 truncate"},[e._v(" "+e._s(t.locataire.email)+" ")]),n("dd",{staticClass:"my-1 col-1"},[n("i",{staticClass:"fa fa-id-card"})]),n("dt",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.left",value:"Numéro de CNI",expression:"'Numéro de CNI'",modifiers:{left:!0}}],staticClass:"my-1 col-11 truncate"},[e._v(" "+e._s(t.locataire.cniLocataire)+" ")]),n("dd",{staticClass:"my-1 col-1"},[n("i",{staticClass:"fas fa-birthday-cake"})]),n("dt",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.left",value:"Date de naissance",expression:"'Date de naissance'",modifiers:{left:!0}}],staticClass:"my-1 col-11 truncate"},[e._v(" "+e._s(e.$dayjs(t.locataire.dateNaiss).format("DD MMMM YYYY"))+" ")]),n("dd",{staticClass:"my-1 col-1"},[n("i",{staticClass:"fa fa-calendar"})]),n("dt",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.left",value:"Date de début du bail",expression:"'Date de début du bail'",modifiers:{left:!0}}],staticClass:"my-1 col-11 truncate"},[e._v(" "+e._s(e.$dayjs(t.dateDeb).format("dddd, DD MMMM YYYY"))+" ")])])])}))],2):e._e()],1)])])},g=[],v=n("825a"),y=n("fc5c"),w=n("5ad6"),_=n("a474"),C=n("6cee");const k=n("5a6f");var x={components:{VueEasyLightbox:v["a"],VueUploadMultipleImage:y["a"],Depense:w["a"],DepenseForm:_["a"],GmapCustomMarker:C["a"]},props:{logement:{type:Object,required:!0}},data:()=>({section:"caracteristiques",section_photo:{index:0,visible:!1,images:[]},commandeDepense:!1,action:"add",currentPage:1,perPage:10,source:2,provenance:"2",marker:{lat:"",lng:""},currentPicture:"",newPhotos:[]}),computed:{photos(){return this.logement.photos.map(e=>e.image)},caracteristiques(){return this.logement.caracteristiques.filter(e=>parseInt(e.valeur)>0)},itemsDepenses(){return k.array_slice(this.logement.depenses,this.offset,this.perPage)},offset(){return this.currentPage*this.perPage-this.perPage}},mounted(){this.newPhotos=this.photos.slice(0,3),this.currentPicture=this.newPhotos[0],console.log("logement",this.logement),this.marker.lat=this.logement.adresse.lat,this.marker.lng=this.logement.adresse.lon},methods:{goToDetailLocataire(e){console.log("locataire",e),$("#editLayoutItem").modal("hide"),setTimeout(()=>{this.$router.push({name:"habitants",query:{target:e.locataire.idLocataire}})},100)},goToDetaiOccupation(e){console.log("locataire",e),$("#editLayoutItem").modal("hide"),setTimeout(()=>{this.$router.push({name:"occupations",query:{target:e.idOccupation}})},100)},addedDepense(){axios.get(`logements/${this.logement.idLogement}/depenses`).then(e=>e.result||[]).then(e=>{this.logement.depenses=e,this.section="depenses"})},section_photo_showImg(e){this.section_photo.index=e,this.section_photo.visible=!0},section_photo_handleHide(){this.section_photo.visible=!1},section_photo_uploadImageSuccess(e,t,n){console.log("data",e,t,n)},removeDepense(e){this.logement.depenses=this.logement.depenses.filter(t=>t.idDepense!=e),this.$emit("depensesChanged",this.logement.depenses)},onCloseSet(){this.commandeDepense=!1},goUp(){let e=document.querySelector("#logement-main-img").offsetHeight/3,t=document.querySelectorAll(".logement-image");for(let o=0;o<t.length;o++)t[o].style.height=e+"px";let n=this.photos.indexOf(this.currentPicture);if(this.newPhotos=this.photos.slice(n,n+3),this.newPhotos.length<3){console.log("Taille incomplète !!!");let e=0;while(this.newPhotos.length<3)this.newPhotos.push(this.photos[e]),e+=1}this.photos[n+1]?this.currentPicture=this.photos[n+1]:this.currentPicture=this.photos[0]},goDown(){}}},O=x,S=(n("b20f"),Object(f["a"])(O,b,g,!1,null,"6553397f",null)),E=S.exports,P=n("fb87"),L=n("e4c3");const j=n("5a6f");var D={name:"logements",components:{AddLogement:i["a"],Logement:h["a"],DetailsLogement:E,FlatfileButton:L["FlatfileButton"],LoadCsv:m,SearchForm:P["a"]},data:()=>({licenseKey:"6e79e3c9-a02b-44ba-b761-9f18a885e464",settings:{disableManualInput:!0,type:"logement",title:"Ajout de logements en masse",displayEncoding:!1,fields:[{label:"reférence",key:"ref",validators:[{validate:"required"}]},{label:"description",key:"description"},{label:"Prix Minimal",key:"prixMin",validators:[{validate:"required"}]},{label:"Prix Maximal",key:"prixMax",validators:[{validate:"required"}]},{label:"Nom Sous-type de logement",key:"sousTypeLogement",validators:[{validate:"required"}]},{label:"Nom Batiment",key:"batiment"},{label:"Pays",key:"pays",validators:[{validate:"required"}]},{label:"Ville",key:"ville",validators:[{validate:"required"}]},{label:"Quartier",key:"quartier"},{label:"Latitude",key:"lat"},{label:"Longitude",key:"lon"},{label:"Nombre de chambres",key:"nombreChambres"},{label:"Nombre de cuisines",key:"nombreCuisines"},{label:"Nombre de douches",key:"nombreDouches"},{label:"Nombre de salons",key:"nombreSalons"},{label:"Nombre de parkings",key:"nombreParkings"}]},customer:{userId:"12345"},overrides:{manual:"Did you know you can type in an import below?",dropzone:{button:"Click me to upload some data."}},commandeLoadCsv:!1,search:null,showOverlay:!0,currentPage:1,perPage:10,logements:[],trueLogements:[],logement:null,typesLogements:[],filtre_categories:null,title:"Ajouter un logement",action:"add",cites:[],clone:{enabled:!1,submitted:!1,error:!1,nbr:null,idBatiment:null},housingToUpload:[]}),computed:{items(){return j.array_slice(this.logements,this.offset,this.perPage)},offset(){return this.currentPage*this.perPage-this.perPage}},watch:{filtre_categories(e){this.logements=j.empty(e)?this.trueLogements:this.trueLogements.filter(t=>t.idSousType==e)},search(e){this.logements=j.empty(e)?this.trueLogements:this.trueLogements.filter(t=>t.refLogement.toLowerCase().includes(e.toLowerCase()))}},beforeMount(){this.getHousing()},mounted(){},methods:{resetLogementFormProps(){this.action="add",this.title="Ajouter un logement",this.$bvModal.hide("logementForm"),this.logement=null},addedLogement(){this.getHousing(!1),this.$bvModal.hide("logementForm")},editSuccessfull(){this.action="add",this.title="Ajouter un logement",this.$bvModal.hide("logementForm"),this.logement=null,this.getHousing(!1)},async getHousing(e){this.showOverlay=!0,this.logements=this.trueLogements=await axios.get("logements").then(e=>e.result||[]),this.autoAddTarget(),this.showOverlay=!1,!1!==e&&(this.typesLogements=await axios.get("types-logements?all=true").then(e=>e.result||[]),this.cites=(await axios.get("cites").then(e=>e.result||[])).filter(e=>e.batiments.length>0)),this.autoDetailsTarget()},autoAddTarget(){const e=this.$route.query.formLogement||null;e&&(this.$refs["logement-form"].show(),window.history.replaceState({},"",window.location.href.split("?")[0]))},autoDetailsTarget(){const e=this.$route.query.target||null;if(e){const t=this.trueLogements.filter(t=>t.idLogement==e)[0];t&&(this.showDetails(t),window.history.replaceState({},"",window.location.href.split("?")[0]))}},cloneLogement(e){this.clone.enabled=!0,this.clone.idBatiment=e.idBatiment,this.logement=e},validateClone(e){if(e.preventDefault(),this.clone.error=!1,j.empty(this.clone.nbr)||this.clone.nbr<1)this.clone.error=!0;else{if(this.clone.nbr>10)return this.clone.error=!0,App.error("Impossible de cloner plus de 10 logements");this.clone.submitted=!0,axios.post(`logements/${this.logement.idLogement}/clone`,this.clone).then(e=>(this.getHousing(!1),this.resetCloneForm(),App.notifySuccess(e.message))).catch(e=>(this.clone.submitted=!1,App.alertError(e.message)))}},resetCloneForm(){this.clone={enabled:!1,submitted:!1,error:!1,nbr:null,idBatiment:null}},loadCsv(){this.commandeLoadCsv=!0},updateLogement(e){this.action="edit",console.log("logement",e),this.logement=e,this.title="édition du logement "+this.logement.refLogement,this.$refs["logement-form"].show()},removeLogement(e){console.log("logement",e)},showDetails(e){this.logement=e,setTimeout(()=>{$("#editLayoutItem").modal("show"),$("#editLayoutItem").on("hide.bs.modal",e=>{this.logement=null}),$("#editLayoutItem").on("hidden.bs.modal",e=>{this.logement=null})},100)},onData(e){let t=!1;for(let n=0;n<e.$data.length;n++){let t={pays:e.$data[n].data.pays,ville:e.$data[n].data.ville,quartier:e.$data[n].data.quartier,lon:e.$data[n].data.lon,lat:e.$data[n].data.lat},o={nom:e.$data[n].data.nom,ref:e.$data[n].data.ref,description:e.$data[n].data.description,prixMin:e.$data[n].data.prixMin,prixMax:e.$data[n].data.prixMax,idSousType:e.$data[n].data.sousTypeLogement,idBatiment:e.$data[n].data.batiment,adresse:t,caracteristiques:[{libelle:"chambre",valeur:e.$data[n].data.nombreChambres},{libelle:"salon",valeur:e.$data[n].data.nombreChambres},{libelle:"cuisine",valeur:e.$data[n].data.nombreChambres},{libelle:"douche",valeur:null!=e.$data[n].data.nombreDouches?e.$data[n].data.nombreDouches:0},{libelle:"parkings",valeur:null!=e.$data[n].data.nombreParkings?e.$data[n].data.nombreParkings:0}]};console.log("logement final",o),this.housingToUpload.push(o)}return new Promise((e,n)=>{let o;for(let i=0;i<this.housingToUpload.length;i++){try{o=axios.post("logements",this.housingToUpload[i]).then(e=>e.result),i==this.housingToUpload.length-1&&this.getHousing(!1)}catch(r){console.log(r)}o||(t=!0)}setTimeout(()=>{t?(n("erreur produite"),t=!1):e("import reussi")},300)})}}},T=D,M=(n("6e1b"),Object(f["a"])(T,o,r,!1,null,"3e9154bc",null));t["default"]=M.exports},a474:function(e,t,n){"use strict";var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-overlay",{attrs:{show:e.showOverlayP,rounded:"sm"}},[n("b-row",[n("b-col",[n("b-form-group",{attrs:{label:"Montant",description:"à combien s'élève la dépense éffectuée?"}},[n("b-form-input",{attrs:{placeholder:"Ex: 45000",type:"number",trim:""},model:{value:e.depense.montant,callback:function(t){e.$set(e.depense,"montant",t)},expression:"depense.montant"}})],1)],1),n("b-col",[n("b-form-group",{attrs:{label:"Date à laquelle la dépense a été éffectuée"}},[n("date-picker",{staticClass:"w-100",attrs:{placeholder:"Selectionnez une date",format:"dddd, DD MMMM YYYY",valueType:"YYYY-MM-DD",clearable:!1},model:{value:e.depense.date,callback:function(t){e.$set(e.depense,"date",t)},expression:"depense.date"}})],1)],1)],1),n("b-row",[n("b-col",[n("b-form-group",{attrs:{label:"Motif",description:"Pourquoi avez-vous éffectué cette dépense ?"}},[n("b-form-input",{attrs:{placeholder:"Ex: Replacement ampoules cassées",trim:""},model:{value:e.depense.motif,callback:function(t){e.$set(e.depense,"motif",t)},expression:"depense.motif"}})],1)],1),n("b-col",[n("b-form-group",{attrs:{label:"responsable",description:"Qui est celui qui a déclaré la dépense?"}},[n("b-form-input",{attrs:{placeholder:"Ex: Pedro",trim:""},model:{value:e.depense.responsable,callback:function(t){e.$set(e.depense,"responsable",t)},expression:"depense.responsable"}})],1)],1)],1),n("b-row",[n("b-col",{attrs:{cols:"7"}},[n("b-form-group",{attrs:{label:"observations"}},[n("b-form-textarea",{staticClass:"mb-2",attrs:{placeholder:"C'est ici que vou pouvez décrire ce qui a engendré la dépense",rows:"7"},model:{value:e.depense.observation,callback:function(t){e.$set(e.depense,"observation",t)},expression:"depense.observation"}})],1)],1),n("b-col",{attrs:{cols:"5"}},[n("b-form-group",{attrs:{label:"joindre une photo"}},[n("img-inputer",{attrs:{theme:"light",size:"xl","bottom-text":"déposez le fichier ici ou cliquez pour modifier",icon:"img",placeholder:"joindre recu dépense"},on:{onChange:e.onrecuLoad},model:{value:e.depense.photo,callback:function(t){e.$set(e.depense,"photo",t)},expression:"depense.photo"}})],1)],1)],1),n("b-overlay",{attrs:{show:e.showOverlay,rounded:"sm"}},[n("b-row",[n("b-col",[n("b-form-group",{attrs:{label:"Votre dépense concerne"},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.ariaDescribedby;return[n("b-form-radio-group",{attrs:{id:"radio-slots",options:e.options,"aria-describedby":o,name:"radio-options-slots",disabled:e.disableState},on:{change:e.setAction},model:{value:e.commandeAction,callback:function(t){e.commandeAction=t},expression:"commandeAction"}})]}}])})],1),n("b-col",[n("transition",{attrs:{"enter-active-class":"animated zoomIn"}},[e.showSelectCite?n("div",{staticClass:"form-group"},[n("label",[e._v("Cité concernée")]),n("v-select",{class:{disabled:1==e.disabled},attrs:{label:"nomCite",options:e.cites},model:{value:e.id,callback:function(t){e.id=t},expression:"id"}})],1):e._e(),e.showSelectBatiment?n("div",{staticClass:"form-group"},[n("label",[e._v("Batiment concerné")]),n("v-select",{class:{disabled:1==e.disabled},attrs:{label:"nomBatiment",options:e.batiments},model:{value:e.id,callback:function(t){e.id=t},expression:"id"}})],1):e._e(),e.showSelectLogement?n("div",{staticClass:"form-group"},[n("label",[e._v("Logement concerné")]),n("v-select",{class:{disabled:1==e.disabled},attrs:{label:"refLogement",options:e.logements},model:{value:e.id,callback:function(t){e.id=t},expression:"id"}})],1):e._e()])],1)],1),n("hr"),n("div",{staticClass:"float-right"},["2"==e.provenance?n("b-button",{staticClass:"mr-1",on:{click:function(t){return t.preventDefault(),e.$emit("cancel")}}},[e._v("Annuler")]):e._e(),n("b-button",{attrs:{variant:"danger"},on:{click:function(t){return t.preventDefault(),e.submitModal.apply(null,arguments)}}},[e._v("Valider")])],1)],1)],1)},r=[],i=n("ec45"),a=(n("411c"),n("0edd"),n("2c43")),s=n("2b0e"),l=n("657c");n("2bd9");const c=n("5a6f");s["default"].component("ImgInputer",l["a"]);var u={name:"depense-form",data:()=>({disabled:!1,disableState:!1,options:[{text:"une cité",value:"cite"},{text:"un batiment",value:"batiment"},{text:"un logement",value:"logement"}],depense:{montant:"",date:"",motif:"",responsable:"",obs:"",photo:""},id:"",commandeAction:"",showOverlay:!1,showOverlayP:!1,showSelectCite:!1,showSelectBatiment:!1,showSelectLogement:!1,sendForm:!1,cites:[],batiments:[],logements:[]}),components:{DatePicker:i["default"]},props:{cite:{type:Object},batiment:{type:Object},logement:{type:Object},action:{type:String,required:!0,default:"add"},provenance:{type:String,required:!0,default:"1"}},methods:{async onrecuLoad(e){const t=e;this.depense.photo=await this.getBase64(t)},async setAction(){if(this.showOverlay=!0,"cite"==this.commandeAction){this.showSelectCite=!0,this.showSelectBatiment=!1,this.showSelectLogement=!1;try{this.cites=await(await axios.get("cites").then(e=>e.result))}catch(e){console.log(e)}}if("batiment"==this.commandeAction){this.showSelectBatiment=!0,this.showSelectCite=!1,this.showSelectLogement=!1;try{this.batiments=await(await axios.get("batiments").then(e=>e.result))}catch(e){console.log(e)}}if("logement"==this.commandeAction){this.showSelectLogement=!0,this.showSelectCite=!1,this.showSelectBatiment=!1;try{this.logements=await(await axios.get("logements").then(e=>e.result))}catch(e){console.log(e)}}this.showOverlay=!1},resetModal(){this.depense={montant:"",date:"",motif:"",responsable:"",observation:""},"2"!=this.provenance&&(this.showSelectCite=!1,this.showSelectBatiment=!1,this.showSelectLogement=!1,this.id=null,this.commandeAction=""),setTimeout(()=>{this.$emit("closeDepenseModal")},500)},submitModal(e){return e.preventDefault(),c.empty(this.depense.montant)||c.empty(this.depense.motif)||c.empty(this.id)?App.error("Un montant, un motif et l'entité concernée par la dépense sont obligatoires"):""==this.depense.montant?App.error("Vous devez spécifier un montant"):""==this.depense.motif?App.error("Vous devez spécifier un motif"):""==this.id?App.error("Vous devez spécifier l'entité concernée par la dépense"):void("add"==this.action&&(this.showOverlayP=!0,this.showSelectLogement&&(console.log("dépense",this.depense,"id",this.id.idLogement),axios.post("/logements/"+this.id.idLogement+"/depenses",this.depense).then(e=>(this.resetModal(),this.showOverlayP=!1,this.$emit("depenseAdded",e.result),App.notifySuccess(e.message))).catch(e=>{this.showOverlayP=!1,a["a"].error(e.message)})),this.showSelectCite&&axios.post("/cites/"+this.id.idCite+"/depenses",this.depense).then(e=>(this.resetModal(),this.showOverlayP=!1,this.$emit("depenseAdded",e.result),App.notifySuccess(e.message))).catch(e=>{this.showOverlayP=!1,a["a"].error(e.message)}),this.showSelectBatiment&&axios.post("/batiments/"+this.id.idBatiment+"/depenses",this.depense).then(e=>(this.resetModal(),this.showOverlayP=!1,this.$emit("depenseAdded",e.result),App.notifySuccess(e.message))).catch(e=>{this.showOverlayP=!1,a["a"].error(e.message)})))},getBase64(e){return new Promise((t,n)=>{const o=new FileReader;o.readAsDataURL(e),o.onload=()=>t(o.result),o.onerror=e=>n(e)})}},mounted(){null!=this.cite&&(this.commandeAction="cite",this.showSelectCite=!0,this.id=this.cite,this.disabled=!0,this.disableState=!0),null!=this.batiment&&(this.commandeAction="batiment",this.showSelectBatiment=!0,this.id=this.batiment,this.disabled=!0,this.disableState=!0),null!=this.logement&&(this.commandeAction="logement",this.showSelectLogement=!0,this.id=this.logement,this.disabled=!0,this.disableState=!0)}},d=u,f=(n("287a"),n("2877")),p=Object(f["a"])(d,o,r,!1,null,"47a744a2",null);t["a"]=p.exports},b20f:function(e,t,n){"use strict";n("0189")},e4c3:function(e,t,n){(function(t,n){e.exports=n()})("undefined"!==typeof self&&self,(function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="fae3")}({8875:function(e,t,n){var o,r,i;(function(n,a){r=[],o=a,i="function"===typeof o?o.apply(t,r):o,void 0===i||(e.exports=i)})("undefined"!==typeof self&&self,(function(){function e(){var t=Object.getOwnPropertyDescriptor(document,"currentScript");if(!t&&"currentScript"in document&&document.currentScript)return document.currentScript;if(t&&t.get!==e&&document.currentScript)return document.currentScript;try{throw new Error}catch(p){var n,o,r,i=/.*at [^(]*\((.*):(.+):(.+)\)$/gi,a=/@([^@]*):(\d+):(\d+)\s*$/gi,s=i.exec(p.stack)||a.exec(p.stack),l=s&&s[1]||!1,c=s&&s[2]||!1,u=document.location.href.replace(document.location.hash,""),d=document.getElementsByTagName("script");l===u&&(n=document.documentElement.outerHTML,o=new RegExp("(?:[^\\n]+?\\n){0,"+(c-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),r=n.replace(o,"$1").trim());for(var f=0;f<d.length;f++){if("interactive"===d[f].readyState)return d[f];if(d[f].src===l)return d[f];if(l===u&&d[f].innerHTML&&d[f].innerHTML.trim()===r)return d[f]}return null}}return e}))},c8ba:function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(o){"object"===typeof window&&(n=window)}e.exports=n},f2ae:function(e,t,n){"use strict";(function(e){var n="undefined"!==typeof window?window:"undefined"!==typeof e?e:"undefined"!==typeof self?self:{};function o(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e["default"]:e}function r(e,t){return t={exports:{}},e(t,t.exports),t.exports}r((function(e,t){(function(e,t){t()})(0,(function(){function e(e){var t=this.constructor;return this.then((function(n){return t.resolve(e()).then((function(){return n}))}),(function(n){return t.resolve(e()).then((function(){return t.reject(n)}))}))}function t(e){var t=this;return new t((function(t,n){if(!e||"undefined"===typeof e.length)return n(new TypeError(typeof e+" "+e+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var o=Array.prototype.slice.call(e);if(0===o.length)return t([]);var r=o.length;function i(e,n){if(n&&("object"===typeof n||"function"===typeof n)){var a=n.then;if("function"===typeof a)return void a.call(n,(function(t){i(e,t)}),(function(n){o[e]={status:"rejected",reason:n},0===--r&&t(o)}))}o[e]={status:"fulfilled",value:n},0===--r&&t(o)}for(var a=0;a<o.length;a++)i(a,o[a])}))}var o=setTimeout;function r(e){return Boolean(e&&"undefined"!==typeof e.length)}function i(){}function a(e,t){return function(){e.apply(t,arguments)}}function s(e){if(!(this instanceof s))throw new TypeError("Promises must be constructed via new");if("function"!==typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],p(e,this)}function l(e,t){while(3===e._state)e=e._value;0!==e._state?(e._handled=!0,s._immediateFn((function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null!==n){var o;try{o=n(e._value)}catch(r){return void u(t.promise,r)}c(t.promise,o)}else(1===e._state?c:u)(t.promise,e._value)}))):e._deferreds.push(t)}function c(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"===typeof t||"function"===typeof t)){var n=t.then;if(t instanceof s)return e._state=3,e._value=t,void d(e);if("function"===typeof n)return void p(a(n,t),e)}e._state=1,e._value=t,d(e)}catch(o){u(e,o)}}function u(e,t){e._state=2,e._value=t,d(e)}function d(e){2===e._state&&0===e._deferreds.length&&s._immediateFn((function(){e._handled||s._unhandledRejectionFn(e._value)}));for(var t=0,n=e._deferreds.length;t<n;t++)l(e,e._deferreds[t]);e._deferreds=null}function f(e,t,n){this.onFulfilled="function"===typeof e?e:null,this.onRejected="function"===typeof t?t:null,this.promise=n}function p(e,t){var n=!1;try{e((function(e){n||(n=!0,c(t,e))}),(function(e){n||(n=!0,u(t,e))}))}catch(o){if(n)return;n=!0,u(t,o)}}s.prototype["catch"]=function(e){return this.then(null,e)},s.prototype.then=function(e,t){var n=new this.constructor(i);return l(this,new f(e,t,n)),n},s.prototype["finally"]=e,s.all=function(e){return new s((function(t,n){if(!r(e))return n(new TypeError("Promise.all accepts an array"));var o=Array.prototype.slice.call(e);if(0===o.length)return t([]);var i=o.length;function a(e,r){try{if(r&&("object"===typeof r||"function"===typeof r)){var s=r.then;if("function"===typeof s)return void s.call(r,(function(t){a(e,t)}),n)}o[e]=r,0===--i&&t(o)}catch(l){n(l)}}for(var s=0;s<o.length;s++)a(s,o[s])}))},s.allSettled=t,s.resolve=function(e){return e&&"object"===typeof e&&e.constructor===s?e:new s((function(t){t(e)}))},s.reject=function(e){return new s((function(t,n){n(e)}))},s.race=function(e){return new s((function(t,n){if(!r(e))return n(new TypeError("Promise.race accepts an array"));for(var o=0,i=e.length;o<i;o++)s.resolve(e[o]).then(t,n)}))},s._immediateFn="function"===typeof setImmediate&&function(e){setImmediate(e)}||function(e){o(e,0)},s._unhandledRejectionFn=function(e){"undefined"!==typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)};var m=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n)return n;throw new Error("unable to locate global object")}();"function"!==typeof m["Promise"]?m["Promise"]=s:m.Promise.prototype["finally"]?m.Promise.allSettled||(m.Promise.allSettled=t):m.Promise.prototype["finally"]=e}))}));var i=function(e){if(arguments.length<1)throw new TypeError("1 argument is required");if("object"!==typeof e)throw new TypeError("Argument 1 (”other“) to Node.contains must be an instance of Node");var t=e;do{if(this===t)return!0;t&&(t=t.parentNode)}while(t);return!1};function a(){"object"===typeof document&&"function"!==typeof document.contains&&(Object.getPrototypeOf(document).contains=i)}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},s(e,t)};function l(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var c=function(){return c=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},c.apply(this,arguments)};function u(e,t,n,o){function r(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{l(o.next(e))}catch(t){i(t)}}function s(e){try{l(o["throw"](e))}catch(t){i(t)}}function l(e){e.done?n(e.value):r(e.value).then(a,s)}l((o=o.apply(e,t||[])).next())}))}function d(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(e){return function(t){return l([e,t])}}function l(i){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,o&&(r=2&i[0]?o["return"]:i[0]?o["throw"]||((r=o["return"])&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(r=a.trys,!(r=r.length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}}var f=r((function(e){var t=Object.prototype.hasOwnProperty,n="~";function o(){}function r(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function i(e,t,o,i,a){if("function"!==typeof o)throw new TypeError("The listener must be a function");var s=new r(o,i||e,a),l=n?n+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],s]:e._events[l].push(s):(e._events[l]=s,e._eventsCount++),e}function a(e,t){0===--e._eventsCount?e._events=new o:delete e._events[t]}function s(){this._events=new o,this._eventsCount=0}Object.create&&(o.prototype=Object.create(null),(new o).__proto__||(n=!1)),s.prototype.eventNames=function(){var e,o,r=[];if(0===this._eventsCount)return r;for(o in e=this._events)t.call(e,o)&&r.push(n?o.slice(1):o);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},s.prototype.listeners=function(e){var t=n?n+e:e,o=this._events[t];if(!o)return[];if(o.fn)return[o.fn];for(var r=0,i=o.length,a=new Array(i);r<i;r++)a[r]=o[r].fn;return a},s.prototype.listenerCount=function(e){var t=n?n+e:e,o=this._events[t];return o?o.fn?1:o.length:0},s.prototype.emit=function(e,t,o,r,i,a){var s=n?n+e:e;if(!this._events[s])return!1;var l,c,u=this._events[s],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,o),!0;case 4:return u.fn.call(u.context,t,o,r),!0;case 5:return u.fn.call(u.context,t,o,r,i),!0;case 6:return u.fn.call(u.context,t,o,r,i,a),!0}for(c=1,l=new Array(d-1);c<d;c++)l[c-1]=arguments[c];u.fn.apply(u.context,l)}else{var f,p=u.length;for(c=0;c<p;c++)switch(u[c].once&&this.removeListener(e,u[c].fn,void 0,!0),d){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,t);break;case 3:u[c].fn.call(u[c].context,t,o);break;case 4:u[c].fn.call(u[c].context,t,o,r);break;default:if(!l)for(f=1,l=new Array(d-1);f<d;f++)l[f-1]=arguments[f];u[c].fn.apply(u[c].context,l)}}return!0},s.prototype.on=function(e,t,n){return i(this,e,t,n,!1)},s.prototype.once=function(e,t,n){return i(this,e,t,n,!0)},s.prototype.removeListener=function(e,t,o,r){var i=n?n+e:e;if(!this._events[i])return this;if(!t)return a(this,i),this;var s=this._events[i];if(s.fn)s.fn!==t||r&&!s.once||o&&s.context!==o||a(this,i);else{for(var l=0,c=[],u=s.length;l<u;l++)(s[l].fn!==t||r&&!s[l].once||o&&s[l].context!==o)&&c.push(s[l]);c.length?this._events[i]=1===c.length?c[0]:c:a(this,i)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&a(this,t)):(this._events=new o,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s})),p=f.EventEmitter,m=["interactive","complete"],h=function(e,t){return new Promise((function(n){e&&"function"!==typeof e&&(t=e,e=null),t=t||window.document;var o=function(){return n(void(e&&setTimeout(e)))};-1!==m.indexOf(t.readyState)?o():t.addEventListener("DOMContentLoaded",o)}))};h.resume=function(e){return function(t){return h(e).then((function(){return t}))}};var b=[],g=[],v="insert-css: You need to provide a CSS string. Usage: insertCss(cssString[, options]).";function y(e,t){if(t=t||{},void 0===e)throw new Error(v);var n,o=!0===t.prepend?"prepend":"append",r=void 0!==t.container?t.container:document.querySelector("head"),i=b.indexOf(r);return-1===i&&(i=b.push(r)-1,g[i]={}),void 0!==g[i]&&void 0!==g[i][o]?n=g[i][o]:(n=g[i][o]=w(),"prepend"===o?r.insertBefore(n,r.childNodes[0]):r.appendChild(n)),65279===e.charCodeAt(0)&&(e=e.substr(1,e.length)),n.styleSheet?n.styleSheet.cssText+=e:n.textContent+=e,n}function w(){var e=document.createElement("style");return e.setAttribute("type","text/css"),e}var _=y,C=y;_.insertCss=C;var k=function(e){return new $(e)};function x(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,o=e.length;n<o;n++)if(e[n]===t)return n;return-1}function $(e){if(!(this instanceof $))return new $(e);e||(e={}),e.nodeType&&(e={el:e}),this.opts=e,this.el=e.el||document.body,"object"!==typeof this.el&&(this.el=document.querySelector(this.el))}$.prototype.add=function(e){var t=this.el;if(t){if(""===t.className)return t.className=e;var n=t.className.split(" ");return x(n,e)>-1||(n.push(e),t.className=n.join(" ")),n}},$.prototype.remove=function(e){var t=this.el;if(t&&""!==t.className){var n=t.className.split(" "),o=x(n,e);return o>-1&&n.splice(o,1),t.className=n.join(" "),n}},$.prototype.has=function(e){var t=this.el;if(t){var n=t.className.split(" ");return x(n,e)>-1}},$.prototype.toggle=function(e){var t=this.el;t&&(this.has(e)?this.remove(e):this.add(e))};var O=r((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ERR_IFRAME_ALREADY_ATTACHED_TO_DOM=t.ERR_NOT_IN_IFRAME=t.ERR_CONNECTION_TIMEOUT=t.ERR_CONNECTION_DESTROYED=void 0;var n="handshake",o="handshake-reply",r="call",i="reply",a="fulfilled",s="rejected",l="message",c="DataCloneError",u="ConnectionDestroyed";t.ERR_CONNECTION_DESTROYED=u;var d="ConnectionTimeout";t.ERR_CONNECTION_TIMEOUT=d;var f="NotInIframe";t.ERR_NOT_IN_IFRAME=f;var p="IframeAlreadyAttachedToDom";t.ERR_IFRAME_ALREADY_ATTACHED_TO_DOM=p;var m=6e4,h={"http:":"80","https:":"443"},b=/^(https?:|file:)?\/\/([^/:]+)?(:(\d+))?/,g={ERR_CONNECTION_DESTROYED:u,ERR_CONNECTION_TIMEOUT:d,ERR_NOT_IN_IFRAME:f,ERR_IFRAME_ALREADY_ATTACHED_TO_DOM:p,Promise:function(){try{return window?window.Promise:null}catch(e){return null}}(),debug:!1},v=function(){var e=0;return function(){return++e}}(),y=function(){if(g.debug){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];(e=console).log.apply(e,["[Penpal]"].concat(n))}},w=function(e){var t,n,o,r=document.location,i=b.exec(e);if(i?(t=i[1]?i[1]:r.protocol,n=i[2],o=i[4]):(t=r.protocol,n=r.hostname,o=r.port),"file:"===t)return"null";var a=o&&o!==h[t]?":".concat(o):"";return"".concat(t,"//").concat(n).concat(a)},_=function(e){var t=[];return e((function(){t.forEach((function(e){e()}))})),{then:function(e){t.push(e)}}},C=function(e){var t=e.name,n=e.message,o=e.stack;return{name:t,message:n,stack:o}},k=function(e){var t=new Error;return Object.keys(e).forEach((function(n){return t[n]=e[n]})),t},x=function(e,t,n,o,s){var c=t.localName,d=t.local,f=t.remote,p=t.remoteOrigin,m=!1;y("".concat(c,": Connecting call sender"));var h=function(e){return function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];if(y("".concat(c,": Sending ").concat(e,"() call")),f.closed&&o(),m){var h=new Error("Unable to send ".concat(e,"() call due ")+"to destroyed connection");throw h.code=u,h}return new g.Promise((function(t,o){var s=v(),u=function n(r){if(r.source===f&&r.origin===p&&r.data.penpal===i&&r.data.id===s){y("".concat(c,": Received ").concat(e,"() reply")),d.removeEventListener(l,n);var u=r.data.returnValue;r.data.returnValueIsError&&(u=k(u)),(r.data.resolution===a?t:o)(u)}};d.addEventListener(l,u),f.postMessage({penpal:r,id:s,methodName:e,args:n},p)}))}};s.then((function(){m=!0})),n.reduce((function(e,t){return e[t]=h(t),e}),e)},$=function(e,t,n){var o=e.localName,u=e.local,d=e.remote,f=e.remoteOrigin,p=!1;y("".concat(o,": Connecting call receiver"));var m=function(e){if(e.source===d&&e.origin===f&&e.data.penpal===r){var n=e.data,l=n.methodName,u=n.args,m=n.id;if(y("".concat(o,": Received ").concat(l,"() call")),l in t){var h=function(e){return function(t){if(y("".concat(o,": Sending ").concat(l,"() reply")),p)y("".concat(o,": Unable to send ").concat(l,"() reply due to destroyed connection"));else{var n={penpal:i,id:m,resolution:e,returnValue:t};e===s&&t instanceof Error&&(n.returnValue=C(t),n.returnValueIsError=!0);try{d.postMessage(n,f)}catch(r){throw r.name===c&&d.postMessage({penpal:i,id:m,resolution:s,returnValue:C(r),returnValueIsError:!0},f),r}}}};new g.Promise((function(e){return e(t[l].apply(t,u))})).then(h(a),h(s))}}};u.addEventListener(l,m),n.then((function(){p=!0,u.removeEventListener(l,m)}))};g.connectToChild=function(e){var t,r=e.url,i=e.appendTo,a=e.iframe,s=e.methods,c=void 0===s?{}:s,f=e.timeout;if(a&&a.parentNode){var h=new Error("connectToChild() must not be called with an iframe already attached to DOM");throw h.code=p,h}var b=new _((function(e){t=e})),v=window;a=a||document.createElement("iframe"),a.src=r;var C=w(r),k=new g.Promise((function(e,r){var s;void 0!==f&&(s=setTimeout((function(){var e=new Error("Connection to child timed out after ".concat(f,"ms"));e.code=d,r(e),t()}),f));var p,h,g={},w=function(r){var i=a.contentWindow;if(r.source===i&&r.origin===C&&r.data.penpal===n){y("Parent: Received handshake, sending reply");var l="null"===r.origin?"*":r.origin;r.source.postMessage({penpal:o,methodNames:Object.keys(c)},l);var u={localName:"Parent",local:v,remote:i,remoteOrigin:l};h&&h();var d=new _((function(e){b.then(e),h=e}));$(u,c,d),p&&p.forEach((function(e){delete g[e]})),p=r.data.methodNames,x(g,u,p,t,b),clearTimeout(s),e(g)}};v.addEventListener(l,w),y("Parent: Loading iframe"),(i||document.body).appendChild(a);var k=setInterval((function(){document.body.contains(a)||(clearInterval(k),t())}),m);b.then((function(){a.parentNode&&a.parentNode.removeChild(a),v.removeEventListener(l,w),clearInterval(k);var e=new Error("Connection destroyed");e.code=u,r(e)}))}));return{promise:k,iframe:a,destroy:t}},g.connectToParent=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.parentOrigin,i=void 0===r?"*":r,a=t.methods,s=void 0===a?{}:a,c=t.timeout;if(window===window.top){var p=new Error("connectToParent() must be called within an iframe");throw p.code=f,p}var m=new _((function(t){e=t})),h=window,b=h.parent,v=new g.Promise((function(t,r){var a;void 0!==c&&(a=setTimeout((function(){var t=new Error("Connection to parent timed out after ".concat(c,"ms"));t.code=d,r(t),e()}),c));var f=function n(r){if(("*"===i||i===r.origin)&&r.source===b&&r.data.penpal===o){y("Child: Received handshake reply"),h.removeEventListener(l,n);var c={localName:"Child",local:h,remote:b,remoteOrigin:r.origin},u={};$(c,s,m),x(u,c,r.data.methodNames,e,m),clearTimeout(a),t(u)}};h.addEventListener(l,f),m.then((function(){h.removeEventListener(l,f);var e=new Error("Connection destroyed");e.code=u,r(e)})),y("Child: Sending handshake"),b.postMessage({penpal:n,methodNames:Object.keys(s)},i)}));return{promise:v,destroy:e}};var O=g;t.default=O})),S=o(O),E=function(){function e(e){this.$meta=e}return Object.defineProperty(e.prototype,"originalRows",{get:function(){return this.$meta.count_rows},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"acceptedRows",{get:function(){return this.$meta.count_rows_accepted||null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"originalColumns",{get:function(){return this.$meta.count_columns||null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"matchedColumns",{get:function(){return this.$meta.count_columns_matched||null},enumerable:!1,configurable:!0}),e}(),P=function(){function e(e){this.$user=e}return Object.defineProperty(e.prototype,"id",{get:function(){return this.$user.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userId",{get:function(){return this.$user.userId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.$user.name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"email",{get:function(){return this.$user.name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"companyName",{get:function(){return this.$user.companyName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"companyId",{get:function(){return this.$user.companyId},enumerable:!1,configurable:!0}),e}(),L=function(){function e(e){this.$file=e}return Object.defineProperty(e.prototype,"id",{get:function(){return this.$file.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"filename",{get:function(){return this.$file.filename},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"filesize",{get:function(){return this.$file.filesize},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"filetype",{get:function(){return this.$file.filetype},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"url",{get:function(){return this.$file.url},enumerable:!1,configurable:!0}),e}(),j=function(){function e(e,t){this.$meta=t,this.$data=e}return Object.defineProperty(e.prototype,"rawOutput",{get:function(){return this.$data},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this.validData},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"validData",{get:function(){return this.$data.filter((function(e){return e.valid})).filter((function(e){return!e.deleted})).map((function(e){return e.data}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"deletedData",{get:function(){return this.$data.filter((function(e){return e.deleted})).map((function(e){return e.data}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"allData",{get:function(){return this.$data.map((function(e){return e.data}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"remainingChunks",{get:function(){return Math.ceil((this.totalChunks-this.currentChunk)/this.$meta.inChunks)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"totalChunks",{get:function(){return Math.ceil(this.$meta.count_rows_accepted/this.$meta.inChunks)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"chunkSize",{get:function(){return this.$meta.inChunks},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentChunk",{get:function(){return(this.$meta.pointer+this.chunkSize)/this.chunkSize},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasMore",{get:function(){return this.$meta.hasMore},enumerable:!1,configurable:!0}),e}(),D=function(){function e(e,t,n){this.$meta=t,this.$data=e,this.$importer=n}return Object.defineProperty(e.prototype,"rawOutput",{get:function(){return this.blobOnly(this.$data,"rawOutput")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this.blobOnly(this.validData,"data")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"validData",{get:function(){var e=this.$data.filter((function(e){return e.valid})).filter((function(e){return!e.deleted})).map((function(e){return e.data}));return this.blobOnly(e,"validData")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"deletedData",{get:function(){var e=this.$data.filter((function(e){return e.deleted})).map((function(e){return e.data}));return this.blobOnly(e,"deletedData")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"allData",{get:function(){return this.blobOnly(this.$data.map((function(e){return e.data})),"allData")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"batchId",{get:function(){return this.$meta.batchID},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stats",{get:function(){return new E(this.$meta)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"customer",{get:function(){return this.$meta.endUser?new P(this.$meta.endUser):null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"originalFile",{get:function(){return this.$meta.originalFile?new L(this.$meta.originalFile):null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"csvFile",{get:function(){if(this.$meta.originalFile){if("csv"===this.$meta.originalFile.filetype)return new L(this.$meta.originalFile);if(this.$meta.csvFile)return new L(this.$meta.csvFile)}return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fileName",{get:function(){return this.$meta.filename||null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"managed",{get:function(){return this.$meta.managed||!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"manual",{get:function(){return this.$meta.manual},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"config",{get:function(){return this.$meta.config},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parsingConfig",{get:function(){return this.$meta.parsing_config},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skippedRows",{get:function(){return this.$meta.skipped_rows||null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"headersRaw",{get:function(){return this.$meta.headers_raw||null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"headersMatched",{get:function(){return this.$meta.headers_matched||null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"customColumns",{get:function(){return this.$meta.custom_columns},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"categoryFieldMap",{get:function(){return this.$meta.category_field_map||null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"failureReason",{get:function(){return this.$meta.failure_reason||null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"submittedAt",{get:function(){return this.$meta.submitted_at||null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"failedAt",{get:function(){return this.$meta.failed_at||null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"createdAt",{get:function(){return this.$meta.created_at},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stylesheet",{get:function(){return this.$meta.stylesheet},enumerable:!1,configurable:!0}),e.prototype.blobOnly=function(e,t,n){if(void 0===n&&(n="nextChunk()"),this.$meta.inChunks)throw new Error('"'+t+'" is not accessible when using "inChunks". Please see docs for "'+n+'" instead.');return e},e.prototype.nextChunk=function(){var e=this;return new Promise((function(t,n){if(!e.$meta.inChunks)return n('"nextChunk()" is only accessible when using "inChunks". Please see docs for "requestDataFromUser".');e.$importer.$ready.then((function(e){console.log("child.nextChunk()"),e.nextChunk().then((function(e){console.log("nextChunk()",e),t(e.results.length?new j(e.results,e.meta):null)}),(function(e){console.log("nextChunk(err)",e)}))}))}))},e}(),T=function(e){function t(n,o,r){var i=e.call(this)||this;return i.$fieldHooks=[],i.$stepHooks={},i.apiKey=n,i.options=o,i.customer=r,i.uuid=i.$generateUuid(),i.$ready=new t.Promise((function(e,t){i.$resolver=e,i.$rejecter=t})),h((function(){i.initialize()})),i}return l(t,e),t.setMountUrl=function(e){this.MOUNT_URL=e},t.setVersion=function(e){switch(e){case 1:this.MOUNT_URL="https://kiosk-lite.flatfile.io/?key=:key";break;case 2:this.MOUNT_URL="https://portal-2.flatfile.io/?key=:key";break;default:throw new Error(e+" is not a valid version")}},t.prototype.open=function(e){var t=this;void 0===e&&(e={}),e=c(c({},e),{bulkInit:!0,hasRecordHook:!!this.$recordHook,hasInteractionEventCallback:!!this.$interactionEventCallback,stepHooks:Object.keys(this.$stepHooks),fieldHooks:this.$fieldHooks.map((function(e){return e.field})),endUser:this.customer}),this.$ready.then((function(n){k(document.body).add("flatfile-active");var o=document.getElementById("flatfile-"+t.uuid);o&&(o.style.display="block"),n.open(e)}))},t.prototype.load=function(){var e=this;return new t.Promise((function(t,n){e.open();var o=function(){e.removeListener("close",i),e.removeListener("complete",r)};function r(e){t(e),o()}function i(e){n(e),o()}e.on("close",i),e.on("complete",r)}))},t.prototype.requestDataFromUser=function(e){return void 0===e&&(e={}),this.open(c(c({},e),{inChunks:e.inChunks||null,expectsExpandedResults:!0})),this.responsePromise()},t.prototype.displayLoader=function(e){this.$ready.then((function(t){t.displayLoader(e)}))},t.prototype.displayError=function(e){this.$ready.then((function(t){t.displayError(e)}))},t.prototype.requestCorrectionsFromUser=function(e,t){return this.$ready.then((function(n){n.displayError(e,t)})),this.responsePromise()},t.prototype.displaySuccess=function(e){var t=this;return this.$ready.then((function(t){t.displaySuccess(e)})),new Promise((function(e){var n=function(){e(),t.removeListener("close",n)};t.on("close",n)}))},t.prototype.setCustomer=function(e){this.customer=e},t.prototype.setLanguage=function(e){this.$ready.then((function(t){t.setLanguage(e)}))},t.prototype.addVirtualField=function(e,t){void 0===t&&(t={}),this.$ready.then((function(n){n.addVirtualField({field:e,options:t})}))},t.prototype.registerRecordHook=function(e){this.$recordHook=e},t.prototype.registerNetworkErrorCallback=function(e){this.$networkErrorCallback=e},t.prototype.registerBeforeFetchCallback=function(e){this.$beforeFetchCallback=e},t.prototype.registerInteractionEventCallback=function(e){this.$interactionEventCallback=e},t.prototype.registerFieldHook=function(e,t){this.$fieldHooks.push({field:e,cb:t})},t.prototype.registerStepHook=function(e,t){this.$stepHooks[e]=t},t.prototype.close=function(){this.$ready.then((function(e){e.close()}))},t.prototype.handleClose=function(){k(document.body).remove("flatfile-active");var e=document.getElementById("flatfile-"+this.uuid);e&&(e.style.display="none")},t.prototype.initialize=function(){var e=this;_("\n      .flatfile-component {\n        position: fixed;\n        top: 0;\n        bottom: 0;\n        right: 0;\n        left: 0;\n        display: none;\n        z-index: 100000;\n      }\n      .flatfile-component iframe {\n        width: 100%;\n        height: 100%;\n        position: absolute;\n        border-width: 0;\n      }\n      body.flatfile-active {\n        overflow: hidden;\n        overscroll-behavior-x: none;\n      }\n    "),document.body.insertAdjacentHTML("beforeend",'<div id="flatfile-'+this.uuid+'" class="flatfile-component"></div>'),this.handshake=S.connectToChild({appendTo:document.getElementById("flatfile-"+this.uuid)||void 0,url:t.MOUNT_URL.replace(":key",this.apiKey),methods:{results:function(t){e.emit("results",t.results,t.meta)},complete:function(t){e.emit("complete",t.rows,t.meta)},close:function(){e.emit("close"),e.handleClose()},networkErrorCallback:function(t){return e.$networkErrorCallback?e.$networkErrorCallback(t):void 0},beforeFetchCallback:function(t){return e.$beforeFetchCallback?e.$beforeFetchCallback(t):void 0},interactionEventCallback:function(t){return e.$interactionEventCallback?e.$interactionEventCallback(t):void 0},dataHookCallback:function(t,n,o){try{return e.$recordHook?e.$recordHook(t,n,o):void 0}catch(i){i.message;var r=i.stack;return console.error("Flatfile Record Hook Error on row "+n+":\n  "+r,{row:t,mode:o}),{}}},bulkHookCallback:function(t,n){try{return e.$recordHook?Promise.all(t.map((function(t){var o=t[0],r=t[1];try{return e.$recordHook(o,r,n)}catch(i){throw i.row=o,i.index=r,i}}))):void 0}catch(a){var o=a.stack,r=a.row,i=a.index;return console.error("Flatfile Record Hook Error on row "+i+":\n  "+o,{row:r,mode:n}),{}}},fieldHookCallback:function(t,n){var o=e.$fieldHooks.find((function(e){return e.field===n.field}));if(o)try{return o.cb(t,n)}catch(i){var r=i.stack;return console.error('Flatfile Field Hook Error on field "'+n.field+'":\n  '+r,{meta:n,values:t}),[]}},stepHookCallback:function(t,n){return u(e,void 0,void 0,(function(){var e,o;return d(this,(function(r){switch(r.label){case 0:if(!this.$stepHooks[t])return[2,void 0];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.$stepHooks[t](n)];case 2:return[2,r.sent()];case 3:return e=r.sent(),o=e.stack,console.error('Flatfile Step Hook Error on step "'+t+'":\n  '+o,{payload:n}),[3,4];case 4:return[2]}}))}))},ready:function(){return e.handshake.promise.then((function(t){e.$resolver(t),e.customer&&t.setUser(e.customer)})).catch((function(e){console.error(e)})),e.options}}}),this.handshake.promise.catch((function(t){e.$rejecter(t)}))},t.prototype.$generateUuid=function(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)},t.prototype.responsePromise=function(){var e=this;return new Promise((function(t,n){var o=function(n,o){return u(e,void 0,void 0,(function(){var e;return d(this,(function(r){return e=new D(n,o,this),t(e),a(),[2]}))}))};function r(e){n(e),a()}var i=e;function a(){i.removeListener("close",r),i.removeListener("results",o)}e.on("close",r),e.on("results",o)}))},t.Promise=Promise,t.MOUNT_URL="https://portal-2.flatfile.io/?key=:key",t}(p);a(),t["a"]=T}).call(this,n("c8ba"))},fae3:function(e,t,n){"use strict";if(n.r(t),n.d(t,"FlatfileButton",(function(){return p})),"undefined"!==typeof window){var o=window.document.currentScript,r=n("8875");o=r(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:r});var i=o&&o.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);i&&(n.p=i[1])}var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("button",{on:{click:e.launch}},[e._t("default"),e.hasSlotData?e._e():n("span",[e._v(" Upload with Flatfile ")])],2)])},s=[],l=n("f2ae"),c={name:"flatfile-button",props:{settings:{type:Object,validator:function(e){return e&&e.type&&e.fields}},customer:{type:Object,validator:function(e){return e&&e.userId}},licenseKey:{type:String,validator:function(e){return e&&e.length}},fieldHooks:Object,source:[String,Array],onCancel:Function,onInteractionEvent:Function,onBeforeFetch:Function,onData:Function,onRecordChange:Function,onRecordInit:Function,render:Function,preload:{default:!0,type:Boolean},mountUrl:String},data:function(){return{flatfileImporter:null,loaded:!1,importerLoaded:!0}},mounted:function(){this.preload&&this.loadImporter()},computed:{hasDefaultSlot:function(){return!!this.$slots.default}},methods:{loadImporter:function(){var e=this;if(!this.flatfileImporter){this.mountUrl&&l["a"].setMountUrl(this.mountUrl);var t=new l["a"](this.licenseKey,this.settings,this.customer);if(this.fieldHooks)for(var n in this.fieldHooks)t.registerFieldHook(n,this.fieldHooks[n]);this.onBeforeFetch&&t.registerBeforeFetchCallback(this.onBeforeFetch),this.onInteractionEvent&&t.registerInteractionEventCallback(this.onInteractionEvent),(this.onRecordChange||this.onRecordInit)&&t.registerRecordHook((function(t,n,o){return"init"===o&&e.onRecordInit?e.onRecordInit(t,n):"change"===o&&e.onRecordChange?e.onRecordChange(t,n):void 0})),this.flatfileImporter=t,this.loaded=!0}},dataHandler:function(e){var t,n=this;this.flatfileImporter.displayLoader(),null===(t=this.onData)||void 0===t||t.call(this,e).then((function(e){var t,o;return null!==e?null===(t=n.flatfileImporter.current)||void 0===t?void 0:t.displaySuccess(e||void 0):null===(o=n.flatfileImporter.current)||void 0===o?void 0:o.close()}),(function(e){var t;return null===(t=n.flatfileImporter.current)||void 0===t?void 0:t.requestCorrectionsFromUser(e instanceof Error?e.message:e).then(n.dataHandler,(function(){var e;return null===(e=n.onCancel)||void 0===e?void 0:e.call(n)}))}))},launch:function(){var e=this;this.validateInputs();var t=function t(n){e.flatfileImporter.displayLoader(),e.onData?e.onData(n).then((function(t){e.flatfileImporter.displaySuccess(t||"Success!")}),(function(n){console.error("Flatfile Error : ".concat(n)),e.flatfileImporter.requestCorrectionsFromUser(n?n.message:n).then(t,(function(){var t;return null===(t=e.onCancel)||void 0===t?void 0:t.call(e)}))})):e.flatfileImporter.displaySuccess("Success!")};if(!this.flatfileImporter){if(this.preload)return;this.loadImporter()}var n=this.source?{source:this.source}:void 0;this.flatfileImporter.requestDataFromUser(n).then(t,(function(){var t;return null===(t=e.onCancel)||void 0===t?void 0:t.call(e)}))},validateInputs:function(){var e,t,n;this.licenseKey||(console.error("[Error] Flatfile VueJS Adapter - licenseKey not provided!"),this.isImporterLoaded=!1),null!==(e=this.customer)&&void 0!==e&&e.userId||(console.error("[Error] Flatfile VueJS Adapter - customer userId not provided!"),this.isImporterLoaded=!1),null!==(t=this.settings)&&void 0!==t&&t.type&&null!==(n=this.settings)&&void 0!==n&&n.fields||(console.error("[Error] Flatfile VueJS Adapter - settings { type: String, fields: Array } not provided!"),this.isImporterLoaded=!1)}}},u=c;function d(e,t,n,o,r,i,a,s){var l,c="function"===typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=n,c._compiled=!0),o&&(c.functional=!0),i&&(c._scopeId="data-v-"+i),a?(l=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),r&&r.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(a)},c._ssrRegister=l):r&&(l=s?function(){r.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:r),l)if(c.functional){c._injectStyles=l;var u=c.render;c.render=function(e,t){return l.call(t),u(e,t)}}else{var d=c.beforeCreate;c.beforeCreate=d?[].concat(d,l):[l]}return{exports:e,options:c}}var f=d(u,a,s,!1,null,null,null),p=f.exports}})}))},f2d9:function(e,t,n){"use strict";(function(e){"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof e||"undefined"!==typeof self&&self;function n(e,t){return t={exports:{}},e(t,t.exports),t.exports}var o=n((function(e,t){(function(t,n){e.exports=n()})(0,(function(){return function e(t,n,o){var r,i,a=window,s="application/octet-stream",l=o||s,c=t,u=!n&&!o&&c,d=document.createElement("a"),f=function(e){return String(e)},p=a.Blob||a.MozBlob||a.WebKitBlob||f,m=n||"download";if(p=p.call?p.bind(a):Blob,"true"===String(this)&&(c=[c,l],l=c[0],c=c[1]),u&&u.length<2048&&(m=u.split("/").pop().split("?")[0],d.href=u,-1!==d.href.indexOf(u))){var h=new XMLHttpRequest;return h.open("GET",u,!0),h.responseType="blob",h.onload=function(t){e(t.target.response,m,s)},setTimeout((function(){h.send()}),0),h}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(c)){if(!(c.length>2096103.424&&p!==f))return navigator.msSaveBlob?navigator.msSaveBlob(y(c),m):w(c);c=y(c),l=c.type||s}else if(/([\x80-\xff])/.test(c)){var b=0,g=new Uint8Array(c.length),v=g.length;for(b;b<v;++b)g[b]=c.charCodeAt(b);c=new p([g],{type:l})}function y(e){var t=e.split(/[:;,]/),n=t[1],o="base64"==t[2]?atob:decodeURIComponent,r=o(t.pop()),i=r.length,a=0,s=new Uint8Array(i);for(a;a<i;++a)s[a]=r.charCodeAt(a);return new p([s],{type:n})}function w(e,t){if("download"in d)return d.href=e,d.setAttribute("download",m),d.className="download-js-link",d.innerHTML="downloading...",d.style.display="none",document.body.appendChild(d),setTimeout((function(){d.click(),document.body.removeChild(d),!0===t&&setTimeout((function(){a.URL.revokeObjectURL(d.href)}),250)}),66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,s)),window.open(e)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=e),!0;var n=document.createElement("iframe");document.body.appendChild(n),!t&&/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,s)),n.src=e,setTimeout((function(){document.body.removeChild(n)}),333)}if(r=c instanceof p?c:new p([c],{type:l}),navigator.msSaveBlob)return navigator.msSaveBlob(r,m);if(a.URL)w(a.URL.createObjectURL(r),!0);else{if("string"===typeof r||r.constructor===f)try{return w("data:"+l+";base64,"+a.btoa(r))}catch(_){return w("data:"+l+","+encodeURIComponent(r))}i=new FileReader,i.onload=function(e){w(this.result)},i.readAsDataURL(r)}return!0}}))})),r={props:{type:{type:String,default:"xls"},data:{type:Array,required:!1,default:null},fields:{type:Object,default:()=>null},exportFields:{type:Object,default:()=>null},defaultValue:{type:String,required:!1,default:""},header:{default:null},footer:{default:null},name:{type:String,default:"data.xls"},fetch:{type:Function},meta:{type:Array,default:()=>[]},worksheet:{type:String,default:"Sheet1"},beforeGenerate:{type:Function},beforeFinish:{type:Function},escapeCsv:{type:Boolean,default:!0},stringifyLongNum:{type:Boolean,default:!1}},computed:{idName(){var e=(new Date).getTime();return"export_"+e},downloadFields(){return this.fields?this.fields:this.exportFields?this.exportFields:void 0}},methods:{async generate(){"function"===typeof this.beforeGenerate&&await this.beforeGenerate();let e=this.data;if("function"!==typeof this.fetch&&e||(e=await this.fetch()),!e||!e.length)return;let t=this.getProcessedJson(e,this.downloadFields);return"html"===this.type?this.export(this.jsonToXLS(t),this.name.replace(".xls",".html"),"text/html"):"csv"===this.type?this.export(this.jsonToCSV(t),this.name.replace(".xls",".csv"),"application/csv"):this.export(this.jsonToXLS(t),this.name,"application/vnd.ms-excel")},export:async function(e,t,n){let r=this.base64ToBlob(e,n);"function"===typeof this.beforeFinish&&await this.beforeFinish(),o(r,t,n)},jsonToXLS(e){let t='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta name=ProgId content=Excel.Sheet> <meta name=Generator content="Microsoft Excel 11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>${worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style>br {mso-data-placement: same-cell;}</style></head><body><table>${table}</table></body></html>',n="<thead>";const o=Object.keys(e[0]).length;let r=this;const i=this.header||this.$attrs.title;i&&(n+=this.parseExtraData(i,'<tr><th colspan="'+o+'">${data}</th></tr>')),n+="<tr>";for(let a in e[0])n+="<th>"+a+"</th>";return n+="</tr>",n+="</thead>",n+="<tbody>",e.map((function(e,t){n+="<tr>";for(let o in e)n+="<td>"+r.preprocessLongNum(r.valueReformattedForMultilines(e[o]))+"</td>";n+="</tr>"})),n+="</tbody>",null!=this.footer&&(n+="<tfoot>",n+=this.parseExtraData(this.footer,'<tr><td colspan="'+o+'">${data}</td></tr>'),n+="</tfoot>"),t.replace("${table}",n).replace("${worksheet}",this.worksheet)},jsonToCSV(e){let t=this;var n=[];const o=this.header||this.$attrs.title;o&&n.push(this.parseExtraData(o,"${data}\r\n"));for(let r in e[0])n.push(r),n.push(",");return n.pop(),n.push("\r\n"),e.map((function(e){for(let o in e){let r=e[o]+"";t.escapeCsv&&(r='="'+r+'"',r.match(/[,"\n]/)&&(r='"'+r.replace(/\"/g,'""')+'"')),n.push(r),n.push(",")}n.pop(),n.push("\r\n")})),null!=this.footer&&n.push(this.parseExtraData(this.footer,"${data}\r\n")),n.join("")},getProcessedJson(e,t){let n=this.getKeys(e,t),o=[],r=this;return e.map((function(e,t){let i={};for(let o in n){let t=n[o];i[o]=r.getValue(t,e)}o.push(i)})),o},getKeys(e,t){if(t)return t;let n={};for(let o in e[0])n[o]=o;return n},parseExtraData(e,t){let n="";if(Array.isArray(e))for(var o=0;o<e.length;o++)e[o]&&(n+=t.replace("${data}",e[o]));else n+=t.replace("${data}",e);return n},getValue(e,t){const n="object"!==typeof e?e:e.field;let o="string"!==typeof n?[]:n.split("."),r=this.defaultValue;return r=n?o.length>1?this.getValueFromNestedItem(t,o):this.parseValue(t[n]):t,e.hasOwnProperty("callback")&&(r=this.getValueFromCallback(r,e.callback)),r},valueReformattedForMultilines(e){return"string"==typeof e?e.replace(/\n/gi,"<br/>"):e},preprocessLongNum(e){if(this.stringifyLongNum){if(String(e).startsWith("0x"))return e;if(!isNaN(e)&&""!=e&&(e>99999999999||e<1e-13))return'="'+e+'"'}return e},getValueFromNestedItem(e,t){let n=e;for(let o of t)n&&(n=n[o]);return this.parseValue(n)},getValueFromCallback(e,t){if("function"!==typeof t)return this.defaultValue;const n=t(e);return this.parseValue(n)},parseValue(e){return e||0===e||"boolean"===typeof e?e:this.defaultValue},base64ToBlob(e,t){let n=window.btoa(window.unescape(encodeURIComponent(e))),o=atob(n),r=o.length,i=new Uint8ClampedArray(r);while(r--)i[r]=o.charCodeAt(r);return new Blob([i],{type:t})}}};function i(e,t,n,o,r,i,a,s,l,c){"boolean"!==typeof a&&(l=s,s=a,a=!1);var u,d="function"===typeof n?n.options:n;if(e&&e.render&&(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,r&&(d.functional=!0)),o&&(d._scopeId=o),i?(u=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,l(e)),e&&e._registeredComponents&&e._registeredComponents.add(i)},d._ssrRegister=u):t&&(u=a?function(){t.call(this,c(this.$root.$options.shadowRoot))}:function(e){t.call(this,s(e))}),u)if(d.functional){var f=d.render;d.render=function(e,t){return u.call(t),f(e,t)}}else{var p=d.beforeCreate;d.beforeCreate=p?[].concat(p,u):[u]}return n}var a=i;const s=r;var l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:e.idName},on:{click:e.generate}},[e._t("default",[e._v(" Download "+e._s(e.name)+" ")])],2)},c=[];l._withStripped=!0;const u=void 0,d=void 0,f=void 0,p=!1;var m=a({render:l,staticRenderFns:c},u,s,d,p,f,void 0,void 0);t["a"]=m}).call(this,n("c8ba"))}}]);
//# sourceMappingURL=chunk-5580d1d6.53743ec1.js.map