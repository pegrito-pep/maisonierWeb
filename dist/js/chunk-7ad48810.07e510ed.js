(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7ad48810"],{"0e80":function(t,a,e){"use strict";e.r(a);var o=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"container-fluid position-relative"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-12"},[e("div",{staticClass:"mb-2 clearfix"},[e("div",{staticClass:"collapse d-md-block display-options",attrs:{id:"displayOptions"}},[e("div",{staticClass:"d-block d-md-inline-block"},[e("SearchForm",{model:{value:t.search,callback:function(a){t.search=a},expression:"search"}})],1),e("div",{staticClass:"d-flex align-items-center justify-content-end"},[e("btnAdd",{directives:[{name:"b-modal",rawName:"v-b-modal.occupationForm",modifiers:{occupationForm:!0}}],attrs:{message:"Définir une occupation"}}),e("b-button-group",{staticClass:"mt-n1"},[e("b-button",{staticClass:"text-danger",attrs:{variant:"outline-light"},on:{click:function(a){return a.preventDefault(),t.goTo("prev")}}},[e("i",{staticClass:"fa fa-2x fa-chevron-left"})]),e("b-button",{staticClass:"text-danger",attrs:{variant:"outline-light"},on:{click:function(a){return a.preventDefault(),t.goTo("next")}}},[e("i",{staticClass:"fa fa-2x fa-chevron-right"})]),e("b-button",{staticClass:"text-danger",attrs:{variant:"outline-light"},on:{click:function(a){return a.preventDefault(),t.toogleList.apply(null,arguments)}}},[e("i",{staticClass:"fa fa-2x fa-list-alt",attrs:{id:"toogleList"}})])],1)],1)])]),e("div",{staticClass:"separator mb-20"}),e("b-overlay",{attrs:{show:t.showOverlay,rounded:"sm"}},[t.occupations.length?e("div",[e("occupation",{attrs:{occupation:t.occupation},on:{change:t.getOccupations}})],1):e("b-alert",{staticClass:"text-center",attrs:{variant:"info",show:""}},[e("i",{staticClass:"fa fa-exclamation-triangle fa-3x"}),t._v(" "),e("br"),e("span",{staticClass:"h4 d-inline-flex ml-2"},[t._v("Vous n'avez défini aucune occupation pour le moment")])])],1)],1),e("div",{staticClass:"occupations-sidenav py-2",attrs:{id:"mySidenav"}},[e("h5",{staticClass:"text-center text-white border-bottom py-1"},[t._v("Occupations disponibles")]),e("form",{staticClass:"container",attrs:{action:"",onSubmit:"return false"}},[e("b-form-input",{attrs:{placeholder:"Recherche..."},model:{value:t.search,callback:function(a){t.search=a},expression:"search"}})],1),e("b-container",{staticClass:"my-2",staticStyle:{height:"76%","overflow-y":"auto"}},[e("b-list-group",t._l(t.items,(function(a,o){return e("b-list-group-item",{key:a.idOccupation||o,staticClass:"mb-1 p-1",class:{active:a.idOccupation==t.occupation.idOccupation},on:{click:function(e){return e.preventDefault(),t.selectLogement(a)}}},[e("dl",{staticClass:"d-flex m-0"},[e("dt",{staticClass:"pl-1 col-1"},[e("i",{staticClass:"fa fa-home"})]),e("dd",{staticClass:"col-11 pl-1 truncate"},[t._v(t._s(a.logement.refLogement)+" / "),e("span",{staticClass:"text-muted small"},[t._v(t._s(a.logement.sousTypeLogement.libelleSousType))])])]),e("dl",{staticClass:"d-flex m-0"},[e("dt",{staticClass:"pl-1 col-1"},[e("i",{staticClass:"fa fa-user"})]),e("dd",{staticClass:"col-11 pl-1 truncate"},[t._v(t._s(a.locataire.titre+" "+a.locataire.nomLocataire+" "+a.locataire.prenomLocataire))])]),e("div",{staticClass:"text-center"},[null==a.dateFin?e("span",{staticClass:"small text-success"},[t._v("Bail en cours")]):e("span",{staticClass:"small text-danger"},[t._v("Bail terminé le "+t._s(t.$date(t.occupation.dateFin).format("DD MMMM YYYY")))])])])})),1)],1),e("div",{staticClass:"d-flex justify-content-center w-100"},[e("paginator",{attrs:{"no-control":"",offset:t.offset,total:t.occupations.length,limit:t.perPage,page:t.currentPage},on:{pageChanged:function(a){t.currentPage=a},limitChanged:function(a){t.perPage=a}}})],1)],1)]),e("b-modal",{ref:"occupation-form",attrs:{id:"occupationForm",size:"lg",title:t.title,"ok-title":"Fermer","ok-only":"","ok-variant":"secondary","no-close-on-backdrop":"","hide-header-close":""},scopedSlots:t._u([{key:"modal-title",fn:function(){return[e("span",{staticClass:"ml-4 text-form-occupation"},[t._v(t._s(t.title))])]},proxy:!0}])},[e("div",[e("occupation-form",{attrs:{action:t.action,provenance:t.provenance},on:{occupationAdded:t.addedOccupation,createLogementSecond:t.goToLogement,createLocataire:t.gotToLocataire}})],1)])],1)},s=[],i=e("278e"),c=e("14ff"),n=e("fb87");const l=e("5a6f");var r={name:"list-occupations",components:{OccupationForm:i["a"],Occupation:c["a"],SearchForm:n["a"]},data:()=>({title:"Affecter une occupation",action:"add",search:null,showOverlay:!0,currentPage:1,perPage:10,occupation:null,occupations:[],trueOccupations:[],provenance:1}),computed:{items(){return l.array_slice(this.occupations,this.offset,this.perPage)},offset(){return this.currentPage*this.perPage-this.perPage}},watch:{search(t){t=t.toLowerCase(),this.occupations=l.empty(t)?this.trueOccupations:this.trueOccupations.filter(a=>a.logement.refLogement.toLowerCase().includes(t)||(a.locataire.nomLocataire+" "+a.locataire.prenomLocataire).toLowerCase().includes(t))}},beforeMount(){this.getOccupations()},mounted(){setTimeout(()=>{$("#editLayoutItem").modal("hide")},100)},methods:{toogleList(){const t=$("#toogleList");t.hasClass("fa-list-alt")?t.removeClass("fa-list-alt").addClass("fa-times"):t.addClass("fa-list-alt").removeClass("fa-times"),$("#mySidenav").toggleClass("active")},goTo(t){const a=this.occupations.length;let e=this.occupations.findIndex(t=>t.idOccupation==this.occupation.idOccupation);"prev"==t?e--:e++,e>=a&&(e=0),e<0&&(e=a-1),this.selectLogement(this.occupations[e])},selectLogement(t){this.occupation=t;let a=window.location.href.split("/"),e=a[a.length-1];"occupations"==e?a.push(this.occupation.idOccupation):a[a.length-1]=this.occupation.idOccupation,window.history.pushState({},"",a.join("/")),$("#mySidenav").removeClass("active"),$("#toogleList").addClass("fa-list-alt").removeClass("fa-times")},autoDetailsTarget(){const t=this.$route.query.target||null;t&&(console.log("occupation n",t),window.history.pushState({},"","/"+t))},goToLogement(){this.$bvModal.hide("occupationForm"),setTimeout(()=>{this.$router.push({name:"logements",query:{target:"call-logement"}})},50)},gotToLocataire(){this.$bvModal.hide("occupationForm"),setTimeout(()=>{this.$router.push({name:"habitants",query:{target:"call-habitant"}})},50)},addedOccupation(){this.getOccupations(),this.$bvModal.hide("occupationForm")},getOccupations(){axios.get("occupations").then(t=>t.result||[]).then(t=>{this.occupations=this.trueOccupations=t;let a=t.findIndex(t=>t.idOccupation==this.$route.params.id);-1==a&&(a=0),this.occupation=t[a]||{},this.showOverlay=!1,this.autoDetailsTarget()})},updateOccupation(t){console.log("occupation",t)},removeOccupation(t){console.log("occupation",t)},showDetails(t){this.occupation=t,setTimeout(()=>{$("#editLayoutItem").modal("show"),$("#editLayoutItem").on("hide.bs.modal",t=>{this.occupation=null}),$("#editLayoutItem").on("hidden.bs.modal",t=>{this.occupation=null})},100)}}},u=r,d=(e("2f5c"),e("4555"),e("2877")),p=Object(d["a"])(u,o,s,!1,null,"56cc4a8a",null);a["default"]=p.exports},"2f5c":function(t,a,e){"use strict";e("3d2b")},"3d2b":function(t,a,e){},4555:function(t,a,e){"use strict";e("7ebc")},"7ebc":function(t,a,e){}}]);
//# sourceMappingURL=chunk-7ad48810.07e510ed.js.map