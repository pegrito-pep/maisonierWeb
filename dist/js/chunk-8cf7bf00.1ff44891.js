(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8cf7bf00"],{"3c60":function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("b-overlay",{attrs:{show:t.showOverlay,rounded:"sm"}},[i("div",{staticClass:"d-flex flex-column justify-content-between h-100"},[i("div",{style:null!=t.cite?"height: 73.5vh;":"",attrs:{id:t.repeaterId}},[i("div",{staticClass:"d-flex flex-column justify-content-between",staticStyle:{height:"95%","overflow-y":"auto","overflow-x":"hidden"}},[i("div",{attrs:{"data-repeater-list":"group"}},[i("b-row",{attrs:{"data-repeater-item":""}},[i("b-col",[i("b-form-group",{attrs:{label:"Nom du batiment"}},[i("b-form-input",{attrs:{name:"nom",placeholder:"Ex: Batiment A",trim:""},model:{value:t.nom,callback:function(e){t.nom=e},expression:"nom"}})],1),i("b-form-group",{attrs:{label:"Reference"}},[i("b-form-input",{attrs:{name:"ref",placeholder:"Ex: B1",trim:""},model:{value:t.ref,callback:function(e){t.ref=e},expression:"ref"}})],1),null==t.cite?i("b-form-group",{attrs:{label:"Photo"}},[i("img-inputer",{attrs:{"img-src":t.$getBase64(t.photo.batiment,!1),placeholder:"Ajouter la photo du batiment",theme:"light",size:"xl","bottom-text":"déposez le fichier ici ou cliquez pour modifier",icon:"img"},model:{value:t.photo.batiment,callback:function(e){t.$set(t.photo,"batiment",e)},expression:"photo.batiment"}})],1):t._e()],1),i("b-col",[null!=t.cite?i("b-form-group",{attrs:{label:"Photo"}},[i("img-inputer",{attrs:{name:"test",placeholder:"Ajouter la photo du batiment",theme:"light",size:"xl","bottom-text":"déposez le fichier ici ou cliquez pour modifier",icon:"img"}})],1):i("div",[i("b-form-group",{attrs:{label:"Cité"}},[i("v-select",{staticClass:"py-1",attrs:{options:t.cites,reduce:function(t){return t.idCite},label:"nomCite"},scopedSlots:t._u([{key:"option",fn:function(e){var a=e.nomCite,s=e.refCite,n=e.idCite;return[t._v(" "+t._s(a)+" "),i("br"),i("span",{staticClass:"text-muted"},[t._v(" "+t._s(-1!=n?"Reference: ":"")+t._s(s))]),-1==n?i("hr",{staticClass:"m-0 bg-danger",staticStyle:{"border-width":"1.5px"}}):t._e()]}}]),model:{value:t.idCite,callback:function(e){t.idCite=e},expression:"idCite"}})],1),i("b-carousel",{directives:[{name:"show",rawName:"v-show",value:-1!=t.idCite,expression:"idCite != -1"}],ref:"citeCarousel",attrs:{interval:0,controls:""},model:{value:t.selected_index_cite,callback:function(e){t.selected_index_cite=e},expression:"selected_index_cite"}},t._l(t.slideCites,(function(t,e){return i("b-carousel-slide",{key:e,staticClass:"fluid w-100 responsive border",staticStyle:{height:"20em"},attrs:{"img-src":t.image||"/img/bgCity.jpg"}})})),1),-1==t.idCite?i("div",[i("b-row",[i("b-col",[i("b-form-group",{attrs:{label:"Nom de la cité"}},[i("b-form-input",{attrs:{placeholder:"Ex: Cité de la joie",trim:""},model:{value:t.nomCite,callback:function(e){t.nomCite=e},expression:"nomCite"}})],1)],1),i("b-col",[i("b-form-group",{attrs:{label:"Reférence de la cité"}},[i("b-form-input",{attrs:{placeholder:"Ex: CDJ",trim:""},model:{value:t.refCite,callback:function(e){t.refCite=e},expression:"refCite"}})],1)],1)],1),i("b-form-group",{attrs:{label:"Photo"}},[i("img-inputer",{attrs:{"img-src":t.$getBase64(t.photo.cite,!1),placeholder:"Ajouter la photo de la cité",theme:"light",size:"xl","bottom-text":"déposez le fichier ici ou cliquez pour modifier",icon:"img"},model:{value:t.photo.cite,callback:function(e){t.$set(t.photo,"cite",e)},expression:"photo.cite"}})],1)],1):t._e()],1)],1),null!=t.cite?i("b-col",{staticClass:"m-0 p-0 mr-2",attrs:{cols:"1"}},[i("b-form-group",{attrs:{label:"Action"}},[i("b-button",{attrs:{"data-repeater-delete":"",variant:"outline-danger"}},[i("i",{staticClass:"fa fa-times"})])],1)],1):t._e()],1)],1)]),i("div",{staticClass:"w-100 d-flex justify-content-end align-items-center mt-4"},[null!=t.cite?i("b-button",{attrs:{variant:"outline-primary","data-repeater-create":""}},[t._v("Ajouter un élément")]):t._e(),i("b-button",{staticClass:"ml-2",attrs:{variant:"danger",disabled:t.submitted},on:{click:t.submitForm}},[t._v("Valider "),t.submitted?i("b-spinner",{attrs:{small:""}}):t._e()],1)],1)])])])},s=[];const n=i("5a6f");var o={data:()=>({submitted:!1,showOverlay:!0,cites:[],idCite:-1,nom:null,ref:null,nomCite:null,refCite:null,photo:{batiment:null,cite:null},selected_index_cite:null}),watch:{selected_index_cite(t){this.idCite=this.slideCites[t].idCite},idCite(t){this.setSlide_cite(t)}},props:{action:{type:String,default:"add"},batiment:{type:Object,default:null},cite:{type:Object,default:null}},computed:{repeaterId(){return"repeat-added-batiment-form-"+(n.empty(this.cite)?n.uniqid():this.cite.idCite)},slideCites(){return this.cites.filter(t=>-1!=t.idCite)}},created(){this.getCites()},mounted(){n.empty(this.cite)||(this.makeRepeater(),this.idCite=this.cite.idCite)},methods:{async getCites(){let t=storage.get("cites");n.empty(t)&&(t=await axios.get("cites").then(t=>t.result||[]),storage.set("cites",t,10)),this.cites=t||[],n.empty(this.batiment)?this.cites.unshift({nomCite:"Créer une nouvelle cité",refCite:"Ajout d'une cité inexistante",idCite:-1}):(this.nom=this.batiment.nomBatiment,this.ref=this.batiment.refBatiment,this.photo.batiment=this.batiment.image,this.idCite=this.batiment.idCite),this.showOverlay=!1},makeRepeater(){setTimeout(()=>{$("#"+this.repeaterId).repeater({isFirstItemUndeletable:!0})},500)},setSlide_cite(t){for(let e=0;e<this.slideCites.length;e++)if(this.slideCites[e].idCite==t&&!n.empty(this.$refs.citeCarousel)){this.$refs.citeCarousel.setSlide(e);break}},async submitForm(){if(n.empty(this.nom)||n.empty(this.ref)||n.empty(this.idCite))return App.error("Veuillez remplir le nom et la reference du batiment");if(-1==this.idCite&&(n.empty(this.nomCite)||n.empty(this.refCite)))return App.error("Veuillez entrer le nom et la reference de la cité");this.submitted=!0;let t={nom:this.nom,idCite:this.idCite,ref:this.ref,photo:await this.$getBase64(this.photo.batiment),batiments:[]};if("add"==this.action){if(-1==t.idCite)try{let e=await axios.post("cites",{nom:this.nomCite,ref:this.refCite,photo:await this.$getBase64(this.photo.cite)});t.idCite=e.result.idCite}catch(e){return App.alertError(e.message)}if(!n.empty(this.cite)){let t=$("#"+this.repeaterId).repeaterVal().group;return void console.log(t)}axios.post("batiments",t).then(t=>(this.$emit("batimentAdded",t.result),this.submitted=!1,App.notifySuccess(t.message))).catch(t=>(this.submitted=!1,App.notifyError(t.message)))}"edit"!=this.action||n.empty(this.batiment)||axios.put("batiments/"+this.batiment.idBatiment,t).then(e=>(this.$emit("batimentUpdated",{...t,idBatiment:this.batiment.idBatiment}),this.submitted=!1,App.notifySuccess(e.message))).catch(t=>(this.submitted=!1,App.notifyError(t.message)))}}},r=o,l=i("2877"),m=Object(l["a"])(r,a,s,!1,null,null,null);e["a"]=m.exports},"5c21":function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"shadow list-item list-item-grid"},[i("div",{staticClass:"card d-flex flex-row mb-3"},[i("a",{staticClass:"d-flex card-img",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.showDetails.apply(null,arguments)}}},[i("img",{staticClass:"list-thumbnail responsive border-0",staticStyle:{height:"10em"},attrs:{src:t.batiment.image||"/img/batiment.jpg",alt:""}}),t.isNew?i("span",{staticClass:"badge badge-pill badge-primary position-absolute badge-top-left"},[t._v("New")]):t._e()]),i("div",{staticClass:"d-flex flex-grow-1 min-width-zero card-content"},[i("div",{staticClass:"card-body align-self-center d-flex flex-column flex-md-row justify-content-between min-width-zero align-items-md-center"},[i("div",{staticClass:"text-center"},[i("h4",{staticClass:"text-red mt-0 truncate"},[t._v(t._s(t.batiment.nomBatiment))]),i("span",{staticClass:"d-inline-block text-muted"},[t._v("Reference: "),i("b",[t._v(t._s(t.batiment.refBatiment))])])]),t.isSub?i("p",{staticClass:"text-muted mt-3 mb-1 date w-15 w-xs-100 text-small"},[t._v(t._s(t.$date(t.batiment.createdAt).format("DD.MM.YYYY")))]):i("p",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.bottom",value:t.dateCreation,expression:"dateCreation",modifiers:{bottom:!0}}],staticClass:"mt-3 mb-1 text-muted text-small date w-15 w-xs-100"},[t._v(t._s(t.$date(t.batiment.createdAt).format("DD.MM.YYYY")))])]),i("div",{staticClass:"list-actions"},[t.isSub?t._e():i("a",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.bottom",value:"Détails",expression:"'Détails'",modifiers:{bottom:!0}}],attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.showDetails.apply(null,arguments)}}},[i("i",{staticClass:"ik ik-eye"})]),t.isSub?i("a",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.bottom",value:"Accéder aux détails",expression:"'Accéder aux détails'",modifiers:{bottom:!0}}],attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.accessTo.apply(null,arguments)}}},[i("i",{staticClass:"ik ik-link"})]):t._e(),t.isSub?t._e():i("a",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.bottom",value:"Editer",expression:"'Editer'",modifiers:{bottom:!0}}],attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.$emit("makeUpdate",t.batiment)}}},[i("i",{staticClass:"ik ik-edit-2"})]),i("a",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.bottom",value:"Supprimer",expression:"'Supprimer'",modifiers:{bottom:!0}}],staticClass:"list-delete",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.remove.apply(null,arguments)}}},[i("i",{staticClass:"ik ik-trash-2"})])])])])])},s=[],n={props:{batiment:{type:Object,required:!0},isSub:{type:Boolean,default:!1}},computed:{dateCreation(){const t=this.$date(this.batiment.createdAt);return`Créée le ${t.format("dddd, DD MMMM YYYY")} à ${t.format("HH:mm")}`},isNew(){return dayjs().diff(this.batiment.createdAt,"week")<=1}},methods:{showDetails(){if(this.isSub)return!1;this.$emit("showDetails",this.batiment)},accessTo(){$("#editLayoutItem").modal("hide"),this.$router.push({name:"batiments",query:{target:this.batiment.idBatiment}})},remove(){App.confirm(`Voullez vous vraiment supprimer le batiment " <b>${this.batiment.nomBatiment}</b> " ?`,{confirm:()=>{axios.delete("batiments/"+this.batiment.idBatiment).then(t=>t.success?(this.$emit("deleted",this.batiment.idBatiment),App.notifySuccess(t.message)):App.notifyError(t.message)).catch(t=>{App.notifyError(t.message)})}})}}},o=n,r=i("2877"),l=Object(r["a"])(o,a,s,!1,null,null,null);e["a"]=l.exports},"91d3":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("page-description",{attrs:{title:"Batiments",description:"Gestion de vos batiments",icon:"building",path:["Patrimoine immobilier","Mes batiments"]}}),i("div",{staticClass:"row"},[i("div",{staticClass:"col-md-12"},[i("div",{staticClass:"mb-2 clearfix"},[i("div",{staticClass:"collapse d-md-block display-options",attrs:{id:"displayOptions"}},[i("div",{staticClass:"d-block d-md-inline-block"},[i("div",{staticClass:"search-sm d-inline-block float-md-left mr-1 mb-1 align-top"},[i("form",{attrs:{action:"",onSubmit:"return false"}},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.search,expression:"search"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Recherche..."},domProps:{value:t.search},on:{input:function(e){e.target.composing||(t.search=e.target.value)}}}),t._m(0)])])]),i("div",{staticClass:"float-md-right"},[i("b-button",{attrs:{variant:"danger"},on:{click:function(e){return e.preventDefault(),function(){t.action="add",t.$bvModal.show("modal-batiment")}.apply(null,arguments)}}},[i("i",{staticClass:"fa fa-plus-circle"}),t._v(" Nouveau batiment")])],1)])]),i("div",{staticClass:"separator mb-20"}),i("b-overlay",{attrs:{show:t.showOverlay,rounded:"sm"}},[t.batiments.length?i("b-row",{staticClass:"layout-wrap"},t._l(t.items,(function(e,a){return i("b-col",{key:e.idBatiment||a,staticClass:"animated flipInX mb-4",attrs:{xl:"3",lg:"4",cols:"12",sm:"6"}},[i("batiment",{attrs:{batiment:e},on:{makeUpdate:t.updateBatiment,deleted:t.removeBatiment,showDetails:t.showDetails}})],1)})),1):i("b-alert",{staticClass:"text-center",attrs:{variant:"info",show:""}},[i("i",{staticClass:"fa fa-exclamation-triangle fa-3x"}),t._v(" "),i("br"),1==t.source?i("span",{staticClass:"h4 d-inline-flex ml-2"},[t._v("Aucun batiment enregistré pour le moment")]):t._e(),2==t.source?i("span",{staticClass:"h4 d-inline-flex ml-2"},[t._v("Aucun batiment trouvé")]):t._e()]),i("paginator",{attrs:{hr:"top",offset:t.offset,total:t.batiments.length,limit:t.perPage,page:t.currentPage},on:{pageChanged:function(e){t.currentPage=e},limitChanged:function(e){t.perPage=e}}})],1)],1)]),t.batiment?i("div",{staticClass:"modal fade edit-layout-modal",attrs:{id:"editLayoutItem",tabindex:"-1",role:"dialog","aria-labelledby":"editLayoutItemLabel","aria-hidden":"true"}},[i("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[i("div",{staticClass:"modal-content"},[i("div",{staticClass:"modal-header"},[i("h5",{staticClass:"modal-title",attrs:{id:"editLayoutItemLabel"}},[t._v("Détails du batiment : "),i("b",[t._v(t._s(t.batiment.nomBatiment))]),t._v(".")]),t._m(1)]),i("div",{staticClass:"modal-body pt-2"},[i("details-batiment",{attrs:{batiment:t.batiment},on:{logementsChanged:t.changeLogements}})],1)])])]):t._e(),i("b-modal",{ref:"modalBatiment",attrs:{id:"modal-batiment",size:"lg","hide-footer":""},on:{hidden:function(e){t.batiment=null}},scopedSlots:t._u([{key:"modal-title",fn:function(){return["add"==t.action?i("span",[t._v("Ajouter un batiment")]):t._e(),"edit"==t.action?i("span",[t._v("Edition du batiment")]):t._e()]},proxy:!0}])},[i("form-batiment",{attrs:{action:t.action,batiment:t.batiment},on:{batimentAdded:t.pushBatiment,batimentUpdated:t.editBatiment}})],1)],1)},s=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("button",{staticClass:"btn btn-icon",attrs:{type:"submit"}},[i("i",{staticClass:"ik ik-search"})])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[i("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])}],n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("ul",{staticClass:"nav nav-tabs"},[i("li",{staticClass:"nav-item"},[i("a",{staticClass:"nav-link",class:{active:"logements"==t.section},attrs:{"data-toggle":"tab",href:"#"},on:{click:function(e){e.preventDefault(),t.section="logements"}}},[t._v("Logements")])]),i("li",{staticClass:"nav-item"},[i("a",{staticClass:"nav-link",class:{active:"stats"==t.section},attrs:{"data-toggle":"tab",href:"#"},on:{click:function(e){e.preventDefault(),t.section="stats"}}},[t._v("Statistiques générales")])]),i("li",{staticClass:"nav-item"},[i("a",{staticClass:"nav-link",class:{active:"add-logement"==t.section},attrs:{"data-toggle":"tab",href:"#"},on:{click:function(e){e.preventDefault(),t.section="add-logement"}}},[t._v("Ajouter un logement")])]),i("li",{staticClass:"nav-item"},[i("a",{staticClass:"nav-link",class:{active:"depenses"==t.section},attrs:{"data-toggle":"tab",href:"#"},on:{click:function(e){e.preventDefault(),t.section="depenses"}}},[t._v("Dépenses liées au batiment")])]),i("li",{staticClass:"nav-item"},[i("a",{staticClass:"nav-link",class:{active:"add-depense"==t.section},attrs:{"data-toggle":"tab",href:"#"},on:{click:function(e){e.preventDefault(),t.section="add-depense"}}},[t._v("Ajouter une dépense")])])]),i("div",{staticClass:"tab-content mt-3"},[i("div",{staticClass:"tab-pane fade show active"},["stats"==t.section?i("div",{staticClass:"jumbotron pt-10 pb-10"},[i("h3",{staticClass:"m-0"},[t._v("Statistiques générales")]),i("p",[t._v("This is a simple hero unit, a simple jumbotron-style component for calling extra attention to featured content or information.")])]):t._e(),"logements"==t.section?i("div",[t.batiment.logements.length?i("div",{staticStyle:{height:"75vh"}},[i("paginator",{attrs:{"no-control":"",hr:"bottom",total:t.batiment.logements.length,limit:t.perPage,page:t.currentPage},on:{pageChanged:function(e){t.currentPage=e},limitChanged:function(e){t.perPage=e}}}),i("div",{staticStyle:{height:"90%","overflow-y":"auto","overflow-x":"hidden"}},[i("b-row",{staticClass:"layout-wrap"},t._l(t.items,(function(e,a){return i("b-col",{key:e.idLogement||a,attrs:{cols:"6"}},[i("logement",{attrs:{logement:e,"is-sub":""},on:{deleted:t.removeLogement}})],1)})),1)],1)],1):i("b-alert",{attrs:{variant:"info",show:""}},[i("i",{staticClass:"fa fa-exclamation-triangle fa-3x float-left"}),i("span",{staticClass:"h4 d-inline-flex ml-2"},[t._v("Aucun logement enregistré pour le moment")])])],1):t._e(),i("div",{directives:[{name:"show",rawName:"v-show",value:"add-logement"==t.section,expression:"section == 'add-logement'"}]},[i("add-logement",{attrs:{batiment:t.batiment,action:t.action},on:{logementAdded:t.addedLogement}})],1),"depenses"==t.section?i("div",[t.batiment.depenses.length?t._e():i("b-alert",{attrs:{variant:"info",show:""}},[i("i",{staticClass:"fa fa-exclamation-triangle fa-3x float-left"}),i("span",{staticClass:"h4 d-inline-flex ml-2"},[t._v("Aucune dépense enregistrée pour le moment")])]),t.batiment.depenses.length>0?i("div",{staticStyle:{height:"75vh"}},[i("b-row",[i("paginator",{attrs:{"no-control":"",hr:"bottom",total:t.batiment.depenses.length,limit:t.perPage,page:t.currentPage},on:{pageChanged:function(e){t.currentPage=e},limitChanged:function(e){t.perPage=e}}})],1),i("div",{staticStyle:{height:"90%","overflow-y":"auto","overflow-x":"hidden"}},[i("b-row",{staticClass:"layout-wrap"},t._l(t.itemsDepenses,(function(e,a){return i("b-col",{key:e.idDepense||a,attrs:{cols:"6"}},[i("depense",{attrs:{depense:e,source:t.source,"is-sub":""},on:{deleted:t.removeDepense}})],1)})),1)],1)],1):t._e()],1):t._e(),i("div",{directives:[{name:"show",rawName:"v-show",value:"add-depense"==t.section,expression:"section == 'add-depense'"}]},[i("depense-form",{attrs:{batiment:t.batiment,provenance:t.provenance},on:{depenseAdded:t.addedDepense}})],1)])])])},o=[],r=i("265a"),l=i("5ad6"),m=i("a474"),d=i("c0a6");const c=i("5a6f");var u={props:{batiment:{type:Object,required:!0}},components:{Logement:r["a"],Depense:l["a"],DepenseForm:m["a"],AddLogement:d["a"]},computed:{items(){return c.array_slice(this.batiment.logements,this.offset,this.perPage)},itemsDepenses(){return c.array_slice(this.batiment.depenses||[],this.offset,this.perPage)},offset(){return this.currentPage*this.perPage-this.perPage}},data:()=>({section:"logements",submitted:!1,commandeDepense:!1,action:"",currentPage:1,perPage:10,source:3,provenance:"2",action:"add"}),mounted(){},methods:{addedDepense(){axios.get(`batiments/${this.batiment.idBatiment}/depenses`).then(t=>t.result||[]).then(t=>{this.batiment.depenses=t,this.section="depenses"})},addedLogement(){axios.get(`batiments/${this.batiment.idBatiment}/logements`).then(t=>t.result||[]).then(t=>{this.batiment.logements=t,this.section="logements"})},pushDepense(t){this.batiment.depenses.unshift(t),this.commandeDepense=!1},removeLogement(t){this.batiment.logements=this.batiment.logements.filter(e=>e.idLogement!=t),this.$emit("logementsChanged",this.batiment.logements)},removeDepense(t){this.batiment.depenses=this.batiment.depenses.filter(e=>e.idDepense!=t),this.$emit("depensesChanged",this.batiment.depenses)},defineDepense(){this.action="add",this.commandeDepense=!0},onCloseSet(){this.commandeDepense=!1}}},h=u,p=i("2877"),b=Object(p["a"])(h,n,o,!1,null,null,null),f=b.exports,g=i("5c21"),v=i("3c60");const C=i("5a6f");var w={name:"Batiments",components:{DetailsBatiment:f,Batiment:g["a"],FormBatiment:v["a"]},computed:{items(){return C.array_slice(this.batiments,this.offset,this.perPage)},offset(){return this.currentPage*this.perPage-this.perPage}},data:()=>({batiments:[],trueBatiments:[],showOverlay:!0,batiment:null,currentPage:1,perPage:10,search:null,action:"add",source:1}),watch:{search(t){t=t.toLowerCase(),this.source=2,this.batiments=C.empty(t)?this.trueBatiments:this.trueBatiments.filter(e=>e.nomBatiment.toLowerCase().includes(t))}},mounted(){this.getBatiments()},methods:{async getBatiments(){try{this.batiments=this.trueBatiments=await axios.get("batiments").then(t=>t.result||[]),this.showOverlay=!1,this.autoDetailsTarget(),this.autoAddTarget()}catch(t){}},autoAddTarget(){const t=this.$route.query.target||null;t&&(this.$refs["modalBatiment"].show(),window.history.replaceState({},"",window.location.href.split("?")[0]))},autoDetailsTarget(){const t=this.$route.query.target||null;if(t){const e=this.trueBatiments.filter(e=>e.idBatiment==t)[0];e&&(this.showDetails(e),window.history.replaceState({},"",window.location.href.split("?")[0]))}},showDetails(t){this.batiment=t,setTimeout(()=>{$("#editLayoutItem").modal("show"),$("#editLayoutItem").on("hide.bs.modal",t=>{this.batiment=null}),$("#editLayoutItem").on("hidden.bs.modal",t=>{this.batiment=null})},100)},changeLogements(t){this.batiments=this.batiments.map(e=>e.idBatiment!=this.batiment.idBatiment?e:{...e,logements:t}),this.batiment.logements=t},removeBatiment(t){this.batiments=this.batiments.filter(e=>e.idBatiment!=t),this.trueBatiments=this.trueBatiments.filter(e=>e.idBatiment!=t)},pushBatiment(t){this.batiments=this.addNewBatiment(this.batiments,t),this.trueBatiments=this.addNewBatiment(this.trueBatiments,t),this.$bvModal.hide("modal-batiment")},editBatiment(t){this.batiments=this.renameBatiment(this.batiments,t),this.trueBatiments=this.renameBatiment(this.trueBatiments,t),this.$bvModal.hide("modal-batiment")},updateBatiment(t){this.action="edit",this.batiment=t,this.$bvModal.show("modal-batiment")},addNewBatiment(t,e){let i=!1;for(let a=0;a<t.length;a++)if(t[a].idBatiment==e.idBatiment){i=!0;break}return i||t.push(e),t},renameBatiment(t,e){return t.map(t=>(t.idBatiment==e.idBatiment&&(t.nomBatiment=e.nom,t.refBatiment=e.ref,t.image=e.photo,t.idCite=e.idCite),t))}}},y=w,_=Object(p["a"])(y,a,s,!1,null,null,null);e["default"]=_.exports}}]);
//# sourceMappingURL=chunk-8cf7bf00.1ff44891.js.map