{"version":3,"sources":["webpack:///./src/views/patrimoine/Cites.vue?0592","webpack:///./src/components/_patrimoine/FormBatiment.vue?73fc","webpack:///src/components/_patrimoine/FormBatiment.vue","webpack:///./src/components/_patrimoine/FormBatiment.vue?e4db","webpack:///./src/components/_patrimoine/FormBatiment.vue","webpack:///./src/components/_patrimoine/Batiment.vue?8ed5","webpack:///src/components/_patrimoine/Batiment.vue","webpack:///./src/components/_patrimoine/Batiment.vue?619b","webpack:///./src/components/_patrimoine/Batiment.vue","webpack:///./src/components/_patrimoine/FormBatiment.vue?8c1e","webpack:///./src/views/patrimoine/Cites.vue?974a","webpack:///./src/components/_patrimoine/Cite.vue?0b5f","webpack:///src/components/_patrimoine/Cite.vue","webpack:///./src/components/_patrimoine/Cite.vue?6a3a","webpack:///./src/components/_patrimoine/Cite.vue","webpack:///./src/components/_patrimoine/DetailsCite.vue?6485","webpack:///src/components/_patrimoine/DetailsCite.vue","webpack:///./src/components/_patrimoine/DetailsCite.vue?449e","webpack:///./src/components/_patrimoine/DetailsCite.vue","webpack:///src/views/patrimoine/Cites.vue","webpack:///./src/views/patrimoine/Cites.vue?cb7c","webpack:///./src/views/patrimoine/Cites.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","showOverlay","staticClass","style","cite","repeaterId","staticStyle","model","value","callback","$$v","nom","expression","ref","photo","batiment","on","$event","preventDefault","$refs","photoBatiment","click","onFileSelected","_e","cites","idCite","scopedSlots","_u","key","fn","nomCite","refCite","_v","_s","directives","name","rawName","selected_index_cite","_l","i","image","photoCite","submitted","submitForm","staticRenderFns","php","data","watch","slideCites","setSlide_cite","props","action","type","String","default","Object","computed","empty","uniqid","filter","elt","getCites","makeRepeater","methods","storage","get","axios","then","response","result","set","unshift","nomBatiment","refBatiment","setTimeout","$","repeater","isFirstItemUndeletable","index","length","citeCarousel","setSlide","target","file","files","reader","FileReader","onload","readAsDataURL","App","error","batiments","post","alertError","message","repeaterVal","group","$emit","notifySuccess","catch","notifyError","put","idBatiment","component","showDetails","apply","arguments","$date","createdAt","format","modifiers","isSub","accessTo","remove","required","Boolean","day","dayjs","diff","modal","$router","push","query","confirm","delete","success","domProps","composing","search","_m","$bvModal","show","updateCite","removeCite","offset","perPage","currentPage","page","limit","changeBatiments","resetModal","submitModal","proxy","ok","$set","class","section","removeBatiment","pushBatiment","depenses","depense","idDepense","source","removeDepense","provenance","addedDepense","components","Batiment","Depense","DepenseForm","FormBatiment","array_slice","notif","commandeDepense","AppCite","DetailsCite","trueCites","toLowerCase","includes","getCities","autoAddTarget","modalCite","event","$route","showModal","window","history","replaceState","location","href","split","e","map","bvModalEvt","addNewCite","hide","renameCite","exist"],"mappings":"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","file":"js/chunk-c839794e.c767a350.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Cites.vue?vue&type=style&index=0&id=f2c782c4&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('b-overlay',{attrs:{\"show\":_vm.showOverlay,\"rounded\":\"sm\"}},[_c('div',{staticClass:\"d-flex flex-column justify-content-between h-100\"},[_c('div',{style:(_vm.cite != null ? 'height: 73.5vh;' : ''),attrs:{\"id\":_vm.repeaterId}},[_c('div',{staticClass:\"d-flex flex-column justify-content-between\",staticStyle:{\"height\":\"95%\",\"overflow-y\":\"auto\",\"overflow-x\":\"hidden\"}},[_c('div',{attrs:{\"data-repeater-list\":\"group\"}},[_c('b-row',{attrs:{\"data-repeater-item\":\"\"}},[_c('b-col',[_c('b-form-group',{attrs:{\"label\":\"Nom du batiment\"}},[_c('b-form-input',{attrs:{\"name\":\"nom\",\"placeholder\":\"Ex: Batiment A\",\"trim\":\"\"},model:{value:(_vm.nom),callback:function ($$v) {_vm.nom=$$v},expression:\"nom\"}})],1),_c('b-form-group',{attrs:{\"label\":\"Reference\"}},[_c('b-form-input',{attrs:{\"name\":\"ref\",\"placeholder\":\"Ex: B1\",\"trim\":\"\"},model:{value:(_vm.ref),callback:function ($$v) {_vm.ref=$$v},expression:\"ref\"}})],1),(_vm.cite == null)?_c('b-form-group',{attrs:{\"label\":\"Photo\"}},[_c('div',{staticClass:\"photo-cite d-flex justify-content-center align-items-center border rounded-circle mx-auto\",style:('background-image: url('+_vm.photo.batiment+');')},[_c('b-button',{staticClass:\"btn-icon\",attrs:{\"variant\":\"light\"},on:{\"click\":function($event){$event.preventDefault();return _vm.$refs.photoBatiment.click()}}},[_c('i',{staticClass:\"fa fa-camera-retro fa-lg text-muted\"})]),_c('input',{ref:\"photoBatiment\",staticClass:\"d-none\",attrs:{\"type\":\"file\",\"name\":\"photoBatiment\"},on:{\"change\":_vm.onFileSelected}})],1)]):_vm._e()],1),_c('b-col',[(_vm.cite != null)?_c('b-form-group',{attrs:{\"label\":\"Photo\"}},[_c('div',{staticClass:\"photo-cite d-flex justify-content-center align-items-center border rounded-circle mx-auto\",style:('background-image: url('+_vm.photo.batiment+');')},[_c('b-button',{staticClass:\"btn-icon\",attrs:{\"variant\":\"light\"},on:{\"click\":function($event){$event.preventDefault();return _vm.$refs.photoBatiment.click()}}},[_c('i',{staticClass:\"fa fa-camera-retro fa-lg text-muted\"})]),_c('input',{ref:\"photoBatiment\",staticClass:\"d-none\",attrs:{\"type\":\"file\",\"name\":\"photoBatiment\"},on:{\"change\":_vm.onFileSelected}})],1)]):_c('div',[_c('b-form-group',{attrs:{\"label\":\"Cité\"}},[_c('v-select',{staticClass:\"py-1\",attrs:{\"options\":_vm.cites,\"reduce\":function (cite) { return cite.idCite; },\"label\":\"nomCite\"},scopedSlots:_vm._u([{key:\"option\",fn:function(ref){\nvar nomCite = ref.nomCite;\nvar refCite = ref.refCite;\nvar idCite = ref.idCite;\nreturn [_vm._v(\" \"+_vm._s(nomCite)+\" \"),_c('br'),_c('span',{staticClass:\"text-muted\"},[_vm._v(\" \"+_vm._s(idCite != -1 ? 'Reference: ' : '')+_vm._s(refCite))]),(idCite == -1)?_c('hr',{staticClass:\"m-0 bg-danger\",staticStyle:{\"border-width\":\"1.5px\"}}):_vm._e()]}}]),model:{value:(_vm.idCite),callback:function ($$v) {_vm.idCite=$$v},expression:\"idCite\"}})],1),_c('b-carousel',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.idCite != -1),expression:\"idCite != -1\"}],ref:\"citeCarousel\",attrs:{\"interval\":0,\"controls\":\"\"},model:{value:(_vm.selected_index_cite),callback:function ($$v) {_vm.selected_index_cite=$$v},expression:\"selected_index_cite\"}},_vm._l((_vm.slideCites),function(cite,i){return _c('b-carousel-slide',{key:i,staticClass:\"fluid w-100 responsive border\",staticStyle:{\"height\":\"20em\"},attrs:{\"img-src\":cite.image || '/img/bgCity.jpg'}})}),1),(_vm.idCite == -1)?_c('div',[_c('b-row',[_c('b-col',[_c('b-form-group',{attrs:{\"label\":\"Nom de la cité\"}},[_c('b-form-input',{attrs:{\"placeholder\":\"Ex: Cité de la joie\",\"trim\":\"\"},model:{value:(_vm.nomCite),callback:function ($$v) {_vm.nomCite=$$v},expression:\"nomCite\"}})],1)],1),_c('b-col',[_c('b-form-group',{attrs:{\"label\":\"Reférence de la cité\"}},[_c('b-form-input',{attrs:{\"placeholder\":\"Ex: CDJ\",\"trim\":\"\"},model:{value:(_vm.refCite),callback:function ($$v) {_vm.refCite=$$v},expression:\"refCite\"}})],1)],1)],1),_c('b-form-group',{attrs:{\"label\":\"Photo\"}},[_c('div',{staticClass:\"photo-cite d-flex justify-content-center align-items-center border rounded-circle mx-auto\",style:('background-image: url('+_vm.photo.cite+');')},[_c('b-button',{staticClass:\"btn-icon\",attrs:{\"variant\":\"light\"},on:{\"click\":function($event){$event.preventDefault();return _vm.$refs.photoCite.click()}}},[_c('i',{staticClass:\"fa fa-camera-retro fa-lg text-muted\"})]),_c('input',{ref:\"photoCite\",staticClass:\"d-none\",attrs:{\"type\":\"file\",\"name\":\"photoCite\"},on:{\"change\":_vm.onFileSelected}})],1)])],1):_vm._e()],1)],1),(_vm.cite != null)?_c('b-col',{staticClass:\"m-0 p-0 mr-2\",attrs:{\"cols\":\"1\"}},[_c('b-form-group',{attrs:{\"label\":\"Action\"}},[_c('b-button',{attrs:{\"data-repeater-delete\":\"\",\"variant\":\"outline-danger\"}},[_c('i',{staticClass:\"fa fa-times\"})])],1)],1):_vm._e()],1)],1)]),_c('div',{staticClass:\"w-100 d-flex justify-content-end align-items-center mt-4\"},[(null != _vm.cite)?_c('b-button',{attrs:{\"variant\":\"outline-primary\",\"data-repeater-create\":\"\"}},[_vm._v(\"Ajouter un élément\")]):_vm._e(),_c('b-button',{staticClass:\"ml-2\",attrs:{\"variant\":\"danger\",\"disabled\":_vm.submitted},on:{\"click\":_vm.submitForm}},[_vm._v(\"Valider \"),(_vm.submitted)?_c('b-spinner',{attrs:{\"small\":\"\"}}):_vm._e()],1)],1)])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <b-overlay :show=\"showOverlay\" rounded=\"sm\"><div class=\"d-flex flex-column justify-content-between h-100\">\r\n        <div :id=\"repeaterId\"  :style=\"cite != null ? 'height: 73.5vh;' : ''\">\r\n            <div class=\"d-flex flex-column justify-content-between\" style=\"height: 95%; overflow-y: auto; overflow-x: hidden\"><div data-repeater-list=\"group\">\r\n                <b-row data-repeater-item>\r\n                    <b-col>\r\n                        <b-form-group label=\"Nom du batiment\">\r\n                            <b-form-input name=\"nom\" v-model=\"nom\" placeholder=\"Ex: Batiment A\" trim></b-form-input>\r\n                        </b-form-group>\r\n                        <b-form-group label=\"Reference\">\r\n                            <b-form-input name=\"ref\" v-model=\"ref\" placeholder=\"Ex: B1\" trim></b-form-input>\r\n                        </b-form-group>\r\n                        <b-form-group v-if=\"cite == null\" label=\"Photo\">\r\n                            <div class=\"photo-cite d-flex justify-content-center align-items-center border rounded-circle mx-auto\" :style=\"'background-image: url('+photo.batiment+');'\" >\r\n                                <b-button variant=\"light\" @click.prevent=\"$refs.photoBatiment.click()\" class=\"btn-icon\"><i class=\"fa fa-camera-retro fa-lg text-muted\"></i></b-button>\r\n                                <input type=\"file\" class=\"d-none\" name=\"photoBatiment\" ref=\"photoBatiment\" @change=\"onFileSelected\">\r\n                            </div>\r\n                        </b-form-group>\r\n                    </b-col> \r\n\r\n                    <b-col>\r\n                        <b-form-group v-if=\"cite != null\" label=\"Photo\">\r\n                            <div class=\"photo-cite d-flex justify-content-center align-items-center border rounded-circle mx-auto\" :style=\"'background-image: url('+photo.batiment+');'\" >\r\n                                <b-button variant=\"light\" @click.prevent=\"$refs.photoBatiment.click()\" class=\"btn-icon\"><i class=\"fa fa-camera-retro fa-lg text-muted\"></i></b-button>\r\n                                <input type=\"file\" class=\"d-none\" name=\"photoBatiment\" ref=\"photoBatiment\" @change=\"onFileSelected\">\r\n                            </div>\r\n                        </b-form-group>\r\n                        <div v-else>\r\n                            <b-form-group label=\"Cité\">\r\n                                <v-select class=\"py-1\" :options=\"cites\" v-model=\"idCite\" :reduce=\"cite => cite.idCite\" label=\"nomCite\">\r\n                                    <template #option=\"{ nomCite, refCite, idCite }\">\r\n                                        {{ nomCite }}\r\n                                        <br />\r\n                                        <span class=\"text-muted\"> {{ idCite != -1 ? 'Reference: ' : ''}}{{ refCite }}</span>\r\n                                        <hr class=\"m-0 bg-danger\" v-if=\"idCite == -1\" style=\"border-width: 1.5px\">\r\n                                    </template>\r\n                                </v-select>\r\n                            </b-form-group>\r\n                            <b-carousel v-show=\"idCite != -1\" :interval=\"0\" controls v-model=\"selected_index_cite\" ref=\"citeCarousel\">\r\n                                <b-carousel-slide style=\"height: 20em\" v-for=\"(cite, i) in slideCites\" :key=\"i\" :img-src=\"cite.image || '/img/bgCity.jpg'\" class=\"fluid w-100 responsive border\"/>\r\n                            </b-carousel>\r\n                            <div v-if=\"idCite == -1\">\r\n                                <b-row>\r\n                                    <b-col><b-form-group label=\"Nom de la cité\">\r\n                                        <b-form-input v-model=\"nomCite\" placeholder=\"Ex: Cité de la joie\" trim />\r\n                                    </b-form-group></b-col>\r\n                                    <b-col><b-form-group label=\"Reférence de la cité\">\r\n                                        <b-form-input v-model=\"refCite\" placeholder=\"Ex: CDJ\" trim />\r\n                                    </b-form-group></b-col>\r\n                                </b-row>\r\n                                <b-form-group label=\"Photo\">\r\n                                    <div class=\"photo-cite d-flex justify-content-center align-items-center border rounded-circle mx-auto\" :style=\"'background-image: url('+photo.cite+');'\" >\r\n                                        <b-button variant=\"light\" @click.prevent=\"$refs.photoCite.click()\" class=\"btn-icon\"><i class=\"fa fa-camera-retro fa-lg text-muted\"></i></b-button>\r\n                                        <input type=\"file\" class=\"d-none\" name=\"photoCite\" ref=\"photoCite\" @change=\"onFileSelected\">\r\n                                    </div>\r\n                                </b-form-group>\r\n                            </div>\r\n                        </div>\r\n                    </b-col>\r\n                    <b-col cols=\"1\" class=\"m-0 p-0 mr-2\" v-if=\"cite != null\"><b-form-group label=\"Action\">\r\n                        <b-button data-repeater-delete variant=\"outline-danger\"><i class=\"fa fa-times\"></i></b-button>\r\n                    </b-form-group></b-col>   \r\n                </b-row>   \r\n            </div></div>\r\n\r\n            <div class=\"w-100 d-flex justify-content-end align-items-center mt-4\">\r\n                <b-button v-if=\"null != cite\" variant=\"outline-primary\" data-repeater-create>Ajouter un élément</b-button>\r\n                <b-button variant=\"danger\" @click=\"submitForm\" class=\"ml-2\" :disabled=\"submitted\">Valider <b-spinner v-if=\"submitted\" small /></b-button>    \r\n            </div>\r\n        </div> \r\n    </div></b-overlay>\r\n</template>\r\n\r\n<script>\r\nconst php = require('phpjs')\r\n\r\nexport default {\r\n    data: () => ({\r\n        submitted: false,\r\n        showOverlay: true,\r\n\r\n        cites: [],\r\n        idCite: -1,\r\n        nom: null,\r\n        ref: null,\r\n        nomCite: null,\r\n        refCite: null,\r\n        photo: { batiment: null, cite: null },\r\n        selected_index_cite: null\r\n    }),\r\n    watch: {\r\n        selected_index_cite(value) {\r\n            this.idCite = this.slideCites[value].idCite\r\n        },\r\n        idCite(value) {\r\n            this.setSlide_cite(value)\r\n        }\r\n    },\r\n    props: {\r\n        action: {type: String, default: 'add'},\r\n        batiment: {type: Object, default: null},\r\n        cite: {type: Object, default: null},\r\n    },\r\n    computed: {\r\n        repeaterId() {\r\n            return `repeat-added-batiment-form-${php.empty(this.cite) ? php.uniqid() : this.cite.idCite}`\r\n        },\r\n        slideCites() {\r\n            return this.cites.filter(elt => elt.idCite != -1)\r\n        }\r\n    },\r\n    created() {\r\n        this.getCites()\r\n    },\r\n    mounted() {\r\n        if (!php.empty(this.cite)) {\r\n            this.makeRepeater()\r\n            this.idCite = this.cite.idCite\r\n        }\r\n    },\r\n\r\n    methods: {\r\n        async getCites() {\r\n            let cites = storage.get('cites')\r\n            if (php.empty(cites)) {\r\n                cites = await axios.get('cites').then(response => response.result || [])\r\n                storage.set('cites', cites, 10)\r\n            }\r\n            this.cites = cites || []\r\n            \r\n            if (!php.empty(this.batiment)) {\r\n                this.nom = this.batiment.nomBatiment\r\n                this.ref = this.batiment.refBatiment\r\n                this.photo.batiment = this.batiment.image\r\n                this.idCite = this.batiment.idCite\r\n            }\r\n            else {\r\n                this.cites.unshift({\r\n                    nomCite: 'Créer une nouvelle cité', refCite: 'Ajout d\\'une cité inexistante', idCite: -1\r\n                })\r\n            }\r\n            this.showOverlay = false\r\n        },\r\n\r\n        makeRepeater() {\r\n            setTimeout(() => {\r\n                $(`#${this.repeaterId}`).repeater({ isFirstItemUndeletable: true  })\r\n            }, 500);\r\n        },\r\n\r\n        /**\r\n        * Set l'image du carousel lorsqu'on change le logement\r\n        */\r\n        setSlide_cite(value) {\r\n            for (let index = 0; index < this.slideCites.length; index++) {\r\n                if (this.slideCites[index].idCite == value && !php.empty(this.$refs.citeCarousel)) {\r\n                    this.$refs.citeCarousel.setSlide(index);\r\n                    break;\r\n                }\r\n            }\r\n        },\r\n        /**\r\n         * Selection de l'image illustrative de la cite\r\n         */\r\n        onFileSelected({target}) {\r\n            let file = target.files[0],\r\n                reader = new FileReader(),\r\n                name = target.name,\r\n                photo = this.photo\r\n\r\n            reader.onload = function() {\r\n                if (name == 'photoCite') {\r\n                    photo.cite = this.result\r\n                }\r\n                else {\r\n                    photo.batiment = this.result\r\n                }\r\n            }\r\n            reader.readAsDataURL(file)\r\n        },\r\n\r\n        /**\r\n         * Validation du formulaire d'ajout/modification du batiment\r\n         */\r\n        async submitForm() {\r\n            if (php.empty(this.nom) || php.empty(this.ref) || php.empty(this.idCite)) {\r\n                return App.error('Veuillez remplir le nom et la reference du batiment')\r\n            }\r\n            \r\n            if (this.idCite == -1 && (php.empty(this.nomCite) || php.empty(this.refCite))) {\r\n                return App.error('Veuillez entrer le nom et la reference de la cité')\r\n            }\r\n\r\n            this.submitted = true \r\n\r\n            let data = {\r\n                nom: this.nom, \r\n                idCite: this.idCite, \r\n                ref: this.ref, \r\n                photo: this.photo.batiment,\r\n                batiments: []\r\n            }\r\n\r\n            if (this.action == 'add') {\r\n                if (data.idCite == -1) {\r\n                    try {\r\n                        let response = await axios.post('cites', {nom: this.nomCite, ref: this.refCite, photo: this.photo.cite})\r\n                        data.idCite = response.result.idCite\r\n                    } catch (error) {\r\n                        return App.alertError(error.message)\r\n                    }\r\n                }\r\n                if (!php.empty(this.cite)) {\r\n                    let batiments = $(`#${this.repeaterId}`).repeaterVal().group\r\n                    if (php.empty(batiments[0].nom) || php.empty(batiments[0].ref)) {\r\n                        return App.error('Vous devez remplir au moins les informations du premier batiment')\r\n                    }\r\n                    data.batiments = batiments\r\n                }\r\n                \r\n                axios.post('batiments', data).then(response => {\r\n                    this.$emit('batimentAdded', response.result)\r\n                    this.submitted = false\r\n                    return App.notifySuccess(response.message)\r\n                }).catch(error => {\r\n                    this.submitted = false\r\n                    return App.notifyError(error.message)\r\n                })\r\n            }\r\n\r\n            if (this.action == 'edit' && !php.empty(this.batiment)) {\r\n                axios.put(`batiments/${this.batiment.idBatiment}`, data).then(response => {\r\n                    this.$emit('batimentUpdated', {...data, idBatiment: this.batiment.idBatiment})\r\n                    this.submitted = false\r\n                    return App.notifySuccess(response.message)\r\n                }).catch(error => {\r\n                    this.submitted = false\r\n                    return App.notifyError(error.message)\r\n                })\r\n            }\r\n        },\r\n        \r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.photo-cite {\r\n    width: 10.5em;\r\n    height: 10.5em;\r\n    background-size: cover;\r\n}\r\n.photo-cite button {\r\n    cursor: pointer;\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FormBatiment.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FormBatiment.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./FormBatiment.vue?vue&type=template&id=abf9e20e&scoped=true&\"\nimport script from \"./FormBatiment.vue?vue&type=script&lang=js&\"\nexport * from \"./FormBatiment.vue?vue&type=script&lang=js&\"\nimport style0 from \"./FormBatiment.vue?vue&type=style&index=0&id=abf9e20e&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"abf9e20e\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"shadow list-item list-item-grid\"},[_c('div',{staticClass:\"card d-flex flex-row mb-3\"},[_c('a',{staticClass:\"d-flex card-img\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.showDetails.apply(null, arguments)}}},[_c('img',{staticClass:\"list-thumbnail responsive border-0\",staticStyle:{\"height\":\"10em\"},attrs:{\"src\":_vm.batiment.image || '/img/batiment.jpg',\"alt\":\"\"}}),(_vm.isNew)?_c('span',{staticClass:\"badge badge-pill badge-primary position-absolute badge-top-left\"},[_vm._v(\"New\")]):_vm._e()]),_c('div',{staticClass:\"d-flex flex-grow-1 min-width-zero card-content\"},[_c('div',{staticClass:\"card-body align-self-center d-flex flex-column flex-md-row justify-content-between min-width-zero align-items-md-center\"},[_c('div',{staticClass:\"text-center\"},[_c('h4',{staticClass:\"text-red mt-0 truncate\"},[_vm._v(_vm._s(_vm.batiment.nomBatiment))]),_c('span',{staticClass:\"d-inline-block text-muted\"},[_vm._v(\"Reference: \"),_c('b',[_vm._v(_vm._s(_vm.batiment.refBatiment))])])]),(_vm.isSub)?_c('p',{staticClass:\"text-muted mt-3 mb-1 date w-15 w-xs-100 text-small\"},[_vm._v(_vm._s(_vm.$date(_vm.batiment.createdAt).format(\"DD.MM.YYYY\")))]):_c('p',{directives:[{name:\"b-tooltip\",rawName:\"v-b-tooltip.bottom\",value:(_vm.dateCreation),expression:\"dateCreation\",modifiers:{\"bottom\":true}}],staticClass:\"mt-3 mb-1 text-muted text-small date w-15 w-xs-100\"},[_vm._v(_vm._s(_vm.$date(_vm.batiment.createdAt).format(\"DD.MM.YYYY\")))])]),_c('div',{staticClass:\"list-actions\"},[(!_vm.isSub)?_c('a',{attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.showDetails.apply(null, arguments)}}},[_c('i',{staticClass:\"ik ik-eye\"})]):_vm._e(),(_vm.isSub)?_c('a',{attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.accessTo.apply(null, arguments)}}},[_c('i',{staticClass:\"ik ik-link\"})]):_vm._e(),(!_vm.isSub)?_c('a',{attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.$emit('makeUpdate', _vm.batiment)}}},[_c('i',{staticClass:\"ik ik-edit-2\"})]):_vm._e(),_c('a',{staticClass:\"list-delete\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.remove.apply(null, arguments)}}},[_c('i',{staticClass:\"ik ik-trash-2\"})])])])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div class=\"shadow list-item list-item-grid\">\r\n        <div class=\"card d-flex flex-row mb-3\">\r\n            <a class=\"d-flex card-img\" @click.prevent=\"showDetails\" href=\"#\">\r\n                <img :src=\"batiment.image || '/img/batiment.jpg'\" alt=\"\" style=\"height: 10em\" class=\"list-thumbnail responsive border-0\">\r\n                <span v-if=\"isNew\" class=\"badge badge-pill badge-primary position-absolute badge-top-left\">New</span>\r\n            </a>\r\n            <div class=\"d-flex flex-grow-1 min-width-zero card-content\">\r\n                <div class=\"card-body align-self-center d-flex flex-column flex-md-row justify-content-between min-width-zero align-items-md-center\">\r\n                    <div class=\"text-center\">\r\n                        <h4 class=\"text-red mt-0 truncate\">{{ batiment.nomBatiment }}</h4>\r\n                        <span class=\"d-inline-block text-muted\">Reference: <b>{{ batiment.refBatiment }}</b></span>\r\n                    </div>\r\n                    <p v-if=\"isSub\" class=\"text-muted mt-3 mb-1 date w-15 w-xs-100 text-small\">{{ $date(batiment.createdAt).format(\"DD.MM.YYYY\") }}</p>\r\n                    <p v-else v-b-tooltip.bottom=\"dateCreation\" class=\"mt-3 mb-1 text-muted text-small date w-15 w-xs-100\">{{ $date(batiment.createdAt).format(\"DD.MM.YYYY\") }}</p>\r\n                </div>\r\n                <div class=\"list-actions\">\r\n                    <a href=\"#\" @click.prevent=\"showDetails\" v-if=\"!isSub\"><i class=\"ik ik-eye\"></i></a>\r\n                    <a href=\"#\" @click.prevent=\"accessTo\" v-if=\"isSub\"><i class=\"ik ik-link\"></i></a>\r\n                    <a href=\"#\" @click.prevent=\"$emit('makeUpdate', batiment)\" v-if=\"!isSub\" ><i class=\"ik ik-edit-2\"></i></a>\r\n                    <a href=\"#\" @click.prevent=\"remove\" class=\"list-delete\"><i class=\"ik ik-trash-2\"></i></a>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n    props: {\r\n        batiment: { type: Object, required: true },\r\n        isSub: {type: Boolean, default: false}\r\n    },\r\n    computed: {\r\n        dateCreation() {\r\n            const day = this.$date(this.batiment.createdAt)\r\n            return `Créée le ${day.format(\"dddd, DD MMMM YYYY\")} à ${day.format(\"HH:mm\")}`\r\n        },\r\n        /**\r\n         * Verifie si c'est une cité nouvellement ajoutée\r\n         */\r\n        isNew() {\r\n            return dayjs().diff(this.batiment.createdAt, 'week') <= 1\r\n        }\r\n    },\r\n    methods: {\r\n        /**\r\n         * Affiche la modale avec les details de l'element\r\n         */\r\n        showDetails() {\r\n            if (this.isSub) {\r\n                return false\r\n            }\r\n            this.$emit('showDetails', this.batiment)\r\n        },\r\n        /**\r\n         * Acces rapide aux details de l'element\r\n         */\r\n        accessTo() {\r\n            $('#editLayoutItem').modal('hide')\r\n            this.$router.push({name: 'batiments', query: {target: this.batiment.idBatiment}})\r\n        },\r\n        /**\r\n         * Suppression du batiment\r\n         */\r\n        remove() {\r\n            App.confirm(`Voullez vous vraiment supprimer le batiment \" <b>${this.batiment.nomBatiment}</b> \" ?`, { confirm: () => {\r\n                axios.delete(`batiments/${this.batiment.idBatiment}`).then(response => {\r\n                    if (!response.success) {\r\n                        return App.notifyError(response.message)\r\n                    }\r\n                    this.$emit('deleted', this.batiment.idBatiment)\r\n                    return App.notifySuccess(response.message)\r\n                }).catch(error => {\r\n                    App.notifyError(error.message)\r\n                })\r\n            }})\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style>\r\n\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Batiment.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Batiment.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Batiment.vue?vue&type=template&id=5cdd72e8&\"\nimport script from \"./Batiment.vue?vue&type=script&lang=js&\"\nexport * from \"./Batiment.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FormBatiment.vue?vue&type=style&index=0&id=abf9e20e&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('page-description',{attrs:{\"title\":\"Cités\",\"description\":\"Gestion de vos cités\",\"icon\":\"city\",\"path\":['Patrimoine immobilier', 'Mes cités']}}),_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"col-md-12\"},[_c('div',{staticClass:\"mb-2 clearfix\"},[_c('div',{staticClass:\"collapse d-md-block display-options\",attrs:{\"id\":\"displayOptions\"}},[_c('div',{staticClass:\"d-block d-md-inline-block\"},[_c('div',{staticClass:\"search-sm d-inline-block float-md-left mr-1 mb-1 align-top\"},[_c('form',{attrs:{\"action\":\"\",\"onSubmit\":\"return false\"}},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.search),expression:\"search\"}],staticClass:\"form-control\",attrs:{\"type\":\"text\",\"placeholder\":\"Recherche...\"},domProps:{\"value\":(_vm.search)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.search=$event.target.value}}}),_vm._m(0)])])]),_c('div',{staticClass:\"float-md-right\"},[_c('b-button',{attrs:{\"variant\":\"danger\"},on:{\"click\":function($event){$event.preventDefault();return (function () {_vm.modal.action = 'add'; _vm.$bvModal.show('modal-cite')}).apply(null, arguments)}}},[_c('i',{staticClass:\"fa fa-plus-circle\"}),_vm._v(\" Nouvelle cité\")])],1)])]),_c('div',{staticClass:\"separator mb-20\"}),_c('b-overlay',{attrs:{\"show\":_vm.showOverlay,\"rounded\":\"sm\"}},[(!_vm.cites.length)?_c('b-alert',{staticClass:\"text-center\",attrs:{\"variant\":\"info\",\"show\":\"\"}},[_c('i',{staticClass:\"fa fa-exclamation-triangle fa-3x\"}),_vm._v(\" \"),_c('br'),_c('span',{staticClass:\"h4 d-inline-flex ml-2\"},[_vm._v(\"Aucune cité trouvée\")])]):_c('b-row',{staticClass:\"layout-wrap\"},_vm._l((_vm.items),function(cite,i){return _c('b-col',{key:cite.idCite || i,staticClass:\"animated flipInX mb-4\",attrs:{\"xl\":\"3\",\"lg\":\"4\",\"cols\":\"12\",\"sm\":\"6\"}},[_c('app-cite',{attrs:{\"cite\":cite},on:{\"makeUpdate\":_vm.updateCite,\"deleted\":_vm.removeCite,\"showDetails\":_vm.showDetails}})],1)}),1),_c('paginator',{attrs:{\"hr\":\"top\",\"offset\":_vm.offset,\"total\":_vm.cites.length,\"limit\":_vm.perPage,\"page\":_vm.currentPage},on:{\"pageChanged\":function (page) {_vm.currentPage = page},\"limitChanged\":function (limit) {_vm.perPage = limit}}})],1)],1)]),(_vm.cite)?_c('div',{staticClass:\"modal fade edit-layout-modal\",attrs:{\"id\":\"editLayoutItem\",\"tabindex\":\"-1\",\"role\":\"dialog\",\"aria-labelledby\":\"editLayoutItemLabel\",\"aria-hidden\":\"true\"}},[_c('div',{staticClass:\"modal-dialog\",attrs:{\"role\":\"document\"}},[_c('div',{staticClass:\"modal-content\"},[_c('div',{staticClass:\"modal-header\"},[_c('h5',{staticClass:\"modal-title\",attrs:{\"id\":\"editLayoutItemLabel\"}},[_vm._v(\"Détails de la cité : \"),_c('b',[_vm._v(_vm._s(_vm.cite.nomCite))]),_vm._v(\".\")]),_vm._m(1)]),_c('div',{staticClass:\"modal-body pt-2\"},[_c('details-cite',{attrs:{\"cite\":_vm.cite},on:{\"batimentsChanged\":_vm.changeBatiments}})],1)])])]):_vm._e(),_c('b-modal',{ref:\"modalCite\",attrs:{\"id\":\"modal-cite\",\"size\":\"sm\"},on:{\"hidden\":_vm.resetModal,\"ok\":_vm.submitModal},scopedSlots:_vm._u([{key:\"modal-title\",fn:function(){return [(_vm.modal.action == 'add')?_c('span',[_vm._v(\"Ajouter une cité\")]):_vm._e(),(_vm.modal.action == 'edit')?_c('span',[_vm._v(\"Edition de la cité\")]):_vm._e()]},proxy:true},{key:\"modal-footer\",fn:function(ref){\nvar ok = ref.ok;\nreturn [_c('b-button',{attrs:{\"size\":\"sm\",\"variant\":\"danger\",\"disabled\":_vm.modal.submitted},on:{\"click\":function($event){return ok()}}},[_vm._v(\"Valider \"),(_vm.modal.submitted)?_c('b-spinner',{attrs:{\"small\":\"\"}}):_vm._e()],1)]}}])},[_c('b-form-group',{attrs:{\"label\":\"Nom de la cité\"}},[_c('b-form-input',{attrs:{\"placeholder\":\"Ex: Cité de la paix\",\"trim\":\"\"},model:{value:(_vm.modal.nom),callback:function ($$v) {_vm.$set(_vm.modal, \"nom\", $$v)},expression:\"modal.nom\"}})],1),_c('b-form-group',{attrs:{\"label\":\"Reference\"}},[_c('b-form-input',{attrs:{\"placeholder\":\"Ex: CP3\",\"trim\":\"\"},model:{value:(_vm.modal.ref),callback:function ($$v) {_vm.$set(_vm.modal, \"ref\", $$v)},expression:\"modal.ref\"}})],1),_c('b-form-group',{attrs:{\"label\":\"Photo\"}},[_c('div',{staticClass:\"photo-cite d-flex justify-content-center align-items-center border rounded-circle mx-auto\",style:('background-image: url('+_vm.modal.photo+');')},[_c('b-button',{staticClass:\"btn-icon\",attrs:{\"variant\":\"light\"},on:{\"click\":function($event){$event.preventDefault();return _vm.$refs.photoCite.click()}}},[_c('i',{staticClass:\"fa fa-camera-retro fa-lg text-muted\"})]),_c('input',{ref:\"photoCite\",staticClass:\"d-none\",attrs:{\"type\":\"file\"},on:{\"change\":_vm.onFileSelected}})],1)])],1)],1)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('button',{staticClass:\"btn btn-icon\",attrs:{\"type\":\"submit\"}},[_c('i',{staticClass:\"ik ik-search\"})])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('button',{staticClass:\"close\",attrs:{\"type\":\"button\",\"data-dismiss\":\"modal\",\"aria-label\":\"Close\"}},[_c('span',{attrs:{\"aria-hidden\":\"true\"}},[_vm._v(\"×\")])])}]\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\" list-item list-item-grid\"},[_c('div',{staticClass:\"card d-flex flex-row mb-3\"},[_c('a',{staticClass:\"d-flex card-img\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.showDetails.apply(null, arguments)}}},[_c('img',{staticClass:\"list-thumbnail responsive border-0\",staticStyle:{\"height\":\"10em\"},attrs:{\"src\":_vm.cite.image || '/img/bgCity.jpg',\"alt\":\"\"}}),(_vm.isNew)?_c('span',{staticClass:\"badge badge-pill badge-primary position-absolute badge-top-left\"},[_vm._v(\"New\")]):_vm._e()]),_c('div',{staticClass:\"d-flex flex-grow-1 min-width-zero card-content\"},[_c('div',{staticClass:\"card-body align-self-center d-flex flex-column flex-md-row justify-content-between min-width-zero align-items-md-center\"},[_c('div',{staticClass:\"text-center\"},[_c('h4',{staticClass:\"text-red mt-0 truncate\"},[_vm._v(_vm._s(_vm.cite.nomCite))]),_c('span',{staticClass:\"d-inline-block text-muted\"},[_vm._v(\"Reference: \"),_c('b',[_vm._v(_vm._s(_vm.cite.refCite))])])]),_c('p',{directives:[{name:\"b-tooltip\",rawName:\"v-b-tooltip.bottom\",value:(_vm.dateCreation),expression:\"dateCreation\",modifiers:{\"bottom\":true}}],staticClass:\"mt-3 mb-1 text-muted text-small date w-15 w-xs-100\"},[_vm._v(_vm._s(_vm.$date(_vm.cite.createdAt).format(\"DD.MM.YYYY\")))])]),_c('div',{staticClass:\"list-actions\"},[_c('a',{attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.showDetails.apply(null, arguments)}}},[_c('i',{staticClass:\"ik ik-eye\"})]),_c('a',{attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.$emit('makeUpdate', _vm.cite)}}},[_c('i',{staticClass:\"ik ik-edit-2\"})]),_c('a',{staticClass:\"list-delete\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.remove.apply(null, arguments)}}},[_c('i',{staticClass:\"ik ik-trash-2\"})])])])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div class=\" list-item list-item-grid\">\r\n        <div class=\"card d-flex flex-row mb-3\">\r\n            <a class=\"d-flex card-img\" @click.prevent=\"showDetails\" href=\"#\">\r\n                <img :src=\"cite.image || '/img/bgCity.jpg'\" alt=\"\" style=\"height: 10em\" class=\"list-thumbnail responsive border-0\">\r\n                <span v-if=\"isNew\" class=\"badge badge-pill badge-primary position-absolute badge-top-left\">New</span>\r\n            </a>\r\n            <div class=\"d-flex flex-grow-1 min-width-zero card-content\">\r\n                <div class=\"card-body align-self-center d-flex flex-column flex-md-row justify-content-between min-width-zero align-items-md-center\">\r\n                    <div class=\"text-center\">\r\n                        <h4 class=\"text-red mt-0 truncate\">{{ cite.nomCite }}</h4>\r\n                        <span class=\"d-inline-block text-muted\">Reference: <b>{{ cite.refCite }}</b></span>\r\n                    </div>\r\n                    <p v-b-tooltip.bottom=\"dateCreation\" class=\"mt-3 mb-1 text-muted text-small date w-15 w-xs-100\">{{ $date(cite.createdAt).format(\"DD.MM.YYYY\") }}</p>\r\n                </div>\r\n                <div class=\"list-actions\">\r\n                    <a href=\"#\" @click.prevent=\"showDetails\"><i class=\"ik ik-eye\"></i></a>\r\n                    <a href=\"#\" @click.prevent=\"$emit('makeUpdate', cite)\"><i class=\"ik ik-edit-2\"></i></a>\r\n                    <a href=\"#\" @click.prevent=\"remove\" class=\"list-delete\"><i class=\"ik ik-trash-2\"></i></a>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n    props: {\r\n        cite: { type: Object, required: true },\r\n        isSub: {type: Boolean, default: false}\r\n    },\r\n    computed: {\r\n        dateCreation() {\r\n            const day = this.$date(this.cite.createdAt)\r\n            return `Créée le ${day.format(\"dddd, DD MMMM YYYY\")} à ${day.format(\"HH:mm\")}`\r\n        },\r\n        /**\r\n         * Verifie si c'est une cité nouvellement ajoutée\r\n         */\r\n        isNew() {\r\n            return dayjs().diff(this.cite.createdAt, 'hour') <= 1\r\n        }\r\n    },\r\n    methods: {\r\n        /**\r\n         * Affiche la modale avec les details de l'element\r\n         */\r\n        showDetails() {\r\n            if (this.isSub) {\r\n                return false\r\n            }\r\n            this.$emit('showDetails', this.cite)\r\n        },\r\n        /**\r\n         * Suppression du cité\r\n         */\r\n        remove() {\r\n            App.confirm(`Voullez vous vraiment supprimer la cité \" <b>${this.cite.nomCite}</b> \" ?`, { confirm: () => {\r\n                axios.delete(`cites/${this.cite.idCite}`).then(response => {\r\n                    if (!response.success) {\r\n                        return App.notifyError(response.message)\r\n                    }\r\n                    this.$emit('deleted', this.cite.idCite)\r\n                    return App.notifySuccess(response.message)\r\n                })\r\n            }})\r\n        }\r\n    }\r\n}\r\n</script>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Cite.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Cite.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Cite.vue?vue&type=template&id=10a8b1c8&\"\nimport script from \"./Cite.vue?vue&type=script&lang=js&\"\nexport * from \"./Cite.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('ul',{staticClass:\"nav nav-tabs\"},[_c('li',{staticClass:\"nav-item\"},[_c('a',{staticClass:\"nav-link\",class:{'active' : _vm.section == 'batiments'},attrs:{\"data-toggle\":\"tab\",\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();_vm.section = 'batiments'}}},[_vm._v(\"Batiments\")])]),_c('li',{staticClass:\"nav-item\"},[_c('a',{staticClass:\"nav-link\",class:{'active' : _vm.section == 'stats'},attrs:{\"data-toggle\":\"tab\",\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();_vm.section = 'stats'}}},[_vm._v(\"Statistiques générales\")])]),_c('li',{staticClass:\"nav-item\"},[_c('a',{staticClass:\"nav-link\",class:{'active' : _vm.section == 'add-batiments'},attrs:{\"data-toggle\":\"tab\",\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();_vm.section = 'add-batiments'}}},[_vm._v(\"Ajouter des bâtiments\")])]),_c('li',{staticClass:\"nav-item\"},[_c('a',{staticClass:\"nav-link\",class:{'active' : _vm.section == 'depenses'},attrs:{\"data-toggle\":\"tab\",\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();_vm.section = 'depenses'}}},[_vm._v(\"Dépenses liées à la cité\")])]),_c('li',{staticClass:\"nav-item\"},[_c('a',{staticClass:\"nav-link\",class:{'active' : _vm.section == 'add-depense'},attrs:{\"data-toggle\":\"tab\",\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();_vm.section = 'add-depense'}}},[_vm._v(\"Ajouter une dépense\")])])]),_c('div',{staticClass:\"tab-content mt-3\"},[_c('div',{staticClass:\"tab-pane fade show active\"},[(_vm.section == 'stats')?_c('div',{staticClass:\"jumbotron pt-10 pb-10\"},[_c('h3',{staticClass:\"m-0\"},[_vm._v(\"Statistiques générales\")]),_c('p',[_vm._v(\"This is a simple hero unit, a simple jumbotron-style component for calling extra attention to featured content or information.\")])]):_vm._e(),(_vm.section == 'batiments')?_c('div',[(!_vm.cite.batiments.length)?_c('b-alert',{attrs:{\"variant\":\"info\",\"show\":\"\"}},[_c('i',{staticClass:\"fa fa-exclamation-triangle fa-3x float-left\"}),_c('span',{staticClass:\"h4 d-inline-flex ml-2\"},[_vm._v(\"Aucun bâtiment enregistré pour le moment\")])]):_c('div',{staticStyle:{\"height\":\"75vh\"}},[_c('paginator',{attrs:{\"no-control\":\"\",\"hr\":\"bottom\",\"total\":_vm.cite.batiments.length,\"limit\":_vm.perPage,\"page\":_vm.currentPage},on:{\"pageChanged\":function (page) {_vm.currentPage = page},\"limitChanged\":function (limit) {_vm.perPage = limit}}}),_c('div',{staticStyle:{\"height\":\"90%\",\"overflow-y\":\"auto\",\"overflow-x\":\"hidden\"}},[_c('b-row',{staticClass:\"layout-wrap\"},_vm._l((_vm.items),function(batiment,i){return _c('b-col',{key:batiment.idBatiment || i,attrs:{\"cols\":\"6\"}},[_c('batiment',{attrs:{\"batiment\":batiment,\"is-sub\":\"\"},on:{\"deleted\":_vm.removeBatiment}})],1)}),1)],1)],1)],1):_vm._e(),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.section == 'add-batiments'),expression:\"section == 'add-batiments'\"}]},[_c('form-batiment',{attrs:{\"cite\":_vm.cite},on:{\"batimentAdded\":_vm.pushBatiment}})],1),(_vm.section == 'depenses')?_c('div',[(!_vm.cite.depenses.length)?_c('b-alert',{attrs:{\"variant\":\"info\",\"show\":\"\"}},[_c('i',{staticClass:\"fa fa-exclamation-triangle fa-3x float-left\"}),_c('span',{staticClass:\"h4 d-inline-flex ml-2\"},[_vm._v(\"Aucune dépense enregistrée pour le moment\")])]):_vm._e(),(_vm.cite.depenses.length>0)?_c('div',{staticStyle:{\"height\":\"75vh\"}},[_c('b-row',[_c('paginator',{attrs:{\"no-control\":\"\",\"hr\":\"bottom\",\"total\":_vm.cite.depenses.length,\"limit\":_vm.perPage,\"page\":_vm.currentPage},on:{\"pageChanged\":function (page) {_vm.currentPage = page},\"limitChanged\":function (limit) {_vm.perPage = limit}}})],1),_c('div',{staticStyle:{\"height\":\"90%\",\"overflow-y\":\"auto\",\"overflow-x\":\"hidden\"}},[_c('b-row',{staticClass:\"layout-wrap\"},_vm._l((_vm.itemsDepenses),function(depense,i){return _c('b-col',{key:depense.idDepense || i,attrs:{\"cols\":\"6\"}},[_c('depense',{attrs:{\"depense\":depense,\"source\":_vm.source,\"is-sub\":\"\"},on:{\"deleted\":_vm.removeDepense}})],1)}),1)],1)],1):_vm._e()],1):_vm._e(),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.section == 'add-depense'),expression:\"section == 'add-depense'\"}]},[_c('depense-form',{attrs:{\"cite\":_vm.cite,\"provenance\":_vm.provenance},on:{\"depenseAdded\":_vm.addedDepense}})],1)])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div>\r\n        <ul class=\"nav nav-tabs\">\r\n            <li class=\"nav-item\"><a data-toggle=\"tab\" href=\"#\" class=\"nav-link\" :class=\"{'active' : section == 'batiments'}\" @click.prevent=\"section = 'batiments'\">Batiments</a></li>\r\n            <li class=\"nav-item\"><a data-toggle=\"tab\" href=\"#\" class=\"nav-link\" :class=\"{'active' : section == 'stats'}\" @click.prevent=\"section = 'stats'\">Statistiques générales</a></li>\r\n            <li class=\"nav-item\"><a data-toggle=\"tab\" href=\"#\" class=\"nav-link\" :class=\"{'active' : section == 'add-batiments'}\" @click.prevent=\"section = 'add-batiments'\">Ajouter des bâtiments</a></li>\r\n            <li class=\"nav-item\"><a data-toggle=\"tab\" href=\"#\" class=\"nav-link\" :class=\"{'active' : section == 'depenses'}\" @click.prevent=\"section = 'depenses'\">Dépenses liées à la cité</a></li>\r\n             <li class=\"nav-item\"><a data-toggle=\"tab\" href=\"#\" class=\"nav-link\" :class=\"{'active' : section == 'add-depense'}\" @click.prevent=\"section = 'add-depense'\">Ajouter une dépense</a></li>\r\n        </ul>\r\n        <div class=\"tab-content mt-3\">\r\n            <div class=\"tab-pane fade show active\">\r\n                <div v-if=\"section == 'stats'\" class=\"jumbotron pt-10 pb-10\">\r\n                    <h3 class=\"m-0\">Statistiques générales</h3>\r\n                    <p>This is a simple hero unit, a simple jumbotron-style component for calling extra attention to featured content or information.</p>\r\n                </div>\r\n                <div v-if=\"section == 'batiments'\">\r\n                    <b-alert variant=\"info\" show v-if=\"!cite.batiments.length\">\r\n                        <i class=\"fa fa-exclamation-triangle fa-3x float-left\"></i> \r\n                        <span class=\"h4 d-inline-flex ml-2\">Aucun bâtiment enregistré pour le moment</span>\r\n                    </b-alert>   \r\n                    <div v-else style=\"height: 75vh;\">\r\n                        <paginator no-control hr=\"bottom\" :total=\"cite.batiments.length\" :limit=\"perPage\" :page=\"currentPage\" @pageChanged=\"(page) => {currentPage = page}\" @limitChanged=\"(limit) => {perPage = limit}\" />                   \r\n                        <div style=\"height: 90%; overflow-y: auto; overflow-x: hidden\">\r\n                            <b-row class=\"layout-wrap\">\r\n                                <b-col v-for=\"(batiment, i) in items\" :key=\"batiment.idBatiment || i\" cols=\"6\">\r\n                                    <batiment @deleted=\"removeBatiment\" :batiment=\"batiment\" is-sub />\r\n                                </b-col>\r\n                            </b-row>    \r\n                        </div> \r\n                    </div>       \r\n                </div> \r\n                <div v-show=\"section == 'add-batiments'\">\r\n                    <form-batiment :cite=\"cite\" @batimentAdded=\"pushBatiment\"  />\r\n                </div>\r\n                <div v-if=\"section == 'depenses'\">\r\n                    <b-alert variant=\"info\" show v-if=\"!cite.depenses.length\">\r\n                        <i class=\"fa fa-exclamation-triangle fa-3x float-left\"></i> \r\n                        <span class=\"h4 d-inline-flex ml-2\">Aucune dépense enregistrée pour le moment</span>\r\n                    </b-alert>   \r\n                    <div v-if=\"cite.depenses.length>0\" style=\"height: 75vh;\">\r\n                        <b-row>\r\n                            <paginator no-control hr=\"bottom\" :total=\"cite.depenses.length\" :limit=\"perPage\" :page=\"currentPage\" @pageChanged=\"(page) => {currentPage = page}\" @limitChanged=\"(limit) => {perPage = limit}\" />   \r\n                        </b-row>   \r\n                        <!--<paginator no-control hr=\"bottom\" :total=\"cite.depenses.length\" :limit=\"perPage\" :page=\"currentPage\" @pageChanged=\"(page) => {currentPage = page}\" @limitChanged=\"(limit) => {perPage = limit}\" />-->                   \r\n                        <div style=\"height: 90%; overflow-y: auto; overflow-x: hidden\">\r\n                            <b-row class=\"layout-wrap\">\r\n                                <b-col v-for=\"(depense, i) in itemsDepenses\" :key=\"depense.idDepense || i\" cols=\"6\">\r\n                                    <depense @deleted=\"removeDepense\" :depense=\"depense\" :source=\"source\" is-sub />\r\n                                </b-col>\r\n                            </b-row>    \r\n                        </div> \r\n                    </div>  \r\n                </div> \r\n                 <div v-show=\"section == 'add-depense'\">\r\n                    <depense-form :cite=\"cite\"  @depenseAdded=\"addedDepense\" :provenance=\"provenance\"/>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport Batiment from '@/components/_patrimoine/Batiment.vue'\r\nimport Depense from \"@/views/gestion-immobiliere/depenses/Depense.vue\";\r\nimport DepenseForm from \"@/views/gestion-immobiliere/depenses/DepenseForm.vue\";\r\nimport FormBatiment from './FormBatiment.vue';\r\nconst php = require('phpjs')\r\n\r\nexport default {\r\n    props: {\r\n        cite: {type: Object, required: true}\r\n    },\r\n    components: {\r\n        Batiment,\r\n        Depense,\r\n        DepenseForm,\r\n        FormBatiment\r\n    },\r\n    computed: {\r\n        /**\r\n         * Elements affichés avec prise en charge de la pagination\r\n         */\r\n        items() {\r\n            return php.array_slice(this.cite.batiments || [], this.offset, this.perPage)\r\n        },\r\n        itemsDepenses(){\r\n             return php.array_slice(this.cite.depenses || [], this.offset, this.perPage)\r\n        },\r\n        offset() {\r\n            return (this.currentPage * this.perPage) - this.perPage\r\n        }\r\n    },\r\n    data: () => ({\r\n        section: 'add-batiments',\r\n        submitted: false,\r\n\r\n        currentPage: 1,\r\n        perPage: 10,\r\n        source:1,\r\n        provenance:\"2\",\r\n        \r\n        //données manipulées pour l'ajout d'une dépense\r\n        action:\"\"\r\n    }),\r\n   mounted() {\r\n        this.section =  'batiments'\r\n        this.makeRepeater()\r\n    },\r\n    methods: {\r\n         /**\r\n         * réponse à l'évènement d'ajout d'une dépense\r\n         * dans le détail de la cité, la réponse consiste juste à mettre à jour la liste des dépenses de la cité\r\n         */\r\n         addedDepense() {\r\n            axios.get(`cites/${this.cite.idCite}/depenses`).then(response => response.result || []).then(depenses => {\r\n                this.cite.depenses = depenses\r\n                this.section = 'depenses'\r\n            })\r\n        },\r\n\r\n        pushBatiment(batiments) {\r\n            this.cite.batiments.push(...batiments)\r\n            this.$emit('batimentsChanged', this.cite.batiments)\r\n            this.section = 'batiments'\r\n            if (!batiments.length) {\r\n                return App.notif('Aucun batiment rajouté', {})\r\n            }\r\n        },\r\n        /**\r\n         * Retire un batiment\r\n         */\r\n        removeBatiment(idBatiment) {\r\n            this.cite.batiments = this.cite.batiments.filter(elt => elt.idBatiment != idBatiment)\r\n            this.$emit('batimentsChanged', this.cite.batiments)\r\n        },\r\n         /**\r\n         * supprimer une dépense\r\n         * ceci à pour but de  la marquer comme traitée en back\r\n         */\r\n        removeDepense(idDepense) {\r\n            this.cite.depenses = this.cite.depenses.filter(elt => elt.idDepense != idDepense)\r\n            this.$emit('depensesChanged', this.cite.depenses)\r\n        },\r\n        /**\r\n         *traitement de l'appel à l'ajout d'une dépense dans le détail de la cité\r\n         */\r\n        defineDepense(){\r\n            this.action=\"add\",\r\n            this.commandeDepense=true;\r\n        },\r\n        onCloseSet() {\r\n            this.commandeDepense = false;\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style>\r\n\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DetailsCite.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DetailsCite.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./DetailsCite.vue?vue&type=template&id=04c086e0&\"\nimport script from \"./DetailsCite.vue?vue&type=script&lang=js&\"\nexport * from \"./DetailsCite.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\r\n    <div>\r\n        <page-description title=\"Cités\" description=\"Gestion de vos cités\" icon=\"city\" :path=\"['Patrimoine immobilier', 'Mes cités']\" />\r\n        <div class=\"row\">\r\n            <div class=\"col-md-12\">\r\n                <div class=\"mb-2 clearfix\">\r\n                    <div class=\"collapse d-md-block display-options\" id=\"displayOptions\">               \r\n                        <div class=\"d-block d-md-inline-block\">\r\n                            <div class=\"search-sm d-inline-block float-md-left mr-1 mb-1 align-top\">\r\n                                <form action=\"\" onSubmit=\"return false\">\r\n                                    <input type=\"text\" class=\"form-control\" placeholder=\"Recherche...\" v-model=\"search\">\r\n                                    <button type=\"submit\" class=\"btn btn-icon\"><i class=\"ik ik-search\"></i></button>\r\n                                </form>\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"float-md-right\">\r\n                            <b-button variant=\"danger\" @click.prevent=\"() => {modal.action = 'add'; $bvModal.show('modal-cite')}\"><i class=\"fa fa-plus-circle\"></i> Nouvelle cité</b-button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"separator mb-20\"></div>\r\n                <b-overlay :show=\"showOverlay\" rounded=\"sm\">\r\n                    <b-alert variant=\"info\" class=\"text-center\" show v-if=\"!cites.length\">\r\n                        <i class=\"fa fa-exclamation-triangle fa-3x\"></i> <br>\r\n                        <span class=\"h4 d-inline-flex ml-2\">Aucune cité trouvée</span>\r\n                    </b-alert> \r\n                    <b-row v-else class=\"layout-wrap\">\r\n                        <b-col v-for=\"(cite, i) in items\" :key=\"cite.idCite || i\" xl=\"3\" lg=\"4\" cols=\"12\" sm=\"6\" class=\"animated flipInX mb-4\">\r\n                            <app-cite @makeUpdate=\"updateCite\" @deleted=\"removeCite\" :cite=\"cite\" @showDetails=\"showDetails\" />\r\n                        </b-col>\r\n                    </b-row>\r\n                    <paginator hr=\"top\" :offset=\"offset\" :total=\"cites.length\" :limit=\"perPage\" :page=\"currentPage\" @pageChanged=\"(page) => {currentPage = page}\" @limitChanged=\"(limit) => {perPage = limit}\" />                   \r\n                </b-overlay>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- MODALE POUR AFFICHER LES DETAILS D'UNE CITE -->\r\n        <div v-if=\"cite\" class=\"modal fade edit-layout-modal\" id=\"editLayoutItem\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"editLayoutItemLabel\" aria-hidden=\"true\">\r\n            <div class=\"modal-dialog\" role=\"document\">\r\n                <div class=\"modal-content\">\r\n                    <div class=\"modal-header\">\r\n                        <h5 class=\"modal-title\" id=\"editLayoutItemLabel\">Détails de la cité : <b>{{ cite.nomCite }}</b>.</h5>\r\n                        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>\r\n                    </div>\r\n                    <div class=\"modal-body pt-2\">\r\n                        <details-cite @batimentsChanged=\"changeBatiments\" :cite=\"cite\" />\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- MODALE POUR AJOUTER/MODIFIER UNE CITE -->\r\n        <b-modal id=\"modal-cite\" size=\"sm\" @hidden=\"resetModal\" @ok=\"submitModal\" ref=\"modalCite\">\r\n            <template #modal-title>\r\n                <span v-if=\"modal.action == 'add'\">Ajouter une cité</span>\r\n                <span v-if=\"modal.action == 'edit'\">Edition de la cité</span>\r\n            </template>\r\n            <template #modal-footer=\"{ ok }\">\r\n                <b-button size=\"sm\" variant=\"danger\" @click=\"ok()\" :disabled=\"modal.submitted\">Valider <b-spinner v-if=\"modal.submitted\" small /></b-button>\r\n            </template>\r\n            <b-form-group label=\"Nom de la cité\">\r\n                <b-form-input v-model=\"modal.nom\" placeholder=\"Ex: Cité de la paix\" trim></b-form-input>\r\n            </b-form-group>\r\n            <b-form-group label=\"Reference\">\r\n                <b-form-input v-model=\"modal.ref\" placeholder=\"Ex: CP3\" trim></b-form-input>\r\n            </b-form-group>\r\n            <b-form-group label=\"Photo\">\r\n                <div class=\"photo-cite d-flex justify-content-center align-items-center border rounded-circle mx-auto\" :style=\"'background-image: url('+modal.photo+');'\" >\r\n                    <b-button variant=\"light\" @click.prevent=\"$refs.photoCite.click()\" class=\"btn-icon\"><i class=\"fa fa-camera-retro fa-lg text-muted\"></i></b-button>\r\n                    <input type=\"file\" class=\"d-none\" ref=\"photoCite\" @change=\"onFileSelected\">\r\n                </div>\r\n            </b-form-group>\r\n        </b-modal>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n// Je renome le composant Cite en AppCite parcequ'il existe une balise <cite>. Du coup le composant n'allait pas etre prise en compte\r\nimport AppCite from '@/components/_patrimoine/Cite.vue'\r\nimport DetailsCite from '@/components/_patrimoine/DetailsCite.vue'\r\n\r\nconst php  = require ( 'phpjs' ) ; \r\n\r\nexport default {\r\n    name: 'Cites',\r\n    components: {\r\n        AppCite,\r\n        DetailsCite,\r\n    },\r\n    computed: {\r\n        /**\r\n         * Elements affichés avec prise en charge de la pagination\r\n         */\r\n        items() { \r\n            return php.array_slice(this.cites, this.offset, this.perPage) \r\n        },\r\n        offset() {\r\n            return (this.currentPage * this.perPage) - this.perPage\r\n        }\r\n    },\r\n    data: () => ({\r\n        cites: [],\r\n        trueCites: [],\r\n        showOverlay: true,\r\n        cite: null,\r\n        currentPage: 1,\r\n        perPage: 10,\r\n        search: null,\r\n        modal: {\r\n            action: '', submitted: false,\r\n            nom: '', ref: '', idCite: '', photo: ''\r\n        }\r\n    }),\r\n    watch: {\r\n        search(value) {\r\n            if (!php.empty(value)) {\r\n                this.cites = this.trueCites.filter(elt => elt.nomCite.toLowerCase().includes(value.toLowerCase()))\r\n            }\r\n            else {\r\n                this.cites = this.trueCites\r\n            }\r\n        }\r\n    },\r\n    beforeMount() {\r\n        this.getCities()\r\n    },\r\n    mounted(){\r\n         this.autoAddTarget();\r\n    },\r\n    methods: {\r\n        showModal(){\r\n            this.modal.action='add'\r\n            this.$refs.modalCite.show(\"modal-cite\");\r\n        },\r\n        /**\r\n         * Selection de l'image illustrative de la cite\r\n         */\r\n        onFileSelected(event) {\r\n            let file = event.target.files[0],\r\n                    reader = new FileReader(),\r\n                    modal = this.modal\r\n                reader.onload = function() {\r\n                    modal.photo = this.result\r\n                }\r\n                reader.readAsDataURL(file)\r\n        },\r\n\r\n        /**\r\n         * Recupere les cites au backend\r\n         */\r\n        getCities() {\r\n            axios.get('cites').then(response => response.result || []).then(cites => {\r\n                this.cites = this.trueCites = cites\r\n                this.showOverlay = false\r\n            })\r\n        },\r\n\r\n        /**\r\n         * Affiche le modal de création d'une cité directement au chargement de la page\r\n         * ceci est utilisé lorsqu'on est arrivé ici en provenant de la homepage\r\n         */\r\n        autoAddTarget() {\r\n            const target = this.$route.query.target || null;\r\n            if (target) {\r\n                 this.showModal()\r\n                window.history.replaceState(\r\n                    {},\r\n                    \"\",\r\n                    window.location.href.split(\"?\")[0]\r\n                );\r\n                \r\n            }\r\n        },\r\n\r\n        /**\r\n         * Affiche les details d'une cite\r\n         * \r\n         * @param {Object} cite\r\n         */\r\n        showDetails(cite) {\r\n            this.cite = cite\r\n            setTimeout(() => {\r\n                $('#editLayoutItem').modal('show')\r\n                $('#editLayoutItem').on('hide.bs.modal', (e) => {\r\n                    this.cite = null\r\n                })\r\n                $('#editLayoutItem').on('hidden.bs.modal', (e) => {\r\n                    this.cite = null\r\n                })\r\n            }, 100)          \r\n        },\r\n\r\n        /**\r\n         * Raffraichi la liste des batiments de la cité active\r\n         * \r\n         * @param {Batiment[]} batiments\r\n         */\r\n        changeBatiments(batiments) {\r\n            this.cites = this.cites.map(elt => {\r\n                if (elt.idCite != this.cite.idCite) {\r\n                    return elt\r\n                }\r\n                return {\r\n                    ...elt,\r\n                    batiments\r\n                }\r\n            })\r\n            this.cite.batiments = batiments\r\n        },\r\n        /**\r\n         * Retire une cite\r\n         * \r\n         * @param {Integer} idCite\r\n         */\r\n        removeCite(idCite) {\r\n            this.cites = this.cites.filter(elt => elt.idCite != idCite)\r\n            this.trueCites = this.trueCites.filter(elt => elt.idCite != idCite)\r\n        },\r\n\r\n        resetModal() {\r\n            this.modal = {\r\n                action: '', submitted: false,\r\n                nom: '', ref: '', idCite: '', photo: ''\r\n            }\r\n        },\r\n        /**\r\n         * Validation du formulaire d'ajout/modification de la cite\r\n         */\r\n        submitModal(bvModalEvt) {\r\n            bvModalEvt.preventDefault()\r\n            if (php.empty(this.modal.nom) || php.empty(this.modal.ref)) {\r\n                return App.error('Veuillez remplir tous les champs du formulaire')\r\n            }\r\n            this.modal.submitted = true\r\n\r\n            if (this.modal.action == 'add') {\r\n                axios.post('cites', this.modal).then(response => {\r\n                    this.modal.submitted = false\r\n\r\n                    if (!response.success) {\r\n                        return App.alertError(response.message)\r\n                    }\r\n                    this.cites = this.addNewCite(this.cites, response.result)\r\n                    this.trueCites = this.addNewCite(this.trueCites, response.result)\r\n                    this.$bvModal.hide('modal-cite')\r\n                    return App.notifySuccess(response.message)\r\n                }).catch(error => {\r\n                    this.modal.submitted = false \r\n                    return App.alertError(error.message)\r\n                })\r\n            }\r\n            if (this.modal.action == 'edit') {\r\n                axios.put(`cites/${this.modal.idCite}`, this.modal).then(response => {\r\n                    this.modal.submitted = false\r\n\r\n                    if (!response.success) {\r\n                        return App.alertError(response.message)\r\n                    }\r\n                    this.cites = this.renameCite(this.cites, this.modal)\r\n                    this.trueCites = this.renameCite(this.trueCites, this.modal)\r\n                    this.$bvModal.hide('modal-cite')\r\n                    return App.notifySuccess(response.message)\r\n                }).catch(error => {\r\n                    this.modal.submitted = false \r\n                    return App.alertError(error.message)\r\n                })\r\n            }\r\n        },\r\n        updateCite(cite) {\r\n            this.modal = {\r\n                action: 'edit',\r\n                nom: cite.nomCite, ref: cite.refCite, idCite: cite.idCite, photo: cite.image\r\n            }\r\n            this.$bvModal.show('modal-cite')\r\n        },\r\n\r\n        addNewCite(cites, cite) {\r\n            let exist = false\r\n            for (let i = 0; i < cites.length; i++) {\r\n                if (cites[i].idCite == cite.idCite) {\r\n                    exist = true \r\n                    break\r\n                }\r\n            }\r\n            if (!exist) {\r\n                cites.push(cite)\r\n            }\r\n            return cites\r\n        },\r\n         /**\r\n         * Modifie les info de la cite dans la pile des cites\r\n         */\r\n        renameCite(cites, cite) {\r\n            return cites.map(elt => {\r\n                if (elt.idCite == cite.idCite) {\r\n                    elt.nomCite = cite.nom\r\n                    elt.refCite = cite.ref\r\n                    elt.image = cite.photo\r\n                }\r\n                return elt\r\n            })\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.photo-cite {\r\n    width: 8.5em;\r\n    height: 8.5em;\r\n    background-size: cover;\r\n}\r\n.photo-cite button {\r\n    cursor: pointer;\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Cites.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Cites.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Cites.vue?vue&type=template&id=f2c782c4&scoped=true&\"\nimport script from \"./Cites.vue?vue&type=script&lang=js&\"\nexport * from \"./Cites.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Cites.vue?vue&type=style&index=0&id=f2c782c4&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"f2c782c4\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}